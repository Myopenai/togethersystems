<!DOCTYPE html>

<html lang="de">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<title>MMM - MAGNITUDO MUSICA MUNDO ‚Äì One File Universal Platform</title>
<style>
:root{
  --bg: #f2eadf;
  --bg2:#e8dccb;
  --bg3:#dfd2be;
  --accent:#8b6b4a;
  --accent2:#a17f5a;
  --text:#3d2f23;
  --muted:#7a6959;
  --card:#fff8ee;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, 'Noto Sans', Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Apple Color Emoji','Segoe UI Emoji';
  color:var(--text);
  background:
    linear-gradient(180deg,var(--bg) 0%, var(--bg2) 30%, var(--bg3) 100%);
}
.header{
  background:
    linear-gradient(90deg, rgba(161,127,90,.25) 0 20px, transparent 20px),
    repeating-linear-gradient(90deg, #e9dfcf, #e9dfcf 12px, #efe5d7 12px, #efe5d7 24px);
  border-bottom:1px solid #d8c8b4;
  padding:24px 16px;
}
.wrap{max-width:1100px;margin:0 auto;padding:0 16px}
.brand{display:flex;align-items:center;gap:14px}
.brand .badge{width:44px;height:44px;border-radius:12px;background:linear-gradient(180deg,#f4e7d6,#e8dbc7);box-shadow:0 1px 0 #fff inset, 0 2px 6px rgba(0,0,0,.08)}
.brand h1{font-size:clamp(20px,4vw,28px);margin:0;color:var(--accent);letter-spacing:.5px}
.sub{margin:6px 0 0;color:var(--muted)}
.controls{display:flex;flex-wrap:wrap;gap:10px;margin:14px 0 0}
input[type="search"], select{
  appearance:none;
  background:var(--card);
  border:1px solid #decdb9;
  border-radius:12px;
  padding:10px 12px;
  font-size:14px;
  min-width:230px;
  outline:none;
  box-shadow:0 1px 0 #fff inset, 0 1.5px 0 rgba(0,0,0,.04);
}
select{min-width:160px}
.btn{
  background:linear-gradient(180deg,#f6eadb,#eadcc8);
  border:1px solid #d9c7b2;
  border-radius:12px;
  padding:10px 14px;
  font-weight:600;
  color:var(--accent);
  cursor:pointer;
  box-shadow:0 1px 0 #fff inset, 0 2px 6px rgba(0,0,0,.06);
}
.btn:hover{filter:brightness(98%)}
.main{padding:20px 0}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:14px}
.card{
  background:var(--card);
  border:1px solid #e2d3bf;
  border-radius:18px;
  padding:14px;
  box-shadow:0 1px 0 #fff inset, 0 2px 8px rgba(0,0,0,.05);
}
.card h3{margin:0 0 6px;font-size:18px;color:var(--accent)}
.meta{font-size:12px;color:var(--muted);display:flex;flex-wrap:wrap;gap:8px}
.tags{margin-top:6px;display:flex;flex-wrap:wrap;gap:6px}
.tag{font-size:11px;background:#efe4d4;color:#7a5a3a;border:1px solid #e0cfba;padding:4px 6px;border-radius:999px}
.card .more{margin-top:10px;display:flex;justify-content:space-between;align-items:center}
.link{font-size:13px;color:var(--accent2);cursor:pointer;text-decoration:underline}
.footer{margin:30px 0 0;border-top:1px dashed #d7c6b1;padding:16px 0;background:linear-gradient(180deg,rgba(235,222,208,.35),rgba(235,222,208,0));}
.footer .footer-inner{max-width:1100px;margin:0 auto;color:var(--muted);font-size:13px;line-height:1.6}
.modal{
  position:fixed;inset:0;background:rgba(0,0,0,.2);
  display:none;align-items:center;justify-content:center;padding:20px;z-index:1000;
}
.modal.open{display:flex}
.modal .panel{
  width:min(860px,96vw);
  max-height:90vh;overflow:auto;
  background:var(--card);border:1px solid #dac8b2;border-radius:20px;padding:20px;
  box-shadow:0 10px 30px rgba(0,0,0,.18);
}
.panel h2{margin:0 0 10px;color:var(--accent)}
.panel .meta{margin-bottom:8px}
.panel .section{background:#fffdf8;border:1px solid #efe2cf;border-radius:14px;padding:12px;margin:10px 0}
.panel .section h4{margin:0 0 6px;color:#6f5339}
.kicker{margin:10px 0 0;color:#6b5a49;font-style:italic}
.bar{
  height:8px;border-radius:999px;background:linear-gradient(90deg,#e8dccb,#e1d3c0,#d7c7b1);margin:10px 0 20px;
}
.sticky-help{
  position:sticky;top:8px;background:linear-gradient(180deg,#fff8ee,#f7edde);border:1px solid #e7d6c3;border-radius:14px;padding:12px;font-size:13px;color:#6b5a49
}
.small{font-size:12px;color:#7a6959}
.language-switcher {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 1000;
  background: var(--card);
  border: 1px solid #dac8b2;
  border-radius: 12px;
  padding: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,.15);
}
    .modal-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
    }
    
    .btn-collection, .btn-print, .btn-export, .btn-manage {
      padding: 8px 12px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: background-color 0.2s;
    }
    
    .btn-collection {
      background: #4CAF50;
      color: white;
    }
    
    .btn-print {
      background: #2196F3;
      color: white;
    }
    
    .btn-export {
      background: #FF9800;
      color: white;
    }
    
    .btn-manage {
      background: #9C27B0;
      color: white;
    }
    
    .btn-collection:hover, .btn-print:hover, .btn-export:hover, .btn-manage:hover {
      opacity: 0.8;
    }
</style>
</head>
<body>
<div class="language-switcher">
  <select id="languageSelect" onchange="changeLanguage(this.value)">
    <option value="de">üá©üá™ Deutsch</option>
    <option value="nl">üá≥üá± Nederlands</option>
    <option value="en">üá¨üáß English</option>
  </select>
</div>
<header class="header">
<div class="wrap">
<div class="brand">
<div aria-hidden="true" class="badge"></div>
<div>
<h1>MMM - MAGNITUDO MUSICA MUNDO</h1>
<p class="sub">Restaurantbezogen ¬∑ Entwickelt - Gentlyoverdone - <a href="https://tel1.jouwweb.nl/-2" rel="noopener" style="color: var(--accent2); text-decoration: none;" target="_blank">TEL1.NL</a> ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê ¬∑ weltweit traditionelle K√ºche</p>
</div>
</div>
<div class="controls">
<input aria-label="Volltextsuche" id="search" placeholder="Suche nach Gericht, Land, Zutat oder Gef√ºhl (z.‚ÄØB. Hunger, scharf, leicht)‚Ä¶" type="search"/>
<select aria-label="Region filtern" id="region"><option value="">Alle Regionen</option></select>
<select aria-label="Kategorie filtern" id="category"><option value="">Alle Kategorien</option></select>
<select aria-label="Schwierigkeit filtern" id="difficulty"><option value="">Alle Stufen</option></select>
<button class="btn" id="clear" type="button">Filter zur√ºcksetzen</button>
<button class="btn" id="multiSelect" onmouseenter="showMenuInfo('multiSelect', event)" onmouseleave="hideMenuInfo()" style="background: linear-gradient(180deg,#e8dccb,#dac8b2);" type="button">üéØ Multi-Choice Men√º</button>
<button class="btn" id="musicMode" onmouseenter="showMenuInfo('musicMode', event)" onmouseleave="hideMenuInfo()" style="background: linear-gradient(180deg,#e6d6f4,#d6c6e4);" type="button">üéµ Musik-Modus</button>
<button class="btn" id="importExport" onmouseenter="showMenuInfo('importExport', event)" onmouseleave="hideMenuInfo()" style="background: linear-gradient(180deg,#f4d6e6,#e4c6d4);" type="button">üìÅ Import/Export</button>
<button class="btn" id="dataSources" onmouseenter="showMenuInfo('dataSources', event)" onmouseleave="hideMenuInfo()" style="background: linear-gradient(180deg,#e6f4e8,#d6e4d8);" type="button">üåç Datenquellen</button>
</div>
</div>
</header>
<main class="main wrap">
<div class="sticky-help">
<strong>Tipps:</strong> Tippe <em>Hunger</em> f√ºr s√§ttigende Ideen, <em>leicht</em> f√ºr Bek√∂mmliches, <em>scharf</em> f√ºr Chili. Filter sind kombinierbar.
    <div aria-hidden="true" class="bar"></div>
<span class="small" id="count"></span>
</div>
<section aria-live="polite" class="grid" id="results"></section>
<div id="sentinel" style="height:1px"></div>
</main>
<div aria-labelledby="modalTitle" aria-modal="true" class="modal" id="modal" onclick="if(event.target.id==='modal') closeModal()" role="dialog">
<div class="panel">
<button class="btn" onclick="closeModal()" style="float:right">Schlie√üen</button>
<h2 id="modalTitle">Rezept</h2>
<div class="meta" id="modalMeta"></div>
<p class="kicker" id="modalStory"></p>
<div class="section">
<h4>Zutaten</h4>
<ul id="modalIngr"></ul>
</div>
<div class="section">
<h4>Zubereitung</h4>
<ol id="modalSteps"></ol>
</div>
<div class="section">
<h4>Aktionen</h4>
<div class="modal-actions">
<button onclick="addToCollection()" class="btn-collection">üìö Zur Sammlung hinzuf√ºgen</button>
<button onclick="printRecipe()" class="btn-print">üñ®Ô∏è Drucken</button>
<button onclick="exportRecipe()" class="btn-export">üíæ Exportieren</button>
<button onclick="showCollectionManager()" class="btn-manage">üìã Sammlung verwalten</button>
</div>
</div>
</div>
</div>
<footer class="footer">
<div class="footer-inner">
<p><strong>Producer:</strong> Dr. Tel, Demitrio Raymond Tel</p>
<p>üìß <a href="mailto:gentlyoverdone@outlook.com">gentlyoverdone@outlook.com</a></p>
<p>üì± +31 6 1380 3782</p>
<p>üåê urltext: <a href="https://tel1.jouwweb.nl/-2" rel="noopener" target="_blank">www.tel1.nl</a></p>
<p>üè¶ Rabobank ¬∑ IBAN: NL66 RABO 1020 3955 08 ¬∑ BIC: RABONL2U ¬∑ Accountant: R.D.TEL</p>
<p>üíù Unterst√ºtzen Sie Magnitudo Musica Mundo ¬∑ Mindestspende: 5 ‚Ç¨ ¬∑ anonym/personalisiert m√∂glich ¬∑ steuerlich absetzbar (zu pr√ºfen)</p>
<p>Jetzt spenden via GoFundMe: <a href="https://www.gofundme.com/f/magnitudo?utm_campaign=unknown&amp;utm_medium=referral&amp;utm_source=widget" rel="noopener" target="_blank">Magnitudo</a></p>
<p>¬© 2025 TEL &amp; Gentlyoverdone ¬∑ Alle Rechte vorbehalten</p>
</div>
</footer>
<script>
// === VOLLST√ÑNDIGES MEHRSPRACHIGKEITSSYSTEM ===
let currentLanguage = 'de';

const TRANSLATIONS = {
  de: {
    // UI Texte
    searchPlaceholder: "Suche nach Gericht, Land, Zutat oder Gef√ºhl (z. B. Hunger, scharf, leicht)‚Ä¶",
    allRegions: "Alle Regionen",
    allCategories: "Alle Kategorien", 
    allLevels: "Alle Stufen",
    resetFilters: "Filter zur√ºcksetzen",
    multiChoiceMenu: "üéØ Multi-Choice Men√º",
    musicMode: "üéµ Musik-Modus",
    importExport: "üìÅ Import/Export",
    dataSources: "üåç Datenquellen",
    close: "Schlie√üen",
    recipe: "Rezept",
    ingredients: "Zutaten",
    preparation: "Zubereitung",
    tips: "Tipps:",
    tipsText: "Tippe Hunger f√ºr s√§ttigende Ideen, leicht f√ºr Bek√∂mmliches, scharf f√ºr Chili. Filter sind kombinierbar.",
    noResults: "Keine Ergebnisse gefunden",
    tryThese: "Versuche es mit:",
    orSearchFor: "oder suche nach:",
    
    // Schwierigkeitsgrade
    difficulty: {
      "Einfach": "Einfach",
      "Mittel": "Mittel", 
      "Anspruchsvoll": "Anspruchsvoll",
      "n/a": "n/a"
    },
    
    // Kategorien
    categories: {
      "Hauptgericht": "Hauptgericht",
      "Vorspeise": "Vorspeise",
      "Streetfood / Hauptgericht": "Streetfood",
      "Schmorgericht": "Schmorgericht",
      "Vegetarisch": "Vegetarisch",
      "Suppe": "Suppe",
      "Hauptgericht": "Hauptgericht",
      "Eintopf": "Eintopf",
      "Fr√ºhst√ºck / Suppe": "Fr√ºhst√ºck",
      "Eiergericht": "Eiergericht",
      "Auflauf": "Auflauf",
      "Dessert": "Dessert",
      "Beilage": "Beilage",
      "Geb√§ck": "Geb√§ck",
      "Buffet": "Buffet",
      "Fisch": "Fisch",
      "Fleisch": "Fleisch",
      "Eier": "Eier",
      "Brot": "Brot",
      "Nudeln": "Nudeln",
      "Curry": "Curry",
      "Reisgericht": "Reisgericht",
      "Nudelsuppe": "Nudelsuppe",
      "Teigtaschen": "Teigtaschen",
      "Meta": "Meta"
    },
    
    // Regionen
    regions: {
      "Europa": "Europa",
      "Asien": "Asien",
      "Lateinamerika": "Lateinamerika",
      "Afrika": "Afrika",
      "Nahost": "Nahost",
      "Nordamerika": "Nordamerika",
      "Ozeanien": "Ozeanien",
      "Global": "Global",
      "Welt": "Welt"
    }
  },
  
  nl: {
    // UI Texte
    searchPlaceholder: "Zoek naar gerecht, land, ingredi√´nt of gevoel (bijv. honger, pittig, licht)‚Ä¶",
    allRegions: "Alle Regio's",
    allCategories: "Alle Categorie√´n",
    allLevels: "Alle Niveaus", 
    resetFilters: "Filters Resetten",
    multiChoiceMenu: "üéØ Multi-Choice Menu",
    musicMode: "üéµ Muziek-Modus",
    importExport: "üìÅ Import/Export",
    dataSources: "üåç Gegevensbronnen",
    close: "Sluiten",
    recipe: "Recept",
    ingredients: "Ingredi√´nten",
    preparation: "Bereiding",
    tips: "Tips:",
    tipsText: "Type honger voor verzadigende idee√´n, licht voor verteerbaar, pittig voor chili. Filters zijn combineerbaar.",
    noResults: "Geen resultaten gevonden",
    tryThese: "Probeer deze:",
    orSearchFor: "of zoek naar:",
    
    // Schwierigkeitsgrade
    difficulty: {
      "Einfach": "Gemakkelijk",
      "Mittel": "Gemiddeld",
      "Anspruchsvoll": "Uitdagend", 
      "n/a": "n/a"
    },
    
    // Kategorien
    categories: {
      "Hauptgericht": "Hoofdgerecht",
      "Vorspeise": "Voorgerecht",
      "Streetfood / Hauptgericht": "Streetfood",
      "Schmorgericht": "Stoofgerecht",
      "Vegetarisch": "Vegetarisch",
      "Suppe": "Soep",
      "Eintopf": "Stoofpot",
      "Fr√ºhst√ºck / Suppe": "Ontbijt",
      "Eiergericht": "Eiergerecht",
      "Auflauf": "Ovenschotel",
      "Dessert": "Dessert",
      "Beilage": "Bijgerecht",
      "Geb√§ck": "Gebak",
      "Buffet": "Buffet",
      "Fisch": "Vis",
      "Fleisch": "Vlees",
      "Eier": "Eieren",
      "Brot": "Brood",
      "Nudeln": "Pasta",
      "Curry": "Curry",
      "Reisgericht": "Rijstgerecht",
      "Nudelsuppe": "Noedelsoep",
      "Teigtaschen": "Deegzakjes",
      "Meta": "Meta"
    },
    
    // Regionen
    regions: {
      "Europa": "Europa",
      "Asien": "Azi√´",
      "Lateinamerika": "Latijns-Amerika",
      "Afrika": "Afrika",
      "Nahost": "Midden-Oosten",
      "Nordamerika": "Noord-Amerika",
      "Ozeanien": "Oceani√´",
      "Global": "Globaal",
      "Welt": "Wereld"
    }
  },
  
  en: {
    // UI Texte
    searchPlaceholder: "Search for dish, country, ingredient or feeling (e.g. hunger, spicy, light)‚Ä¶",
    allRegions: "All Regions",
    allCategories: "All Categories",
    allLevels: "All Levels",
    resetFilters: "Reset Filters", 
    multiChoiceMenu: "üéØ Multi-Choice Menu",
    musicMode: "üéµ Music Mode",
    importExport: "üìÅ Import/Export",
    dataSources: "üåç Data Sources",
    close: "Close",
    recipe: "Recipe",
    ingredients: "Ingredients",
    preparation: "Preparation",
    tips: "Tips:",
    tipsText: "Type hunger for filling ideas, light for digestible, spicy for chili. Filters are combinable.",
    noResults: "No results found",
    tryThese: "Try these:",
    orSearchFor: "or search for:",
    
    // Schwierigkeitsgrade
    difficulty: {
      "Einfach": "Easy",
      "Mittel": "Medium",
      "Anspruchsvoll": "Advanced",
      "n/a": "n/a"
    },
    
    // Kategorien
    categories: {
      "Hauptgericht": "Main Course",
      "Vorspeise": "Appetizer",
      "Streetfood / Hauptgericht": "Street Food",
      "Schmorgericht": "Stew",
      "Vegetarisch": "Vegetarian",
      "Suppe": "Soup",
      "Eintopf": "Stew",
      "Fr√ºhst√ºck / Suppe": "Breakfast",
      "Eiergericht": "Egg Dish",
      "Auflauf": "Casserole",
      "Dessert": "Dessert",
      "Beilage": "Side Dish",
      "Geb√§ck": "Pastry",
      "Buffet": "Buffet",
      "Fisch": "Fish",
      "Fleisch": "Meat",
      "Eier": "Eggs",
      "Brot": "Bread",
      "Nudeln": "Pasta",
      "Curry": "Curry",
      "Reisgericht": "Rice Dish",
      "Nudelsuppe": "Noodle Soup",
      "Teigtaschen": "Dumplings",
      "Meta": "Meta"
    },
    
    // Regionen
    regions: {
      "Europa": "Europe",
      "Asien": "Asia",
      "Lateinamerika": "Latin America",
      "Afrika": "Africa",
      "Nahost": "Middle East",
      "Nordamerika": "North America",
      "Ozeanien": "Oceania",
      "Global": "Global",
      "Welt": "World"
    }
  }
};

function translateDifficulty(difficulty) {
  return TRANSLATIONS[currentLanguage].difficulty[difficulty] || difficulty;
}

function translateCategory(category) {
  return TRANSLATIONS[currentLanguage].categories[category] || category;
}

function translateRegion(region) {
  return TRANSLATIONS[currentLanguage].regions[region] || region;
}

function translateText(key) {
  return TRANSLATIONS[currentLanguage][key] || key;
}

function changeLanguage(lang) {
  currentLanguage = lang;
  updateUI();
  rebuildAllDropdowns();
  applyFilters();
}

function updateUI() {
  const t = TRANSLATIONS[currentLanguage];
  
  // Update HTML lang attribute
  document.documentElement.lang = currentLanguage;
  
  // Update search placeholder
  document.getElementById('search').placeholder = t.searchPlaceholder;
  
  // Update select options
  document.querySelector('#region option').textContent = t.allRegions;
  document.querySelector('#category option').textContent = t.allCategories;
  document.querySelector('#difficulty option').textContent = t.allLevels;
  
  // Update buttons
  document.getElementById('clear').textContent = t.resetFilters;
  document.getElementById('multiSelect').textContent = t.multiChoiceMenu;
  document.getElementById('musicMode').textContent = t.musicMode;
  document.getElementById('importExport').textContent = t.importExport;
  document.getElementById('dataSources').textContent = t.dataSources;
  
  // Update modal texts
  document.getElementById('modalTitle').textContent = t.recipe;
  
  // Update tips
  const tipsElement = document.querySelector('.sticky-help strong');
  if (tipsElement) {
    tipsElement.textContent = t.tips;
    tipsElement.nextSibling.textContent = ' ' + t.tipsText;
  }
}

function rebuildAllDropdowns() {
  rebuildDifficultyDropdown();
  rebuildCategoryDropdown();
  rebuildRegionDropdown();
}

function rebuildDifficultyDropdown() {
  const difficultySelect = document.getElementById('difficulty');
  const currentValue = difficultySelect.value;
  
  difficultySelect.innerHTML = `<option value="">${translateText('allLevels')}</option>`;
  
  const diffs = [...new Set(DATA.map(r => r.difficulty))].sort();
  for (const d of diffs) {
    const option = document.createElement('option');
    option.value = d;
    option.textContent = translateDifficulty(d);
    difficultySelect.appendChild(option);
  }
  
  if (currentValue) {
    difficultySelect.value = currentValue;
  }
}

function rebuildCategoryDropdown() {
  const categorySelect = document.getElementById('category');
  const currentValue = categorySelect.value;
  
  categorySelect.innerHTML = `<option value="">${translateText('allCategories')}</option>`;
  
  const cats = [...new Set(DATA.map(r => r.category))].sort();
  for (const c of cats) {
    const option = document.createElement('option');
    option.value = c;
    option.textContent = translateCategory(c);
    categorySelect.appendChild(option);
  }
  
  if (currentValue) {
    categorySelect.value = currentValue;
  }
}

function rebuildRegionDropdown() {
  const regionSelect = document.getElementById('region');
  const currentValue = regionSelect.value;
  
  regionSelect.innerHTML = `<option value="">${translateText('allRegions')}</option>`;
  
  const regions = [...new Set(DATA.map(r => r.region))].sort();
  for (const r of regions) {
    const option = document.createElement('option');
    option.value = r;
    option.textContent = translateRegion(r);
    regionSelect.appendChild(option);
  }
  
  if (currentValue) {
    regionSelect.value = currentValue;
  }
}

// Initialize language system
updateUI();

const DATA = [
  {"id": "gb_shepherds_pie", "name": "Shepherd's Pie", "local_names": ["Shepherd's Pie"], "country": "Gro√übritannien", "region": "Europa", "category": "Auflauf", "tags": ["Fleisch", "Kartoffeln", "klassisch", "britisch"], "time_min": 90, "difficulty": "Mittel", "servings": "4-6", "story": "Klassisches britisches Gericht mit Hackfleisch und Kartoffelbrei. Traditionell mit Lammfleisch, aber oft auch mit Rindfleisch zubereitet.", "ingredients": ["500g Hackfleisch (Lamm oder Rind)", "1kg Kartoffeln", "2 Zwiebeln", "2 M√∂hren", "100g Erbsen", "500ml Br√ºhe", "2 EL Tomatenmark", "Worcestershire Sauce", "Butter", "Milch", "Salz", "Pfeffer"], "steps": ["Kartoffeln sch√§len, w√ºrfeln und in Salzwasser kochen bis weich.", "Zwiebeln und M√∂hren w√ºrfeln, Hackfleisch in einer gro√üen Pfanne anbraten.", "Gem√ºse zum Fleisch geben und 5 Minuten mitbraten.", "Tomatenmark und Worcestershire Sauce hinzuf√ºgen, mit Br√ºhe abl√∂schen.", "Bei mittlerer Hitze 20 Minuten k√∂cheln lassen, dann Erbsen unterheben.", "Kartoffeln abgie√üen, stampfen und mit Butter und Milch cremig r√ºhren.", "Fleischmasse in eine Auflaufform geben, Kartoffelbrei darauf verteilen.", "Bei 200¬∞C 25-30 Minuten backen bis die Oberfl√§che goldbraun ist."]},{"id": "it_spaghetti_carbonara", "name": "Spaghetti alla Carbonara", "local_names": ["Carbonara"], "country": "Italien", "region": "Europa", "category": "Hauptgericht", "tags": ["Pasta", "schnell", "klassisch", "ohne_Sahne"], "time_min": 25, "difficulty": "Mittel", "servings": "2‚Äì3", "story": "R√∂mischer Klassiker aus Pecorino, Guanciale, Eigelb und Pfeffer. Keine Sahne ‚Äì die Cremigkeit entsteht durch Emulsion.", "ingredients": ["200 g Spaghetti", "100 g Guanciale (oder Pancetta)", "2 Eigelb + 1 ganzes Ei", "60 g Pecorino Romano, fein gerieben", "Schwarzer Pfeffer, frisch gemahlen", "Prise Salz f√ºrs Kochwasser"], "steps": ["Spaghetti in gut gesalzenem Wasser al dente kochen.", "Guanciale in Streifen schneiden und in einer Pfanne bei mittlerer Hitze knusprig auslassen.", "Eier mit Pecorino und reichlich Pfeffer verquirlen.", "Spaghetti abgie√üen (etwas Kochwasser aufheben) und zur Guanciale geben.", "Pfanne vom Herd ziehen, Eier-K√§se-Mischung unterr√ºhren und mit Kochwasser zur cremigen Sauce emulgieren.", "Sofort servieren, mit Pfeffer und Pecorino toppen."]}, {"id": "jp_miso_soup", "name": "Misoshiru (Miso-Suppe)", "local_names": ["Âë≥ÂôåÊ±Å"], "country": "Japan", "region": "Asien", "category": "Vorspeise", "tags": ["leicht", "bruehe", "tofurezept", "glutenfrei"], "time_min": 15, "difficulty": "Leicht", "servings": "2", "story": "Hausgemachte Fr√ºhst√ºckssuppe ‚Äì Dashi, Miso, Tofu und Wakame. Saisonal oft mit Fr√ºhlingszwiebeln.", "ingredients": ["500 ml Dashi (Kombu-Bonito-Br√ºhe oder vegetarisch mit Kombu-Shiitake)", "2‚Äì3 EL Miso-Paste (hell oder rot)", "100 g Seidentofu, gew√ºrfelt", "1 EL getrocknetes Wakame, eingeweicht", "2 Fr√ºhlingszwiebeln, in Ringen"], "steps": ["Dashi erhitzen, aber nicht kochen.", "Wakame zuf√ºgen, kurz ziehen lassen.", "Etwas hei√üe Br√ºhe mit Miso in einer Schale glattr√ºhren, dann in den Topf geben (nicht mehr kochen).", "Tofu und Fr√ºhlingszwiebeln einlegen, 1 Minute ziehen lassen und servieren."]}, {"id": "mx_tacos_al_pastor", "name": "Tacos al Pastor", "local_names": ["Adobada"], "country": "Mexiko", "region": "Lateinamerika", "category": "Streetfood / Hauptgericht", "tags": ["grillen", "ananas", "schwein"], "time_min": 120, "difficulty": "Mittel", "servings": "4", "story": "Libanesischer Einfluss trifft mexikanische W√ºrze: Schweinefleisch in Achiote-Marinade, traditionell am Trompo, zuhause in der Pfanne oder auf dem Grill.", "ingredients": ["700 g Schweinenacken, d√ºnn geschnitten", "2 EL Achiote-Paste", "2 getrocknete Guajillo-Chilis, eingeweicht", "2 Knoblauchzehen", "60 ml Apfelessig", "1 TL Oregano (mexikanisch, wenn verf√ºgbar)", "1 TL Kreuzk√ºmmel", "1 TL Salz", "1 kleine Ananas, gesch√§lt (Scheiben + W√ºrfel)", "12 kleine Maistortillas", "Zwiebel, Koriander, Limetten zum Servieren"], "steps": ["Chilis entkernen, einweichen und mit Achiote, Knoblauch, Essig, Oregano, Kreuzk√ºmmel und Salz fein p√ºrieren.", "Fleisch mit Marinade 1‚Äì12 Stunden k√ºhlen.", "Ananasscheiben und Fleisch hei√ü grillen oder in der Pfanne braten.", "Tortillas erw√§rmen, Fleisch und Ananasw√ºrfel darauf, mit Zwiebel, Koriander und Limette servieren."]}, {"id": "fr_coq_au_vin", "name": "Coq au Vin", "local_names": [], "country": "Frankreich", "region": "Europa", "category": "Schmorgericht", "tags": ["klassiker", "rotwein", "huhn"], "time_min": 150, "difficulty": "Mittel", "servings": "4", "story": "Burgundisches Schmorgericht: Huhn in Rotwein mit Speck, Pilzen und Perlzwiebeln ‚Äì langsam gegart f√ºr Tiefe.", "ingredients": ["1,5 kg H√§hnchenteile (mit Knochen)", "150 g Speckw√ºrfel", "200 g Champignons, halbiert", "12 Perlzwiebeln (oder Schalotten)", "2 Karotten, in St√ºcken", "2 EL Tomatenmark", "750 ml kr√§ftiger Rotwein", "250 ml Gefl√ºgelfond", "2 EL Mehl", "2 EL Butter + 1 EL √ñl", "Thymian, Lorbeer, Salz, Pfeffer"], "steps": ["Speck in Butter/√ñl auslassen, herausnehmen. H√§hnchen anbraten, salzen, pfeffern.", "Gem√ºse anschwitzen, Tomatenmark kurz r√∂sten, mit Mehl stauben.", "Mit Rotwein abl√∂schen, Fond zugeben, Kr√§uter einlegen.", "H√§hnchen und Speck zur√ºck, zugedeckt 60‚Äì90 Min. sanft schmoren.", "Pilze und Perlzwiebeln in Butter braten, die letzten 20 Min. mitgaren. Mit Salz/Pfeffer abschmecken."]}, {"id": "ma_tagine_lamm_pflaumen", "name": "Lamm-Tajine mit Pflaumen und Mandeln", "local_names": ["Tajine bel barkouk"], "country": "Marokko", "region": "Afrika", "category": "Schmorgericht", "tags": ["suesz_herzhaft", "festlich"], "time_min": 180, "difficulty": "Mittel", "servings": "4", "story": "Festliche Tajine ‚Äì zartes Lamm mit s√º√ü-w√ºrzigen Pflaumen, ger√∂steten Mandeln und Sesam.", "ingredients": ["800 g Lammkeule, in St√ºcken", "2 Zwiebeln, gehackt", "2 Knoblauchzehen", "1 TL Ingwer, gemahlen", "1 TL Zimt", "1 TL Kurkuma", "1 TL Paprika edels√º√ü", "1 Prise Safran (optional)", "400 ml Wasser oder Fond", "200 g getrocknete Pflaumen", "1 EL Honig", "50 g Mandeln, ger√∂stet", "Sesam, Koriandergr√ºn, Salz, Pfeffer"], "steps": ["Lamm mit Zwiebeln und Knoblauch in etwas √ñl anbraten.", "Gew√ºrze zuf√ºgen, kurz r√∂sten, mit Wasser bedecken und zugedeckt 90‚Äì120 Min. schmoren.", "Pflaumen mit etwas Sud und Honig 10 Min. s√§mig ziehen lassen.", "Pflaumen zum Fleisch geben, abschmecken. Mit Mandeln/Sesam bestreut servieren."]}, {"id": "in_dal_tadka", "name": "Dal Tadka", "local_names": ["‡§¶‡§æ‡§≤ ‡§§‡§°‡§º‡§ï‡§æ"], "country": "Indien", "region": "Asien", "category": "Vegetarisch", "tags": ["glutenfrei", "proteinreich", "komfort"], "time_min": 40, "difficulty": "Leicht", "servings": "4", "story": "W√ºrziges Linsengericht ‚Äì weiche gelbe Linsen mit einer temperierten Gew√ºrzbutter (Tadka).", "ingredients": ["250 g gelbe Linsen (Toor/Arhar oder gelbe Mung)", "1 Zwiebel, gew√ºrfelt", "2 Tomaten, gew√ºrfelt", "2 Knoblauchzehen, fein", "2 cm Ingwer, fein", "1 TL Kurkuma", "1 TL Kreuzk√ºmmelsamen", "1 TL Senfsamen", "2 getrocknete rote Chilis", "2 EL Ghee oder √ñl", "Koriandergr√ºn, Salz"], "steps": ["Linsen mit Kurkuma weich kochen.", "F√ºr das Tadka Ghee erhitzen, Kreuzk√ºmmel und Senfsamen aufpoppen lassen, Knoblauch, Ingwer und Chilis kurz r√∂sten.", "Zwiebel glasig, Tomaten weich schmoren, salzen.", "Tadka in die Linsen r√ºhren, mit Koriander bestreuen."]}, {"id": "cn_mapo_tofu", "name": "Mapo Tofu", "local_names": ["È∫ªÂ©ÜË±ÜËÖê"], "country": "China", "region": "Asien", "category": "Hauptgericht", "tags": ["scharf", "szechuanpfeffer", "tofurezept"], "time_min": 30, "difficulty": "Mittel", "servings": "3", "story": "Scharf-numbing Klassiker aus Chengdu ‚Äì Tofu in Chili-Bohnen-Paste mit Hackfleisch und Sichuanpfeffer.", "ingredients": ["400 g weicher Tofu, gew√ºrfelt", "200 g Schweinehack (oder Rinderhack)", "1 EL Doubanjiang (Pixian-Chilibohnenpaste)", "1 TL Douchi (fermentierte schwarze Bohnen), gehackt", "2 Knoblauchzehen, fein", "2 cm Ingwer, fein", "250 ml Br√ºhe", "1 TL ger√∂stetes Chilipulver", "1 TL Sichuanpfeffer, gemahlen", "1 TL St√§rke + 2 EL Wasser", "Fr√ºhlingszwiebel, √ñl"], "steps": ["Hackfleisch in √ñl kr√ºmelig braten, Knoblauch/Ingwer zugeben.", "Doubanjiang und Douchi kurz r√∂sten, Br√ºhe angie√üen.", "Tofu einlegen, 5‚Äì7 Min. simmern.", "Mit St√§rke binden, mit Chili und Sichuanpfeffer abschmecken, mit Fr√ºhlingszwiebel servieren."]}, {"id": "de_sauerbraten", "name": "Rheinischer Sauerbraten", "local_names": [], "country": "Deutschland", "region": "Europa", "category": "Schmorgericht", "tags": ["sonntag", "klassiker", "marinade"], "time_min": 240, "difficulty": "Mittel", "servings": "6", "story": "Rind wird in Essig-Gew√ºrz-Lake mehrere Tage mariniert und dann langsam geschmort ‚Äì typisch mit Rosinen und Printen/Lebkuchen gebunden.", "ingredients": ["1,5 kg Rinderbraten", "500 ml Rotwein", "500 ml Wasser", "150 ml Weinessig", "1 Zwiebel, 1 M√∂hre, 1 Selleriestange", "2 Lorbeerbl√§tter, 6 Pimentk√∂rner, 6 Pfefferk√∂rner", "1 TL Salz", "2 EL R√ºbenkraut oder Zucker", "2 Scheiben Printen/ Lebkuchen (optional)", "Rosinen nach Geschmack", "Butterschmalz zum Anbraten"], "steps": ["Marinade aufkochen, abk√ºhlen, Braten und Gem√ºse 2‚Äì3 Tage darin k√ºhl ziehen lassen.", "Fleisch abtrocknen, kr√§ftig anbraten. Marinade mit Gem√ºse angie√üen, 2,5‚Äì3 h schmoren.", "Sauce mit Printen und Rosinen verfeinern und abschmecken."]}, {"id": "us_clam_chowder", "name": "New England Clam Chowder", "local_names": [], "country": "USA", "region": "Nordamerika", "category": "Suppe", "tags": ["muscheln", "cremig"], "time_min": 60, "difficulty": "Mittel", "servings": "4", "story": "Cremige Muschelsuppe mit Kartoffeln, Speck und Sellerie ‚Äì K√ºstenklassiker.", "ingredients": ["400 g Venusmuscheln (oder Dosmuscheln)", "150 g Speckw√ºrfel", "1 Zwiebel, 1 Selleriestange, 2 Kartoffeln", "500 ml Fischfond", "200 ml Milch", "100 ml Sahne", "1 Lorbeerblatt, Thymian, Salz, Pfeffer"], "steps": ["Speck auslassen, Gem√ºse anschwitzen.", "Mit Fond aufgie√üen, Kartoffeln weich kochen.", "Muscheln und Milch/Sahne zugeben, kurz ziehen lassen, mit Salz/Pfeffer und Thymian abschmecken."]}, {"id": "tr_manti", "name": "Manti (gef√ºllte Teigtaschen)", "local_names": [], "country": "T√ºrkei", "region": "Nahost", "category": "Hauptgericht", "tags": ["teigtaschen", "joghurt"], "time_min": 120, "difficulty": "Anspruchsvoll", "servings": "4", "story": "Winzige Teigtaschen mit gew√ºrztem Hack, serviert mit Knoblauchjoghurt und Paprikabutter.", "ingredients": ["300 g Mehl, 1 Ei, Wasser, Salz", "200 g Rinderhack", "1 Zwiebel, fein", "1 TL Paprikapulver, 1/2 TL Kreuzk√ºmmel", "300 g Joghurt + 1 Knoblauchzehe", "2 EL Butter + 1 TL Pul Biber"], "steps": ["Teig kneten, d√ºnn ausrollen, kleine Quadrate schneiden.", "Hack mit Zwiebel/Gew√ºrzen f√ºllen, zu Mini-Manti falten.", "In Salzwasser 6‚Äì8 Min. garen.", "Mit Knoblauchjoghurt, Paprikabutter und Minze servieren."]}, {"id": "gr_moussaka", "name": "Moussaka", "local_names": [], "country": "Griechenland", "region": "Europa", "category": "Auflauf", "tags": ["auberginen", "bechamel"], "time_min": 120, "difficulty": "Mittel", "servings": "6", "story": "Geschichteter Auflauf aus Auberginen, Hack und Muskat-Bechamel.", "ingredients": ["2 Auberginen", "400 g Lamm- oder Rinderhack", "1 Zwiebel, 2 Knoblauchzehen", "400 g Tomaten (aus der Dose)", "Zimtstange, Oregano, Salz, Pfeffer", "40 g Butter, 40 g Mehl, 400 ml Milch, Muskat", "Oliven√∂l"], "steps": ["Auberginen scheiben salzen, abtupfen, anbraten.", "Hack mit Zwiebel/Knoblauch braten, Tomaten und Gew√ºrze zuf√ºgen, einkochen.", "Bechamel kochen, mit Muskat abschmecken.", "In Form schichten, 35‚Äì40 Min. backen."]}, {"id": "et_doro_wat", "name": "Doro Wat (√§thiopischer H√§hncheneintopf)", "local_names": [], "country": "√Ñthiopien", "region": "Afrika", "category": "Schmorgericht", "tags": ["berbere", "injera"], "time_min": 120, "difficulty": "Mittel", "servings": "4", "story": "Tief rote, scharfe Zwiebel- und Berbere-Sauce mit Huhn und Eiern ‚Äì Nationalgericht.", "ingredients": ["6 Zwiebeln, sehr fein gehackt", "3 EL Niter Kibbeh (Gew√ºrzbutter) oder √ñl", "2‚Äì3 EL Berbere-Gew√ºrzmischung", "2 EL Tomatenmark", "6 H√§hnchenteile", "2‚Äì3 hartgekochte Eier", "Salz, Zitronensaft"], "steps": ["Zwiebeln trocken langsam schmoren bis s√º√ü.", "Niter Kibbeh und Berbere zugeben, r√∂sten.", "Tomatenmark, dann Huhn hinein, mit Wasser knapp bedecken und 45‚Äì60 Min. sanft garen.", "Eier einlegen, mit Salz/Zitrone abschmecken."]}, {"id": "vn_bun_cha", "name": "B√∫n Ch·∫£ (Gegrilltes Schwein mit Reisnudeln)", "local_names": [], "country": "Vietnam", "region": "Asien", "category": "Hauptgericht", "tags": ["kr%C3%A4uter", "nudeln"], "time_min": 60, "difficulty": "Mittel", "servings": "4", "story": "Hanoi-Klassiker: Gegrillte Hackfleischpflanzerl und Nackenstreifen in Dip, mit Kr√§utern und Reisnudeln.", "ingredients": ["300 g Schweinehack + 300 g Schweinenacken in Scheiben", "2 EL Fischsauce, 1 EL Zucker, 1 Knoblauchzehe, Pfeffer", "200 g Reisnudeln", "Kr√§uter: Minze, Koriander, Perillabl√§tter", "Dip: Fischsauce, Zucker, Limette, Wasser, Chili, Knoblauch"], "steps": ["Fleisch marinieren, dann hei√ü grillen.", "Reisnudeln kochen, Kr√§uter waschen.", "Dip anr√ºhren.", "Alles in Schalen anrichten, Fleisch in den Dip tauchen oder dar√ºber gie√üen."]}, {"id": "ir_beef_stew", "name": "Irish Beef Stew", "local_names": [], "country": "Irland", "region": "Europa", "category": "Schmorgericht", "tags": ["eintopf", "kartoffeln"], "time_min": 150, "difficulty": "Leicht", "servings": "6", "story": "Rustikaler Eintopf mit Rind, Kartoffeln, Karotten und manchmal Guinness.", "ingredients": ["1 kg Rinderschmorst√ºck", "4 Kartoffeln, 3 Karotten, 1 Zwiebel", "500 ml Rinderfond", "Optional: 250 ml Guinness", "Thymian, Lorbeer, Salz, Pfeffer"], "steps": ["Fleisch anbraten, Gem√ºse zugeben.", "Mit Fond (und Guinness) aufgie√üen, 2 Stunden leise schmoren.", "Mit Salz/Pfeffer abschmecken."]}, {"id": "mafe", "name": "Maf√© (Erdnuss-Eintopf)", "local_names": [], "country": "Senegal", "region": "Afrika", "category": "Eintopf", "tags": ["erdnuss", "tomate"], "time_min": 90, "difficulty": "Leicht", "servings": "4", "story": "Cremiger Erdnuss-Eintopf mit Fleisch oder vegetarisch.", "ingredients": ["400 g Rind oder Huhn (optional)", "1 Zwiebel", "2 EL Erdnussbutter", "400 g st√ºckige Tomaten", "1 S√º√ükartoffel", "Br√ºhe, Chili, Salz"], "steps": ["Fleisch anbraten, Zwiebel glasig.", "Tomaten, Br√ºhe, Erdnussbutter und S√º√ükartoffel zugeben.", "30‚Äì40 Min. sanft kochen, abschmecken."]}, {"id": "pe_ceviche", "name": "Ceviche cl√°sico", "local_names": [], "country": "Peru", "region": "Lateinamerika", "category": "Vorspeise", "tags": ["fisch", "limette", "roh"], "time_min": 45, "difficulty": "Mittel", "servings": "4", "story": "Frischer Fisch in Limettensaft mit Zwiebel, Chili und Koriander ‚Äì sofort servieren.", "ingredients": ["400 g sehr frischer fester Fisch (z. B. Wolfsbarsch)", "8‚Äì10 Limetten (Saft)", "1 rote Zwiebel, in feinen Spalten", "1 Chili (Aj√≠ limo oder Jalape√±o)", "Koriandergr√ºn, Salz", "S√º√ükartoffel und Mais als Beilage"], "steps": ["Fisch in W√ºrfel schneiden, salzen.", "Mit Limettensaft, Zwiebel und Chili 10‚Äì15 Min. marinieren.", "Mit Koriander servieren, schnell genie√üen."]}, {"id": "cn_congee", "name": "Reis-Congee", "local_names": [], "country": "China", "region": "Asien", "category": "Fr√ºhst√ºck / Suppe", "tags": ["reisbrei", "komfort"], "time_min": 90, "difficulty": "Leicht", "servings": "4", "story": "Sanfter Reisbrei ‚Äì Basis f√ºr Toppings wie Fr√ºhlingszwiebel, Erdnuss, Eier.", "ingredients": ["200 g Jasmin- oder Rundkornreis", "2 l Wasser oder Br√ºhe", "Ingwer, Salz", "Toppings nach Wahl"], "steps": ["Reis waschen, mit Wasser/Br√ºhe 60‚Äì90 Min. sanft kochen bis cremig.", "Mit Salz/Ingwer abschmecken, Toppings bereitstellen."]}, {"id": "es_tortilla", "name": "Tortilla de Patatas", "local_names": [], "country": "Spanien", "region": "Europa", "category": "Eiergericht", "tags": ["kartoffeln", "zwiebel"], "time_min": 45, "difficulty": "Leicht", "servings": "4", "story": "Dickes Omelett aus Kartoffeln, Zwiebeln und Eiern ‚Äì warm oder kalt.", "ingredients": ["600 g Kartoffeln, d√ºnn", "1 gro√üe Zwiebel, halbmonde", "6 Eier", "Oliven√∂l, Salz"], "steps": ["Kartoffeln und Zwiebel in viel √ñl langsam weich schmoren.", "Abtropfen, mit verquirlten Eiern mischen, salzen.", "In der Pfanne beidseitig stocken lassen."]}, {"id": "th_tom_kha", "name": "Tom Kha Gai (Kokos-H√ºhnersuppe)", "local_names": [], "country": "Thailand", "region": "Asien", "category": "Suppe", "tags": ["kokosmilch", "zitronengras", "galgant"], "time_min": 30, "difficulty": "Leicht", "servings": "4", "story": "Aromatische Kokosbr√ºhe mit Galgant, Zitronengras und Limettenbl√§ttern.", "ingredients": ["400 ml Kokosmilch", "400 ml H√ºhnerbr√ºhe", "300 g H√§hnchenbrust, d√ºnn", "2 St√§ngel Zitronengras, angedr√ºckt", "4 Scheiben Galgant", "4 Kaffirlimettenbl√§tter", "Pilze, Fischsauce, Limettensaft, Chili"], "steps": ["Br√ºhe mit Gew√ºrzen 10 Min. ziehen lassen.", "Huhn und Pilze kurz garen.", "Mit Fischsauce, Limette und Chili abschmecken."]}, {"id": "br_feijoada", "name": "Feijoada Completa", "local_names": [], "country": "Brasilien", "region": "Lateinamerika", "category": "Eintopf", "tags": ["schwarzboehnen", "fleisch", "tradition"], "time_min": 240, "difficulty": "Mittel", "servings": "8", "story": "Brasilianischer Nationaleintopf aus schwarzen Bohnen mit verschiedenen Fleischsorten.", "ingredients": ["500 g schwarze Bohnen", "300 g Schweinebauch", "200 g Rippchen", "150 g Chorizo", "100 g Trockenfleisch", "2 Zwiebeln", "4 Knoblauchzehen", "Lorbeer, Salz, Pfeffer", "Reis, Farofa, Orangenscheiben"], "steps": ["Bohnen √ºber Nacht einweichen.", "Alle Fleischsorten separat kochen, dann zusammen mit Bohnen schmoren.", "Mit Zwiebeln, Knoblauch und Gew√ºrzen abschmecken.", "Mit Reis, Farofa und Orange servieren."]}, {"id": "kr_bibimbap", "name": "Bibimbap", "local_names": ["ÎπÑÎπîÎ∞•"], "country": "S√ºdkorea", "region": "Asien", "category": "Hauptgericht", "tags": ["reis", "gemuese", "gochujang"], "time_min": 45, "difficulty": "Mittel", "servings": "4", "story": "Reissch√ºssel mit verschiedenen Gem√ºsen und Gochujang-Sauce.", "ingredients": ["400 g Reis", "150 g Rinderhack", "2 Karotten, julienne", "1 Zucchini, julienne", "100 g Spinat", "4 Shiitake-Pilze", "4 Eier", "Gochujang, Sesam√∂l, Knoblauch, Sojasauce"], "steps": ["Reis kochen. Gem√ºse separat blanchieren und w√ºrzen.", "Rinderhack mit Sojasauce und Knoblauch braten.", "Alles in Sch√ºsseln anrichten, mit Ei und Gochujang servieren."]}, {"id": "pk_karahi_chicken", "name": "Karahi Chicken", "local_names": [], "country": "Pakistan", "region": "Asien", "category": "Hauptgericht", "tags": ["scharf", "tomaten", "ginger"], "time_min": 60, "difficulty": "Mittel", "servings": "4", "story": "Scharfes H√§hnchengericht in Tomaten-Ginger-Sauce.", "ingredients": ["800 g H√§hnchen", "4 Tomaten", "2 Zwiebeln", "4 Knoblauchzehen", "2 cm Ingwer", "2 gr√ºne Chilis", "Kurkuma, Kreuzk√ºmmel, Korianderpulver", "Garam Masala, Salz", "Koriandergr√ºn"], "steps": ["H√§hnchen w√ºrzen und anbraten.", "Zwiebeln glasig, Ingwer und Knoblauch zugeben.", "Tomaten zuf√ºgen, einkochen lassen.", "Mit Gew√ºrzen abschmecken, Koriander dar√ºber."]}, {"id": "ng_jollof_rice", "name": "Jollof Rice", "local_names": [], "country": "Nigeria", "region": "Afrika", "category": "Hauptgericht", "tags": ["reis", "tomaten", "gewuerze"], "time_min": 75, "difficulty": "Mittel", "servings": "6", "story": "Gew√ºrzter Reis mit Tomaten, einer der beliebtesten Gerichte Westafrikas.", "ingredients": ["400 g Basmatireis", "4 Tomaten", "2 Zwiebeln", "3 Knoblauchzehen", "2 cm Ingwer", "2 EL Tomatenmark", "Thymian, Curry, Paprika", "Gew√ºrznelken, Lorbeer", "√ñl, Salz"], "steps": ["Reis waschen und einweichen.", "Zwiebeln, Tomaten, Ingwer und Knoblauch p√ºrieren.", "Tomatenp√ºree mit Gew√ºrzen kochen, Reis zugeben.", "Bei niedriger Hitze 30 Min. garen lassen."]}, {"id": "ar_shawarma", "name": "Chicken Shawarma", "local_names": [], "country": "√Ñgypten", "region": "Afrika", "category": "Streetfood", "tags": ["huhn", "fladenbrot", "tahini"], "time_min": 120, "difficulty": "Mittel", "servings": "6", "story": "Gew√ºrztes H√§hnchen im Fladenbrot mit Tahini-Sauce.", "ingredients": ["1 kg H√§hnchenbrust", "4 Fladenbrote", "Zitrone, Knoblauch, Kreuzk√ºmmel", "Paprika, Kurkuma, Zimt", "Tahini, Joghurt, Petersilie", "Tomaten, Gurken, Zwiebeln"], "steps": ["H√§hnchen in Gew√ºrzmischung marinieren.", "Im Ofen oder auf dem Grill garen.", "In Fladenbrot mit Gem√ºse und Tahini-Sauce wickeln."]}, {"id": "id_nasi_goreng", "name": "Nasi Goreng", "local_names": [], "country": "Indonesien", "region": "Asien", "category": "Hauptgericht", "tags": ["reis", "sambal", "garnelen"], "time_min": 30, "difficulty": "Leicht", "servings": "4", "story": "Gebratener Reis mit Sambal, Garnelen und Ei.", "ingredients": ["400 g gekochter Reis", "200 g Garnelen", "2 Eier", "2 Knoblauchzehen", "2 EL Sambal Oelek", "Sojasauce, Kecap Manis", "Fr√ºhlingszwiebeln", "√ñl"], "steps": ["Eier als Omelett braten, in Streifen schneiden.", "Knoblauch anbraten, Garnelen zugeben.", "Reis, Sambal und Sojasaucen einr√ºhren.", "Mit Eistreifen und Fr√ºhlingszwiebeln servieren."]}, {"id": "za_bobotie", "name": "Bobotie", "local_names": [], "country": "S√ºdafrika", "region": "Afrika", "category": "Auflauf", "tags": ["hackfleisch", "curry", "eier"], "time_min": 90, "difficulty": "Mittel", "servings": "6", "story": "Gew√ºrztes Hackfleisch mit Curry und Eier-Topping.", "ingredients": ["600 g Rinderhack", "2 Zwiebeln", "2 √Ñpfel", "100 g Rosinen", "Currypulver, Kurkuma", "Brot, Milch", "4 Eier", "Lorbeer, Salz"], "steps": ["Hack mit Zwiebeln, √Ñpfeln und Gew√ºrzen braten.", "Mit eingeweichtem Brot und Rosinen mischen.", "Eier-Topping herstellen, √ºber das Fleisch geben.", "30 Min. backen."]}, {"id": "au_pavlova", "name": "Pavlova", "local_names": [], "country": "Australien", "region": "Ozeanien", "category": "Dessert", "tags": ["meringue", "obst", "sahne"], "time_min": 120, "difficulty": "Anspruchsvoll", "servings": "8", "story": "Luftiges Baiser mit Schlagsahne und frischen Fr√ºchten.", "ingredients": ["4 Eiwei√ü", "250 g Zucker", "2 TL Speisest√§rke", "1 TL Essig", "300 ml Schlagsahne", "Frische Beeren", "Passionsfrucht"], "steps": ["Eiwei√ü steif schlagen, Zucker einrieseln lassen.", "St√§rke und Essig unterheben.", "Baiser 90 Min. bei 120¬∞C backen, abk√ºhlen lassen.", "Mit Sahne und Fr√ºchten f√ºllen."]}, {"id": "fi_salmon_soup", "name": "Lohikeitto (Lachs-Suppe)", "local_names": [], "country": "Finnland", "region": "Europa", "category": "Suppe", "tags": ["lachs", "dill", "kartoffeln"], "time_min": 45, "difficulty": "Leicht", "servings": "4", "story": "Cremige Lachs-Suppe mit Dill und Kartoffeln.", "ingredients": ["400 g Lachsfilet", "4 Kartoffeln", "1 Zwiebel", "500 ml Fischfond", "200 ml Sahne", "Dill, Salz, Pfeffer", "Butter"], "steps": ["Kartoffeln und Zwiebel in Butter anschwitzen.", "Mit Fond aufgie√üen, 15 Min. kochen.", "Lachs zugeben, 5 Min. garen.", "Sahne und Dill einr√ºhren, abschmecken."]}, {"id": "no_gravlax", "name": "Gravlax", "local_names": [], "country": "Norwegen", "region": "Europa", "category": "Vorspeise", "tags": ["lachs", "dill", "roh"], "time_min": 1440, "difficulty": "Leicht", "servings": "8", "story": "Nordischer Lachs, in Salz, Zucker und Dill gebeizt.", "ingredients": ["800 g Lachsfilet", "100 g Salz", "100 g Zucker", "1 Bund Dill", "2 EL Aquavit (optional)", "Pfeffer"], "steps": ["Lachs mit Salz, Zucker, Dill und Aquavit einreiben.", "24-48 Stunden im K√ºhlschrank beizen.", "Abwaschen, in d√ºnne Scheiben schneiden.", "Mit Dill garnieren servieren."]}, {"id": "se_meatballs", "name": "K√∂ttbullar", "local_names": [], "country": "Schweden", "region": "Europa", "category": "Hauptgericht", "tags": ["hackfleisch", "preiselbeeren", "kartoffeln"], "time_min": 60, "difficulty": "Leicht", "servings": "4", "story": "Schwedische Fleischb√§llchen mit Preiselbeeren und Kartoffeln.", "ingredients": ["500 g Hackfleisch", "1 Zwiebel", "1 Ei", "50 g Semmelbr√∂sel", "Milch", "Kartoffeln", "Preiselbeermarmelade", "Br√ºhe, Sahne", "Salz, Pfeffer"], "steps": ["Fleischb√§llchen aus Hack, Zwiebel, Ei und Br√∂seln formen.", "Anbraten, mit Br√ºhe und Sahne abl√∂schen.", "Kartoffeln kochen, Preiselbeeren erw√§rmen.", "Alles zusammen servieren."]}, {"id": "dk_sm√∏rrebr√∏d", "name": "Sm√∏rrebr√∏d", "local_names": [], "country": "D√§nemark", "region": "Europa", "category": "Hauptgericht", "tags": ["brot", "fisch", "remoulade"], "time_min": 30, "difficulty": "Leicht", "servings": "4", "story": "D√§nische Butterbrote mit verschiedenen Bel√§gen.", "ingredients": ["Roggenbrot", "Butter", "Hering", "Lachs", "Remoulade", "Kapern", "Dill", "Eier", "Rote Bete"], "steps": ["Brot mit Butter bestreichen.", "Mit Fisch, Remoulade und Kapern belegen.", "Mit Dill und anderen Garnierungen dekorieren."]}, {"id": "is_hangikj√∂t", "name": "Hangikj√∂t", "local_names": [], "country": "Island", "region": "Europa", "category": "Hauptgericht", "tags": ["lamm", "ger√§uchert", "kartoffeln"], "time_min": 180, "difficulty": "Leicht", "servings": "6", "story": "Traditionell ger√§uchertes Lamm mit Kartoffeln.", "ingredients": ["1 kg ger√§uchertes Lamm", "1 kg Kartoffeln", "Wei√ükohl", "Wei√übrot", "Butter", "Salz"], "steps": ["Lamm in Salzwasser kochen.", "Kartoffeln und Kohl als Beilage zubereiten.", "Mit Wei√übrot und Butter servieren."]}, {"id": "pl_pierogi", "name": "Pierogi", "local_names": [], "country": "Polen", "region": "Europa", "category": "Hauptgericht", "tags": ["teigtaschen", "kartoffeln", "quark"], "time_min": 90, "difficulty": "Mittel", "servings": "6", "story": "Polnische Teigtaschen mit verschiedenen F√ºllungen.", "ingredients": ["400 g Mehl", "2 Eier", "Wasser", "Kartoffeln", "Quark", "Zwiebeln", "Speck", "Salz"], "steps": ["Teig kneten und ausrollen.", "F√ºllung aus Kartoffeln und Quark herstellen.", "Teigtaschen formen und in Salzwasser kochen.", "Mit gebratenen Zwiebeln und Speck servieren."]}, {"id": "hu_goulash", "name": "Guly√°s", "local_names": [], "country": "Ungarn", "region": "Europa", "category": "Eintopf", "tags": ["rindfleisch", "paprika", "kartoffeln"], "time_min": 150, "difficulty": "Mittel", "servings": "6", "story": "Ungarischer Rindfleisch-Eintopf mit Paprika.", "ingredients": ["800 g Rindfleisch", "4 Zwiebeln", "4 Paprika", "3 Tomaten", "4 Kartoffeln", "3 EL Paprikapulver", "Kreuzk√ºmmel, Lorbeer", "Salz, Pfeffer"], "steps": ["Fleisch w√ºrfeln und anbraten.", "Zwiebeln glasig, Paprika zugeben.", "Mit Tomaten und Gew√ºrzen aufgie√üen.", "Kartoffeln zuf√ºgen, 90 Min. schmoren."]}, {"id": "ro_mamaliga", "name": "MƒÉmƒÉligƒÉ", "local_names": [], "country": "Rum√§nien", "region": "Europa", "category": "Beilage", "tags": ["polenta", "k√§se", "butter"], "time_min": 30, "difficulty": "Leicht", "servings": "4", "story": "Rum√§nischer Maisbrei mit K√§se.", "ingredients": ["200 g Maismehl", "600 ml Wasser", "100 g K√§se", "Butter", "Salz"], "steps": ["Wasser salzen und zum Kochen bringen.", "Maismehl einrieseln lassen, r√ºhren.", "Mit K√§se und Butter vermischen.", "Servieren."]}, {"id": "bg_banitsa", "name": "Banitsa", "local_names": [], "country": "Bulgarien", "region": "Europa", "category": "Geb√§ck", "tags": ["bl√§tterteig", "k√§se", "ei"], "time_min": 60, "difficulty": "Mittel", "servings": "8", "story": "Bulgarischer Bl√§tterteig mit K√§se und Ei.", "ingredients": ["500 g Bl√§tterteig", "300 g Feta-K√§se", "4 Eier", "200 ml Joghurt", "Sonnenblumen√∂l", "Salz"], "steps": ["K√§se zerkr√ºmeln, mit Eiern und Joghurt mischen.", "Bl√§tterteig ausrollen und mit F√ºllung bestreichen.", "Aufrollen und in Form legen.", "30 Min. backen."]}, {"id": "hr_cevapi", "name": "ƒÜevapi", "local_names": [], "country": "Kroatien", "region": "Europa", "category": "Hauptgericht", "tags": ["fleisch", "grillen", "brot"], "time_min": 45, "difficulty": "Leicht", "servings": "4", "story": "Kleine gegrillte Fleischr√∂llchen im Fladenbrot.", "ingredients": ["600 g Hackfleisch", "1 Zwiebel", "Knoblauch", "Paprika", "Pita-Brot", "Zwiebeln", "Ajvar", "K√§se"], "steps": ["Hack mit Gew√ºrzen vermischen und zu R√∂llchen formen.", "Auf dem Grill garen.", "In Pita-Brot mit Zwiebeln, Ajvar und K√§se servieren."]}, {"id": "rs_sarma", "name": "Sarma", "local_names": [], "country": "Serbien", "region": "Europa", "category": "Hauptgericht", "tags": ["kohl", "hackfleisch", "reis"], "time_min": 120, "difficulty": "Mittel", "servings": "6", "story": "Kohlrouladen mit Hackfleisch und Reis.", "ingredients": ["1 Wei√ükohl", "400 g Hackfleisch", "150 g Reis", "Zwiebeln", "Tomatenmark", "Paprika", "Br√ºhe", "Salz, Pfeffer"], "steps": ["Kohlbl√§tter blanchieren.", "F√ºllung aus Hack, Reis und Gew√ºrzen herstellen.", "Kohlbl√§tter f√ºllen und einrollen.", "In Br√ºhe 90 Min. schmoren."]}, {"id": "ba_burek", "name": "Burek", "local_names": [], "country": "Bosnien", "region": "Europa", "category": "Geb√§ck", "tags": ["bl√§tterteig", "k√§se", "fleisch"], "time_min": 90, "difficulty": "Anspruchsvoll", "servings": "8", "story": "Bosnische Bl√§tterteigpastete mit Fleisch oder K√§se.", "ingredients": ["500 g Filo-Teig", "400 g Hackfleisch", "Zwiebeln", "Paprika", "√ñl", "Salz"], "steps": ["Hack mit Zwiebeln und Gew√ºrzen braten.", "Filo-Teig mit F√ºllung schichten.", "Mit √ñl bestreichen und backen.", "In Dreiecke schneiden servieren."]}, {"id": "mk_tavce", "name": "Tavƒçe Gravƒçe", "local_names": [], "country": "Nordmazedonien", "region": "Europa", "category": "Hauptgericht", "tags": ["bohnen", "paprika", "zwiebeln"], "time_min": 120, "difficulty": "Leicht", "servings": "6", "story": "Traditionelle Bohnenpfanne mit Paprika.", "ingredients": ["500 g wei√üe Bohnen", "4 Zwiebeln", "4 Paprika", "Tomatenmark", "Paprikapulver", "√ñl", "Salz"], "steps": ["Bohnen √ºber Nacht einweichen und kochen.", "Zwiebeln und Paprika anbraten.", "Mit Tomatenmark und Gew√ºrzen vermischen.", "In Tontopf 60 Min. backen."]},
  { 
  id: 'global_estimate_meta',
  name: 'Kulinarische Welt ‚Äì konservative Untergrenze (Sch√§tzung)',
  localName: 'Global Estimate (Conservative Lower Bound)',
  country: 'Welt',
  region: 'Global',
  category: 'Meta',
  difficulty: 'n/a',
  time: '-',
  serves: '-',
  tags: ['Statistik','Sch√§tzung','Meta','Global'],
  story: `Eine praktikable Sch√§tzung (konservativer Unterrand)

Wenn man nur ‚Äûklassische, benannte Gerichte" z√§hlt und extrem konservativ ansetzt ‚Äì z.B. mindestens 10‚Äì20 bekannte Gerichte pro Land ‚Äì kommt man schon auf Gr√∂√üenordnungen von vielen Tausend:

Europa (je nach Abgrenzung ~40‚Äì45 L√§nder): ‚â• 400‚Äì900
Asien (~45‚Äì50): ‚â• 450‚Äì1.000
Afrika (~50‚Äì55): ‚â• 500‚Äì1.100
Lateinamerika & Karibik (~30‚Äì35): ‚â• 300‚Äì700
Nordamerika (inkl. Mittelamerika & Karibik gez√§hlt oben; nur USA/Kanada/Mexiko separat macht die Region kleiner oder gr√∂√üer je nach Definition): ‚â• einige Hundert
Nahost (je nach Abgrenzung ~12‚Äì16): ‚â• 120‚Äì320
Ozeanien (inkl. Pazifikstaaten ~12‚Äì16): ‚â• 120‚Äì320

Selbst mit diesen Minimalannahmen landet man locker bei √ºber 2.000‚Äì5.000 unterschiedlichen, namentlich bekannten Gerichten ‚Äì und das ignoriert Hausrezepte, saisonale Varianten, Restaurant-Kreationen etc.

Wenn du eine harte Zahl willst, m√ºssen wir eine Definition festlegen

Zum Beispiel:

‚ÄûZ√§hle nur Gerichte mit eigenem Wikipedia-Eintrag pro Land" (recht streng).
‚ÄûZ√§hle nur Nationalgerichte/klassische Spezialit√§ten pro Land" (moderater).
‚ÄûZ√§hle alles inkl. Street-Food, Festtags- und Regionalgerichten" (breit).`,
  ingredients: ["Europa (‚âà40‚Äì45 L√§nder): ‚â• 400‚Äì900", "Asien (‚âà45‚Äì50): ‚â• 450‚Äì1.000", "Afrika (‚âà50‚Äì55): ‚â• 500‚Äì1.100", "Lateinamerika & Karibik (‚âà30‚Äì35): ‚â• 300‚Äì700", "Nordamerika (je nach Definition): ‚â• einige Hundert", "Nahost (‚âà12‚Äì16): ‚â• 120‚Äì320", "Ozeanien (‚âà12‚Äì16): ‚â• 120‚Äì320", "Gesamtsch√§tzung (konservativer Unterrand): > 2.000‚Äì5.000 benannte Gerichte"],
  steps: ["Definition w√§hlen: streng (nur Wikipedia-Eintr√§ge), moderat (Nationalgerichte/Spezialit√§ten) oder breit (inkl. Street-Food, Festtags-, Regionalgerichte).", "Je Land eine Liste erstellen, je Region aggregieren.", "Dubletten/Varianten bereinigen; Sprach-/Schreibvarianten konsolidieren.", "Regelm√§√üig aktualisieren; Quellenstand dokumentieren."],
  nutrition: null,
  image: null,
  source: 'Benutzerangabe, Stand 2025-10-15'
},
  { 
  id: 'meta_estimate_europa',
  name: 'Sch√§tzung (konservativ) ‚Äì Europa',
  localName: 'Europa ‚Äì Conservative Lower Bound',
  country: 'Europa',
  region: 'Europa',
  category: 'Meta',
  difficulty: 'n/a',
  time: '-',
  serves: '-',
  tags: ["Europa", "Sch√§tzung", "Meta"],
  story: `Europa (‚âà40‚Äì45 L√§nder): ‚â• 400‚Äì900

Hinweis: Konservative Untergrenze f√ºr ‚Äûklassische, benannte Gerichte" in der Region Europa.
Methodik: Minimalannahme je Land, Dubletten/Varianten nicht differenziert. Stand 2025-10-15.
`,
  ingredients: ["Europa (‚âà40‚Äì45 L√§nder): ‚â• 400‚Äì900"],
  steps: ["Definition w√§hlen", "L√§nder z√§hlen", "Aggregieren", "Quellenstand dokumentieren"],
  nutrition: null,
  image: null,
  source: 'Benutzerangabe, Stand 2025-10-15'
},
  { 
  id: 'meta_estimate_asien',
  name: 'Sch√§tzung (konservativ) ‚Äì Asien',
  localName: 'Asien ‚Äì Conservative Lower Bound',
  country: 'Asien',
  region: 'Asien',
  category: 'Meta',
  difficulty: 'n/a',
  time: '-',
  serves: '-',
  tags: ["Asien", "Sch√§tzung", "Meta"],
  story: `Asien (‚âà45‚Äì50): ‚â• 450‚Äì1.000

Hinweis: Konservative Untergrenze f√ºr ‚Äûklassische, benannte Gerichte" in der Region Asien.
Methodik: Minimalannahme je Land, Dubletten/Varianten nicht differenziert. Stand 2025-10-15.
`,
  ingredients: ["Asien (‚âà45‚Äì50): ‚â• 450‚Äì1.000"],
  steps: ["Definition w√§hlen", "L√§nder z√§hlen", "Aggregieren", "Quellenstand dokumentieren"],
  nutrition: null,
  image: null,
  source: 'Benutzerangabe, Stand 2025-10-15'
},
  { 
  id: 'meta_estimate_afrika',
  name: 'Sch√§tzung (konservativ) ‚Äì Afrika',
  localName: 'Afrika ‚Äì Conservative Lower Bound',
  country: 'Afrika',
  region: 'Afrika',
  category: 'Meta',
  difficulty: 'n/a',
  time: '-',
  serves: '-',
  tags: ["Afrika", "Sch√§tzung", "Meta"],
  story: `Afrika (‚âà50‚Äì55): ‚â• 500‚Äì1.100

Hinweis: Konservative Untergrenze f√ºr ‚Äûklassische, benannte Gerichte" in der Region Afrika.
Methodik: Minimalannahme je Land, Dubletten/Varianten nicht differenziert. Stand 2025-10-15.
`,
  ingredients: ["Afrika (‚âà50‚Äì55): ‚â• 500‚Äì1.100"],
  steps: ["Definition w√§hlen", "L√§nder z√§hlen", "Aggregieren", "Quellenstand dokumentieren"],
  nutrition: null,
  image: null,
  source: 'Benutzerangabe, Stand 2025-10-15'
},
  { 
  id: 'meta_estimate_lateinamerika_und_karibik',
  name: 'Sch√§tzung (konservativ) ‚Äì Lateinamerika & Karibik',
  localName: 'Lateinamerika & Karibik ‚Äì Conservative Lower Bound',
  country: 'Lateinamerika & Karibik',
  region: 'Lateinamerika',
  category: 'Meta',
  difficulty: 'n/a',
  time: '-',
  serves: '-',
  tags: ["Lateinamerika", "Karibik", "Sch√§tzung", "Meta"],
  story: `Lateinamerika & Karibik (‚âà30‚Äì35): ‚â• 300‚Äì700

Hinweis: Konservative Untergrenze f√ºr ‚Äûklassische, benannte Gerichte" in der Region Lateinamerika & Karibik.
Methodik: Minimalannahme je Land, Dubletten/Varianten nicht differenziert. Stand 2025-10-15.
`,
  ingredients: ["Lateinamerika & Karibik (‚âà30‚Äì35): ‚â• 300‚Äì700"],
  steps: ["Definition w√§hlen", "L√§nder z√§hlen", "Aggregieren", "Quellenstand dokumentieren"],
  nutrition: null,
  image: null,
  source: 'Benutzerangabe, Stand 2025-10-15'
},
  { 
  id: 'meta_estimate_nordamerika',
  name: 'Sch√§tzung (konservativ) ‚Äì Nordamerika',
  localName: 'Nordamerika ‚Äì Conservative Lower Bound',
  country: 'Nordamerika',
  region: 'Nordamerika',
  category: 'Meta',
  difficulty: 'n/a',
  time: '-',
  serves: '-',
  tags: ["Nordamerika", "Sch√§tzung", "Meta"],
  story: `Nordamerika (je nach Definition): ‚â• einige Hundert

Hinweis: Konservative Untergrenze f√ºr ‚Äûklassische, benannte Gerichte" in der Region Nordamerika.
Methodik: Minimalannahme je Land, Dubletten/Varianten nicht differenziert. Stand 2025-10-15.
`,
  ingredients: ["Nordamerika (je nach Definition): ‚â• einige Hundert"],
  steps: ["Definition w√§hlen", "L√§nder z√§hlen", "Aggregieren", "Quellenstand dokumentieren"],
  nutrition: null,
  image: null,
  source: 'Benutzerangabe, Stand 2025-10-15'
},
  { 
  id: 'meta_estimate_nahost',
  name: 'Sch√§tzung (konservativ) ‚Äì Nahost',
  localName: 'Nahost ‚Äì Conservative Lower Bound',
  country: 'Nahost',
  region: 'Nahost',
  category: 'Meta',
  difficulty: 'n/a',
  time: '-',
  serves: '-',
  tags: ["Nahost", "Sch√§tzung", "Meta"],
  story: `Nahost (‚âà12‚Äì16): ‚â• 120‚Äì320

Hinweis: Konservative Untergrenze f√ºr ‚Äûklassische, benannte Gerichte" in der Region Nahost.
Methodik: Minimalannahme je Land, Dubletten/Varianten nicht differenziert. Stand 2025-10-15.
`,
  ingredients: ["Nahost (‚âà12‚Äì16): ‚â• 120‚Äì320"],
  steps: ["Definition w√§hlen", "L√§nder z√§hlen", "Aggregieren", "Quellenstand dokumentieren"],
  nutrition: null,
  image: null,
  source: 'Benutzerangabe, Stand 2025-10-15'
},
  { 
  id: 'meta_estimate_ozeanien',
  name: 'Sch√§tzung (konservativ) ‚Äì Ozeanien',
  localName: 'Ozeanien ‚Äì Conservative Lower Bound',
  country: 'Ozeanien',
  region: 'Ozeanien',
  category: 'Meta',
  difficulty: 'n/a',
  time: '-',
  serves: '-',
  tags: ["Ozeanien", "Sch√§tzung", "Meta"],
  story: `Ozeanien (‚âà12‚Äì16): ‚â• 120‚Äì320

Hinweis: Konservative Untergrenze f√ºr ‚Äûklassische, benannte Gerichte" in der Region Ozeanien.
Methodik: Minimalannahme je Land, Dubletten/Varianten nicht differenziert. Stand 2025-10-15.
`,
  ingredients: ["Ozeanien (‚âà12‚Äì16): ‚â• 120‚Äì320"],
  steps: ["Definition w√§hlen", "L√§nder z√§hlen", "Aggregieren", "Quellenstand dokumentieren"],
  nutrition: null,
  image: null,
  source: 'Benutzerangabe, Stand 2025-10-15'
},
  { 
  id: 'meta_estimate_wikipedia_only',
  name: 'Z√§hlung (Wikipedia-Artikel, streng) ‚Äì global ‚âà 4.000',
  localName: 'Wikipedia-only (strict)',
  country: 'Welt',
  region: 'Global',
  category: 'Meta',
  difficulty: 'n/a',
  time: '-',
  serves: '-',
  tags: ['Meta','Z√§hlung','Wikipedia','Streng'],
  story: `Strenge Z√§hlungsidee: Z√§hle pro Land nur Gerichte mit eigenem Wikipedia-Artikel.
Hinweis: Hohe Datenverf√ºgbarkeit f√ºhrt trotz strenger Definition zu sehr gro√üen Zahlen.
Konservative Arbeitszahl (global): 4.000 (Bandbreite: 3.000‚Äì6.000). Stand 2025-10-15.`,
  ingredients: ["Globale Sch√§tzung (konservativ): 4.000", "Bandbreite: 3.000‚Äì6.000"],
  steps: ["Pro Land Wikipedia-Eintr√§ge sammeln", "Dubletten entfernen", "Summieren & dokumentieren"],
  nutrition: null,
  image: null,
  source: 'Heuristik/Sch√§tzung; exakte Erhebung erfordert Crawling'
},
  { 
  id: 'meta_estimate_national_dishes_only',
  name: 'Z√§hlung (Nationalgerichte, moderat) ‚Äì global ‚âà 400',
  localName: 'National dishes only (moderate)',
  country: 'Welt',
  region: 'Global',
  category: 'Meta',
  difficulty: 'n/a',
  time: '-',
  serves: '-',
  tags: ['Meta','Z√§hlung','Nationalgerichte','Moderat'],
  story: `Moderate Z√§hlungsidee: Pro Land 1‚Äì3 Nationalgerichte/klassische Spezialit√§ten.
Konservative Arbeitszahl (global): 400 (Bandbreite: 300‚Äì600). Stand 2025-10-15.`,
  ingredients: ["Globale Sch√§tzung (konservativ): 400", "Bandbreite: 300‚Äì600"],
  steps: ["Pro Land 1‚Äì3 etablierte Klassiker listen", "Dubletten vermeiden", "Summieren"],
  nutrition: null,
  image: null,
  source: 'Heuristik/Sch√§tzung; Definition: etablierte Klassiker'
},
  { 
  id: 'meta_estimate_all_inclusive',
  name: 'Z√§hlung (breit inkl. Street-Food) ‚Äì global ‚âà 7.500',
  localName: 'All inclusive (broad)',
  country: 'Welt',
  region: 'Global',
  category: 'Meta',
  difficulty: 'n/a',
  time: '-',
  serves: '-',
  tags: ['Meta','Z√§hlung','Breit','Street-Food'],
  story: `Breite Z√§hlungsidee: Inkludiere Street-Food, Festtags- und Regionalgerichte.
Konservative Arbeitszahl (global): 7.500 (Bandbreite: ‚â•5.000‚Äì10.000+). Stand 2025-10-15.`,
  ingredients: ["Globale Sch√§tzung (konservativ): 7.500", "Bandbreite: ‚â•5.000‚Äì10.000+"],
  steps: ["Pro Land breite Liste zusammentragen", "Regionale Varianten z√§hlen", "Summieren & dokumentieren"],
  nutrition: null,
  image: null,
  source: 'Heuristik/Sch√§tzung; bewusst breit'
},
  { 
  id: 'meta_total_counter',
  name: 'Gesamtanzahl Rezepte (App): 52',
  localName: 'Total recipes (app)',
  country: 'Welt',
  region: 'Global',
  category: 'Meta',
  difficulty: 'n/a',
  time: '-',
  serves: '-',
  tags: ['Meta','Z√§hler','Status'],
  story: `Gesamtanzahl der aktuell in der App hinterlegten Eintr√§ge (inkl. Meta-Datens√§tze): 52.
Hinweis: Dezente Anzeige ‚Äì nur als Datensatz sichtbar, keine UI/UX-√Ñnderung.
Stand 2025-10-15.`,
  ingredients: ["Aktueller Gesamtstand: 52"],
  steps: ["Nur Infoeintrag ‚Äì keine Zubereitung"],
  nutrition: null,
  image: null,
  source: 'Systemz√§hler'
}
];

/* === BEGIN: PACK LOADER (non-UI) =========================================
   SINGLE FILE MODE: Alle Rezepte sind bereits in DATA eingebettet
   CORS-Problem bei file:// Protokoll verhindert fetch() zu lokalen Dateien
   =========================================================================== */
console.log('üì¶ Single File Mode: Alle Rezepte bereits eingebettet');
console.log(`üìä Total recipes available: ${DATA.length}`);

// === AUTOMATISCHER IMPORT ALLER EXTERNER DATENBANKEN ===
// Wird nach EXTERNAL_DATA_SOURCES Definition ausgef√ºhrt
// === END: PACK LOADER =====================================================


// Simple index for search: join name, local, country, tags, ingredients, story
function toIndex(rec) {
  const fields = [
    rec.name, ...(rec.local_names||[]),
    rec.country, rec.region, rec.category,
    ...(rec.tags||[]),
    (rec.ingredients||[]).join(' '),
    rec.story
  ].join(' ').toLowerCase();
  return fields.normalize('NFD').replace(/\p{Diacritic}+/gu,'');
}

const INDEX = new Map();

// === REBUILD INDEX FUNCTION ===
function rebuildIndex() {
  console.log('üîÑ Rebuilding search index...');
  INDEX.clear();
  for (const r of DATA) {
    INDEX.set(r.id, toIndex(r));
  }
  console.log(`‚úÖ Index rebuilt: ${INDEX.size} recipes indexed`);
}

// Initial index build
rebuildIndex();

const $ = (sel, ctx=document) => ctx.querySelector(sel);
const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));

let filtered = [...DATA];
let page = 0;
let currentRecipe = null; // Aktuelles Rezept f√ºr Aktionen
const PAGE_SIZE = 24;

function updateRecipeCount() {
  const totalRecipes = DATA.length;
  const filteredRecipes = filtered.length;
  
  if (filteredRecipes === totalRecipes) {
    $('#count').textContent = `${totalRecipes} Rezepte`;
  } else {
    $('#count').textContent = `${filteredRecipes} von ${totalRecipes} Rezepten`;
  }
}

function applyFilters() {
  const q = ($('#search').value || '').toLowerCase().trim();
  const region = $('#region').value;
  const category = $('#category').value;
  const diff = $('#difficulty').value;

  filtered = DATA.filter(r => {
    if (region && r.region !== region) return false;
    if (category && r.category !== category) return false;
    if (diff && r.difficulty !== diff) return false;
    if (!q) return true;
    
    // Einfache Suche in allen Feldern
    const searchFields = [
      r.name,
      ...(r.local_names || []),
      r.country,
      r.region,
      r.category,
      ...(r.tags || []),
      (r.ingredients || []).join(' '),
      r.story
    ].join(' ').toLowerCase();
    
    return searchFields.includes(q);
  });

  // Show intelligent suggestions if no results
  if (filtered.length === 0 && q) {
    showIntelligentSuggestions(q);
    return;
  }

  page = 0;
  $('#results').innerHTML = '';
  renderNext();
  updateRecipeCount();
}

function showIntelligentSuggestions(searchTerm) {
  const suggestions = generateSuggestions(searchTerm);
  
  const resultsContainer = document.getElementById('results');
  resultsContainer.innerHTML = `
    <div class="no-results-card" style="grid-column: 1 / -1; text-align: center; padding: 40px; background: var(--card); border-radius: 18px; border: 1px solid #e2d3bf;">
      <h3 style="color: var(--accent); margin-bottom: 20px;">${translateText('noResults')}</h3>
      <p style="color: var(--muted); margin-bottom: 30px;">"${searchTerm}" ${translateText('orSearchFor')}</p>
      
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
        ${suggestions.map(suggestion => `
          <button class="btn" onclick="searchFor('${suggestion}')" style="padding: 15px; text-align: center;">
            ${suggestion}
          </button>
        `).join('')}
      </div>
      
      <div style="margin-top: 20px;">
        <button class="btn" onclick="clearSearch()" style="background: var(--accent2); color: white;">
          ${translateText('resetFilters')}
        </button>
      </div>
    </div>
  `;
  
  $('#count').textContent = `0 von ${DATA.length} Rezepten`;
}

function generateSuggestions(searchTerm) {
  const suggestions = new Set();
  
  // Find similar countries
  DATA.forEach(recipe => {
    if (recipe.country.toLowerCase().includes(searchTerm.toLowerCase()) || 
        searchTerm.toLowerCase().includes(recipe.country.toLowerCase())) {
      suggestions.add(recipe.country);
    }
  });
  
  // Find similar categories
  DATA.forEach(recipe => {
    if (recipe.category.toLowerCase().includes(searchTerm.toLowerCase()) || 
        searchTerm.toLowerCase().includes(recipe.category.toLowerCase())) {
      suggestions.add(translateCategory(recipe.category));
    }
  });
  
  // Find similar ingredients
  DATA.forEach(recipe => {
    recipe.ingredients?.forEach(ingredient => {
      if (ingredient.toLowerCase().includes(searchTerm.toLowerCase()) || 
          searchTerm.toLowerCase().includes(ingredient.toLowerCase())) {
        suggestions.add(ingredient);
      }
    });
  });
  
  // Find similar tags
  DATA.forEach(recipe => {
    recipe.tags?.forEach(tag => {
      if (tag.toLowerCase().includes(searchTerm.toLowerCase()) || 
          searchTerm.toLowerCase().includes(tag.toLowerCase())) {
        suggestions.add(tag);
      }
    });
  });
  
  // Add common suggestions if no matches
  if (suggestions.size === 0) {
    suggestions.add('Pasta');
    suggestions.add('Fleisch');
    suggestions.add('Vegetarisch');
    suggestions.add('Suppe');
    suggestions.add('Einfach');
  }
  
  return Array.from(suggestions).slice(0, 6);
}

function searchFor(term) {
  $('#search').value = term;
  applyFilters();
}

function clearSearch() {
  $('#search').value = '';
  $('#region').value = '';
  $('#category').value = '';
  $('#difficulty').value = '';
  applyFilters();
}

// fuzzy-ish: if query is 'hunger', match tags/story hints about s√§ttigend/leicht etc.
function suggest(q, hay) {
  const syn = {
    'hunger': ['satt','s√§ttigend','proteinreich','eintopf','nudeln','reis','schnell'],
    'leicht': ['leicht','suppe','salat','dampf','wenig fett'],
    'scharf': ['scharf','chili','pfeffer','berbere','doubanjiang'],
    'schnell': ['schnell','15','20','30','fix'],
    'vegetarisch': ['vegetarisch','tofu','linsen','gem√ºse','dal'],
  };
  for (const k in syn) {
    if (q.includes(k)) {
      for (const w of syn[k]) if (hay.includes(w)) return true;
    }
  }
  return false;
}

function card(rec) {
  return `
    <article class="card" data-id="${rec.id}">
      <h3>${rec.name}</h3>
      <div class="meta">
        <span>üåç ${translateRegion(rec.country)} ‚Ä¢ ${translateRegion(rec.region)}</span>
        <span>‚è±Ô∏è ${rec.time_min} Min</span>
        <span>üçΩÔ∏è ${rec.servings}</span>
        <span>‚öôÔ∏è ${translateDifficulty(rec.difficulty)}</span>
      </div>
      <div class="tags">${(rec.tags||[]).slice(0,5).map(t=>`<span class="tag">#${t}</span>`).join('')}</div>
      <div class="more"><span class="link" onclick="openModal('${rec.id.replace(/'/g, '\\\'')}')">Rezept √∂ffnen</span></div>
    </article>`;
}

function renderNext() {
  const start = page*PAGE_SIZE;
  const next = filtered.slice(start, start+PAGE_SIZE);
  const html = next.map(card).join('');
  $('#results').insertAdjacentHTML('beforeend', html);
  page++;
  if (start+PAGE_SIZE >= filtered.length) observer.disconnect();
  else observer.observe($('#sentinel'));
}

function openModal(id) {
  console.log('Opening modal for recipe ID:', id);
  const r = DATA.find(x=>x.id===id);
  if (!r) {
    console.error('Recipe not found for ID:', id);
    return;
  }
  
  console.log('Found recipe:', r.name);
  
  // Set current recipe for actions
  currentRecipe = r;
  
  // Update modal content safely
  const modalTitle = document.getElementById('modalTitle');
  const modalMeta = document.getElementById('modalMeta');
  const modalStory = document.getElementById('modalStory');
  const modalIngr = document.getElementById('modalIngr');
  const modalSteps = document.getElementById('modalSteps');
  const modal = document.getElementById('modal');
  
  if (modalTitle) modalTitle.textContent = r.name;
  if (modalMeta) modalMeta.innerHTML = `üåç ${translateRegion(r.country)} ‚Ä¢ ${translateRegion(r.region)} &nbsp; ‚è±Ô∏è ${r.time_min} Min &nbsp; üçΩÔ∏è ${r.servings} &nbsp; ‚öôÔ∏è ${translateDifficulty(r.difficulty)}`;
  if (modalStory) modalStory.textContent = r.story || '';
  if (modalIngr) modalIngr.innerHTML = (r.ingredients||[]).map(i=>`<li>${i}</li>`).join('');
  if (modalSteps) modalSteps.innerHTML = (r.steps||[]).map((s,i)=>`<li><strong>Schritt ${i+1}:</strong> ${s}</li>`).join('');
  if (modal) modal.classList.add('open');
  
  console.log('Modal opened successfully');
}

function closeModal() {
  // Statisches Modal schlie√üen
  const staticModal = document.getElementById('modal');
  if (staticModal) staticModal.classList.remove('open');

  // Dynamisches Rezept-Modal vollst√§ndig entfernen
  const dynamicRecipeModal = document.getElementById('recipe-modal');
  if (dynamicRecipeModal && dynamicRecipeModal.parentNode) {
    dynamicRecipeModal.parentNode.removeChild(dynamicRecipeModal);
  }
}

// ESC schlie√üt jedes Modal
window.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') closeModal();
});

// === SAMMLUNGSFUNKTIONEN ===
function addToCollection() {
  if (!currentRecipe) return;
  RECIPE_COLLECTION.add(currentRecipe.id);
  alert(`‚úÖ "${currentRecipe.name}" zur Sammlung hinzugef√ºgt!`);
}

function printRecipe() {
  if (!currentRecipe) return;
  const printWindow = window.open('', '_blank');
  printWindow.document.write(`
    <html>
      <head><title>${currentRecipe.name}</title></head>
      <body>
        <h1>${currentRecipe.name}</h1>
        <p><strong>Land:</strong> ${currentRecipe.country} ‚Ä¢ ${currentRecipe.region}</p>
        <p><strong>Zeit:</strong> ${currentRecipe.time_min} Min ‚Ä¢ <strong>Portionen:</strong> ${currentRecipe.servings} ‚Ä¢ <strong>Schwierigkeit:</strong> ${currentRecipe.difficulty}</p>
        <h2>Zutaten</h2>
        <ul>${(currentRecipe.ingredients||[]).map(i=>`<li>${i}</li>`).join('')}</ul>
        <h2>Zubereitung</h2>
        <ol>${(currentRecipe.steps||[]).map(s=>`<li>${s}</li>`).join('')}</ol>
      </body>
    </html>
  `);
  printWindow.document.close();
  printWindow.print();
}

function exportRecipe() {
  if (!currentRecipe) return;
  const dataStr = JSON.stringify(currentRecipe, null, 2);
  const dataBlob = new Blob([dataStr], {type: 'application/json'});
  const url = URL.createObjectURL(dataBlob);
  const link = document.createElement('a');
  link.href = url;
  link.download = `${currentRecipe.name.replace(/[^a-zA-Z0-9]/g, '_')}.json`;
  link.click();
  URL.revokeObjectURL(url);
}

const observer = new IntersectionObserver((entries)=>{
  for (const e of entries) if (e.isIntersecting) renderNext();
}, {root:null, rootMargin:'0px', threshold:1.0});

window.addEventListener('DOMContentLoaded', ()=>{
  // Populate filter options dynamically
  // Use translated dropdowns
  rebuildAllDropdowns();

  applyFilters(); // initialize
  $('#search').addEventListener('input', applyFilters);
  $('#region').addEventListener('change', applyFilters);
  $('#category').addEventListener('change', applyFilters);
  $('#difficulty').addEventListener('change', applyFilters);
  $('#clear').addEventListener('click', ()=>{
    $('#search').value=''; $('#region').value=''; $('#category').value=''; $('#difficulty').value=''; applyFilters();
  });
  
  // Multi-Choice Button Event Listener
  $('#multiSelect').addEventListener('click', showMultiChoiceModal);
  $('#musicMode').addEventListener('click', toggleMusicMode);
  $('#importExport').addEventListener('click', showImportExportModal);
  $('#dataSources').addEventListener('click', showDataSourcesModal);
  
  // Initialize Restaurant System
  createAdminButton();
  
  // Add restaurant-specific CSS
  const style = document.createElement('style');
  style.textContent = `
    .admin-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
    }
    
    .admin-modal {
      background: white;
      border-radius: 12px;
      width: 90%;
      max-width: 1000px;
      max-height: 80vh;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .admin-header {
      background: #8b6b4a;
      color: white;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .admin-tabs {
      display: flex;
      background: #f5f5f5;
      border-bottom: 1px solid #ddd;
    }
    
    .tab-btn {
      padding: 15px 20px;
      border: none;
      background: none;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      transition: all 0.3s ease;
    }
    
    .tab-btn.active {
      background: white;
      border-bottom-color: #8b6b4a;
    }
    
    .admin-body {
      padding: 20px;
      max-height: 60vh;
      overflow-y: auto;
    }
    
    .admin-tab {
      display: none;
    }
    
    .admin-tab.active {
      display: block;
    }
    
    .form-group {
      margin: 15px 0;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    
    .form-group input {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
    }
    
    .btn-primary, .btn-secondary, .btn-small {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    
    .btn-primary {
      background: #8b6b4a;
      color: white;
    }
    
    .btn-secondary {
      background: #6c757d;
      color: white;
    }
    
    .btn-small {
      padding: 5px 10px;
      font-size: 12px;
    }
    
    .menu-item-card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      margin: 10px 0;
      background: #f9f9f9;
    }
    
    .menu-controls {
      display: flex;
      gap: 15px;
      align-items: center;
      margin-top: 10px;
    }
    
    .live-order {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      margin: 10px 0;
      background: #fff;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .order-header {
      display: flex;
      justify-content: space-between;
      font-weight: bold;
      margin-bottom: 10px;
    }
    
    .order-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
    }
    
    .order-status {
      display: flex;
      gap: 5px;
    }
    
    .success {
      background: #d4edda;
      color: #155724;
      padding: 10px;
      border-radius: 6px;
      margin: 10px 0;
    }
    
    .api-info {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 6px;
      margin: 10px 0;
      font-family: monospace;
      font-size: 12px;
    }
    
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 5000;
      background: rgba(0,0,0,0.8);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .modal-content {
      background: white;
      border-radius: 12px;
      width: 90%;
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .modal-header {
      background: #8b6b4a;
      color: white;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-radius: 12px 12px 0 0;
    }
    
    .modal-body {
      padding: 20px;
    }
    
    .modal-footer {
      padding: 20px;
      border-top: 1px solid #ddd;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .recipe-info {
      display: flex;
      gap: 15px;
      margin: 15px 0;
      flex-wrap: wrap;
    }
    
    .recipe-ingredients ul {
      list-style: none;
      padding: 0;
    }
    
    .recipe-ingredients li {
      padding: 5px 0;
      border-bottom: 1px solid #f0f0f0;
    }
    
    .step {
      margin: 15px 0;
      padding: 10px;
      background: #f9f9f9;
      border-radius: 6px;
    }
    
    .close-btn {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: white;
    }
    
    .btn-collection, .btn-print, .btn-export, .btn-manage {
      padding: 10px 15px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    
    .btn-collection { background: #28a745; color: white; }
    .btn-print { background: #007bff; color: white; }
    .btn-export { background: #6c757d; color: white; }
    .btn-manage { background: #ffc107; color: black; }
    
    .collection-actions {
      margin-bottom: 20px;
      display: flex;
      gap: 10px;
    }
    
    .collection-item {
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 15px;
      margin: 10px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .btn-remove {
      background: #dc3545;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
    }
  `;
  document.head.appendChild(style);
});

// === MULTI-CHOICE MEN√ú SYSTEM ===
// Erweiterte Auswahl-Komponente f√ºr komplexe Men√ºfindung

// === MUSIC & VIBRATION SYSTEM ===
const MUSIC_VIBRATION_CONFIG = {
  tasteToMusic: {
    's√º√ü': { frequency: 440, duration: 1000, note: 'A4' },
    'sauer': { frequency: 554.37, duration: 800, note: 'C#5' },
    'scharf': { frequency: 659.25, duration: 600, note: 'E5' },
    'bitter': { frequency: 349.23, duration: 1200, note: 'F4' },
    'umami': { frequency: 220, duration: 1500, note: 'A3' },
    'salzig': { frequency: 293.66, duration: 900, note: 'D4' }
  },
  emotionToVibration: {
    'romantisch': [100, 200, 100],
    'gesellig': [150, 100, 150, 100],
    'entspannend': [50, 50, 50],
    'energetisch': [200, 100, 200, 100, 200],
    'tr√∂stlich': [80, 160, 80],
    'feierlich': [300, 100, 300, 100, 300]
  }
};

function playTasteMusic(taste) {
  if (!musicModeActive) return;
  
  const config = MUSIC_VIBRATION_CONFIG.tasteToMusic[taste];
  if (!config) return;
  
  try {
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    
    // Resume context if suspended (required by browsers)
    if (audioContext.state === 'suspended') {
      audioContext.resume();
    }
    
    const oscillator = audioContext.createOscillator();
    const gainNode = audioContext.createGain();
    
    oscillator.connect(gainNode);
    gainNode.connect(audioContext.destination);
    
    oscillator.frequency.setValueAtTime(config.frequency, audioContext.currentTime);
    oscillator.type = 'sine';
    
    // Smooth volume envelope
    gainNode.gain.setValueAtTime(0, audioContext.currentTime);
    gainNode.gain.linearRampToValueAtTime(0.15, audioContext.currentTime + 0.05);
    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + config.duration / 1000);
    
    oscillator.start(audioContext.currentTime);
    oscillator.stop(audioContext.currentTime + config.duration / 1000);
    
    console.log(`üéµ Audio SUCCESS: ${taste} (${config.frequency}Hz, ${config.note})`);
    return true;
  } catch (error) {
    console.error('‚ùå Audio FAILED:', error.message);
    return false;
  }
}

function vibrateForEmotion(emotion) {
  const pattern = MUSIC_VIBRATION_CONFIG.emotionToVibration[emotion];
  if (!pattern || !navigator.vibrate) return;
  
  navigator.vibrate(pattern);
  console.log(`üì≥ Vibrating for emotion: ${emotion}`);
}

const MULTI_CHOICE_CONFIG = {
  tasteProfiles: {
    's√º√ü': ['s√º√ü', 'zucker', 'honig', 'dessert', 'kuchen', 'eis'],
    'sauer': ['sauer', 'essig', 'zitrone', 'limette', 'sauerrahm'],
    'scharf': ['scharf', 'chili', 'pfeffer', 'paprika', 'curry', 'w√ºrzig'],
    'bitter': ['bitter', 'kakao', 'kaffee', 'gr√ºner tee', 'grapefruit'],
    'umami': ['umami', 'pilze', 'sojasauce', 'parmesan', 'fleisch'],
    'salzig': ['salzig', 'oliven', 'k√§se', 'speck', 'anchovis']
  },
  emotionStates: {
    'romantisch': ['romantisch', 'intim', 'kerzenlicht', 'wein', 'dessert'],
    'gesellig': ['gesellig', 'sharing', 'tapas', 'buffet', 'gemeinsam'],
    'entspannend': ['entspannend', 'leicht', 'suppe', 'tee', 'beruhigend'],
    'energetisch': ['energetisch', 'protein', 'energie', 'schnell', 'aktiv'],
    'tr√∂stlich': ['tr√∂stlich', 'komfort', 'eintopf', 'warm', 'famili√§r'],
    'feierlich': ['feierlich', 'festlich', 'luxus', 'champagner', 'delikatesse']
  },
  relationshipContext: {
    'dating': ['dating', 'romantisch', 'intim', 'elegant', 'privat'],
    'gesch√§ftlich': ['gesch√§ftlich', 'professionell', 'formal', 'business', 'meeting'],
    'partnerschaft': ['partnerschaft', 'gemeinsam', 'sharing', 'intim', 'verbunden'],
    'familie': ['familie', 'traditionell', 'gro√ü', 'komfort', 'heimisch'],
    'freunde': ['freunde', 'gesellig', 'lustig', 'casual', 'entspannt'],
    'sexuell': ['intim', 'sinnlich', 'verf√ºhrerisch', 'leidenschaftlich', 'k√∂rperfl√ºssigkeiten'],
    'duar': ['duar', 'zwei', 'paar', 'intim', 'verbunden']
  },
  businessContext: {
    'investment': ['investment', 'luxus', 'teuer', 'exklusiv', 'premium'],
    'networking': ['networking', 'gesch√§ftlich', 'professionell', 'treffen', 'verhandlung'],
    'b√∂rse': ['b√∂rse', 'finanz', 'trading', 'meeting', 'gesch√§ft'],
    'global': ['global', 'international', 'fusion', 'multikulti', 'weltweit'],
    'lokation': ['lokation', 'restaurant', 'location', 'ort', 'platz'],
    'bilanz': ['bilanz', 'finanz', 'gesch√§ft', 'b√∂rse', 'trading'],
    'interkommunikal': ['interkommunikal', 'global', 'international', 'vernetzt']
  },
  hungerLevels: {
    'appetit': ['appetit', 'klein', 'vorspeise', 'snack', 'leicht'],
    'hunger': ['hunger', 'normal', 'hauptgericht', 's√§ttigend', 'protein'],
    'gro√üer hunger': ['gro√üer hunger', 'gro√ü', 'eintopf', 'pasta', 'reis', 'kartoffeln'],
    'riesen hunger': ['riesen hunger', 'riesig', 'all you can eat', 'buffet', 'mehrere g√§nge'],
    'satt': ['satt', 'voll', 'dessert', 'kaffee', 'digestif']
  }
};

function showMultiChoiceModal() {
  const modal = document.createElement('div');
  modal.id = 'multi-choice-modal';
  modal.innerHTML = `
    <div class="modal-overlay" onclick="closeMultiChoiceModal()">
      <div class="modal-content" style="max-width: 900px;" onclick="event.stopPropagation()">
        <div class="modal-header">
          <h2>üéØ Multi-Choice Men√º Finder</h2>
          <button onclick="closeMultiChoiceModal()" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
          <div class="multi-choice-grid">
            <div class="choice-section">
              <h3>üçΩÔ∏è Geschmacksrichtung</h3>
              <div class="checkbox-grid">
                ${Object.keys(MULTI_CHOICE_CONFIG.tasteProfiles).map(taste => 
                  `<label class="checkbox-label">
                    <input type="checkbox" value="${taste}" data-category="taste">
                    <span class="checkmark">‚úì</span> ${taste}
                  </label>`
                ).join('')}
              </div>
            </div>
            
            <div class="choice-section">
              <h3>üí≠ Emotionen & Stimmung</h3>
              <div class="checkbox-grid">
                ${Object.keys(MULTI_CHOICE_CONFIG.emotionStates).map(emotion => 
                  `<label class="checkbox-label">
                    <input type="checkbox" value="${emotion}" data-category="emotion">
                    <span class="checkmark">‚úì</span> ${emotion}
                  </label>`
                ).join('')}
              </div>
            </div>
            
            <div class="choice-section">
              <h3>üë• Beziehungskontext</h3>
              <div class="checkbox-grid">
                ${Object.keys(MULTI_CHOICE_CONFIG.relationshipContext).map(context => 
                  `<label class="checkbox-label">
                    <input type="checkbox" value="${context}" data-category="relationship">
                    <span class="checkmark">‚úì</span> ${context}
                  </label>`
                ).join('')}
              </div>
            </div>
            
            <div class="choice-section">
              <h3>üíº Gesch√§ftskontext</h3>
              <div class="checkbox-grid">
                ${Object.keys(MULTI_CHOICE_CONFIG.businessContext).map(business => 
                  `<label class="checkbox-label">
                    <input type="checkbox" value="${business}" data-category="business">
                    <span class="checkmark">‚úì</span> ${business}
                  </label>`
                ).join('')}
              </div>
            </div>
            
            <div class="choice-section">
              <h3>üçΩÔ∏è Hungerlevel</h3>
              <div class="checkbox-grid">
                ${Object.keys(MULTI_CHOICE_CONFIG.hungerLevels).map(hunger => 
                  `<label class="checkbox-label">
                    <input type="checkbox" value="${hunger}" data-category="hunger">
                    <span class="checkmark">‚úì</span> ${hunger}
                  </label>`
                ).join('')}
              </div>
            </div>
          </div>
          
          <div class="location-section">
            <h3>üìç Restaurant Lokation</h3>
            <div class="location-grid">
              <label class="checkbox-label">
                <input type="checkbox" value="romantisch" data-category="location">
                <span class="checkmark">‚úì</span> Romantisches Restaurant
              </label>
              <label class="checkbox-label">
                <input type="checkbox" value="gesch√§ftlich" data-category="location">
                <span class="checkmark">‚úì</span> Business Restaurant
              </label>
              <label class="checkbox-label">
                <input type="checkbox" value="casual" data-category="location">
                <span class="checkmark">‚úì</span> Casual Dining
              </label>
              <label class="checkbox-label">
                <input type="checkbox" value="luxus" data-category="location">
                <span class="checkmark">‚úì</span> Luxus Restaurant
              </label>
              <label class="checkbox-label">
                <input type="checkbox" value="street" data-category="location">
                <span class="checkmark">‚úì</span> Street Food
              </label>
              <label class="checkbox-label">
                <input type="checkbox" value="home" data-category="location">
                <span class="checkmark">‚úì</span> Zuhause kochen
              </label>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button onclick="applyMultiChoice()" class="btn-primary">üéØ Men√º finden</button>
          <button onclick="selectAllChoices()" class="btn-secondary">‚úÖ Alle ausw√§hlen</button>
          <button onclick="clearAllChoices()" class="btn-secondary">‚ùå Alle abw√§hlen</button>
          <button onclick="closeMultiChoiceModal()" class="btn-secondary">Schlie√üen</button>
        </div>
      </div>
    </div>
  `;
  
  // CSS f√ºr Multi-Choice Modal hinzuf√ºgen
  if (!document.getElementById('multi-choice-css')) {
    const style = document.createElement('style');
    style.id = 'multi-choice-css';
    style.textContent = `
      .multi-choice-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0; }
      .choice-section { background: #fffdf8; border: 1px solid #e7d6c3; border-radius: 12px; padding: 15px; }
      .choice-section h3 { margin: 0 0 15px; color: var(--accent); font-size: 16px; }
      .checkbox-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 8px; }
      .checkbox-label { display: flex; align-items: center; cursor: pointer; padding: 5px; border-radius: 6px; transition: background 0.2s; }
      .checkbox-label:hover { background: #f0e6d6; }
      .checkbox-label input[type="checkbox"] { margin-right: 8px; transform: scale(1.2); }
      .checkmark { color: var(--accent); font-weight: bold; margin-left: 5px; }
      .location-section { background: #fffdf8; border: 1px solid #e7d6c3; border-radius: 12px; padding: 15px; margin-top: 20px; }
      .location-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px; }
    `;
    document.head.appendChild(style);
  }
  
  document.body.appendChild(modal);
}

function applyMultiChoice() {
  const selectedChoices = {
    taste: [],
    emotion: [],
    relationship: [],
    business: [],
    hunger: [],
    location: []
  };
  
  // Alle ausgew√§hlten Checkboxen sammeln
  document.querySelectorAll('#multi-choice-modal input[type="checkbox"]:checked').forEach(checkbox => {
    const category = checkbox.dataset.category;
    if (selectedChoices[category]) {
      selectedChoices[category].push(checkbox.value);
    }
  });
  
  // Suchbegriffe aus allen Kategorien zusammenstellen
  let searchTerms = [];
  
  Object.values(selectedChoices).forEach(categoryChoices => {
    categoryChoices.forEach(choice => {
      // Keywords aus der Konfiguration hinzuf√ºgen
      if (MULTI_CHOICE_CONFIG.tasteProfiles[choice]) {
        searchTerms.push(...MULTI_CHOICE_CONFIG.tasteProfiles[choice]);
      }
      if (MULTI_CHOICE_CONFIG.emotionStates[choice]) {
        searchTerms.push(...MULTI_CHOICE_CONFIG.emotionStates[choice]);
      }
      if (MULTI_CHOICE_CONFIG.relationshipContext[choice]) {
        searchTerms.push(...MULTI_CHOICE_CONFIG.relationshipContext[choice]);
      }
      if (MULTI_CHOICE_CONFIG.businessContext[choice]) {
        searchTerms.push(...MULTI_CHOICE_CONFIG.businessContext[choice]);
      }
      if (MULTI_CHOICE_CONFIG.hungerLevels[choice]) {
        searchTerms.push(...MULTI_CHOICE_CONFIG.hungerLevels[choice]);
      }
    });
  });
  
  // Suchfeld mit den Begriffen f√ºllen
  const searchInput = document.getElementById('search');
  searchInput.value = searchTerms.join(' ');
  
  // Filter anwenden
  applyFilters();
  
  // Modal schlie√üen
  closeMultiChoiceModal();
  
  // Musik und Vibration wenn aktiv
  if (musicModeActive) {
    selectedChoices.taste.forEach(taste => playTasteMusic(taste));
    selectedChoices.emotion.forEach(emotion => vibrateForEmotion(emotion));
  }
  
  // Erfolgsmeldung
  console.log('üéØ Multi-Choice Suche angewendet:', searchTerms);
}

function selectAllChoices() {
  document.querySelectorAll('#multi-choice-modal input[type="checkbox"]').forEach(checkbox => {
    checkbox.checked = true;
  });
}

function clearAllChoices() {
  document.querySelectorAll('#multi-choice-modal input[type="checkbox"]').forEach(checkbox => {
    checkbox.checked = false;
  });
}

function closeMultiChoiceModal() {
  const modal = document.getElementById('multi-choice-modal');
  if (modal) modal.remove();
}

// === EXTERNE DATENQUELLEN SYSTEM ===
const EXTERNAL_DATA_SOURCES = {
  sources: [
    {
      id: 'kaggle_2m_recipes',
      name: 'Recipe Dataset (2M+ Rezepte)',
      provider: 'Kaggle',
      url: 'https://www.kaggle.com/datasets/wilmerarltstrmberg/recipe-dataset-over-2m',
      description: '√úber 2 Millionen Rezepte global - von Brot bis franz√∂sischer K√ºche',
      regions: ['Global', 'Europa', 'Asien', 'Amerika'],
      size: '2M+',
      format: 'JSON',
      features: ['Zutaten', 'Schritte', 'Kategorien', 'Duplikat-Bereinigung'],
      sampleData: [
        {"name": "French Baguette", "country": "Frankreich", "region": "Europa", "category": "Brot", "time_min": 180, "difficulty": "Mittel", "ingredients": ["500g Mehl", "10g Hefe", "300ml Wasser", "10g Salz"], "steps": ["Hefe in lauwarmem Wasser aufl√∂sen", "Mehl und Salz mischen", "Teig kneten bis glatt", "1 Stunde gehen lassen", "Backen bei 220¬∞C f√ºr 25 Min"]},
        {"name": "Swedish Sm√∂rg√•sbord", "country": "Schweden", "region": "Europa", "category": "Buffet", "time_min": 120, "difficulty": "Anspruchsvoll", "ingredients": ["Verschiedene Aufschnitt", "Gravad Lax", "K√§se", "Brot", "Gurken", "Eier"], "steps": ["Alles in Sch√ºsseln anrichten", "Kalt servieren", "Traditionell mit Schnaps"]},
        {"name": "Boeuf Bourguignon", "country": "Frankreich", "region": "Europa", "category": "Eintopf", "time_min": 180, "difficulty": "Anspruchsvoll", "ingredients": ["1kg Rindfleisch", "750ml Rotwein", "200g Speck", "Zwiebeln", "M√∂hren", "Champignons"], "steps": ["Fleisch w√ºrfeln und anbraten", "Gem√ºse hinzuf√ºgen", "Mit Wein abl√∂schen", "3 Stunden schmoren"]},
        {"name": "Wiener Schnitzel", "country": "√ñsterreich", "region": "Europa", "category": "Fleisch", "time_min": 30, "difficulty": "Mittel", "ingredients": ["4 Kalbsschnitzel", "Eier", "Mehl", "Semmelbr√∂sel", "Butter"], "steps": ["Fleisch klopfen", "Panieren", "In Butter goldbraun braten", "Mit Zitrone servieren"]},
        {"name": "Paella Valenciana", "country": "Spanien", "region": "Europa", "category": "Reisgericht", "time_min": 90, "difficulty": "Anspruchsvoll", "ingredients": ["400g Risottoreis", "Safran", "Meeresfr√ºchte", "H√§hnchen", "Paprika"], "steps": ["Sofrito zubereiten", "Reis hinzuf√ºgen", "Mit Br√ºhe aufgie√üen", "Meeresfr√ºchte einlegen"]},
        {"name": "Risotto Milanese", "country": "Italien", "region": "Europa", "category": "Reisgericht", "time_min": 45, "difficulty": "Mittel", "ingredients": ["320g Risottoreis", "Safran", "Zwiebel", "Wei√üwein", "Parmesan"], "steps": ["Zwiebel glasig d√ºnsten", "Reis hinzuf√ºgen", "Mit Wein abl√∂schen", "Langsam Br√ºhe hinzuf√ºgen"]},
        {"name": "Ratatouille", "country": "Frankreich", "region": "Europa", "category": "Gem√ºse", "time_min": 60, "difficulty": "Mittel", "ingredients": ["Auberginen", "Zucchini", "Tomaten", "Paprika", "Zwiebeln"], "steps": ["Gem√ºse w√ºrfeln", "Einzeln anbraten", "Zusammen schmoren", "Mit Kr√§utern w√ºrzen"]},
        {"name": "Goulash", "country": "Ungarn", "region": "Europa", "category": "Eintopf", "time_min": 120, "difficulty": "Mittel", "ingredients": ["1kg Rindfleisch", "Paprika", "Zwiebeln", "Tomaten", "Kartoffeln"], "steps": ["Fleisch anbraten", "Gem√ºse hinzuf√ºgen", "Mit Paprika w√ºrzen", "Schmoren lassen"]}
      ]
    },
    {
      id: 'tib_recipe1m',
      name: 'Recipe1M+ Dataset',
      provider: 'TIB Hannover',
      url: 'https://service.tib.eu/ldmservice/dataset/recipe1m--dataset',
      description: '√úber 1 Million Rezepte mit Bildern und regionaler NER-Zuordnung',
      regions: ['International', 'KI-Klassifikation'],
      size: '1M+',
      format: 'JSON + DCAT',
      features: ['Bilder', 'Named Entity Recognition', 'Kategorien', 'KI-Training'],
      sampleData: [
        {"name": "Pad Thai", "country": "Thailand", "region": "Asien", "category": "Nudeln", "time_min": 30, "difficulty": "Mittel", "ingredients": ["200g Reisnudeln", "150g Tofu", "100g Bohnensprossen", "50g Erdn√ºsse", "2 Eier", "Fr√ºhlingszwiebeln"], "steps": ["Nudeln einweichen", "Wok erhitzen", "Tofu anbraten", "Eier hinzuf√ºgen", "Nudeln und Sauce zugeben", "Mit Erdn√ºssen garnieren"]},
        {"name": "Chicken Tikka Masala", "country": "Indien", "region": "Asien", "category": "Curry", "time_min": 60, "difficulty": "Mittel", "ingredients": ["500g H√§hnchen", "200ml Joghurt", "Curry-Paste", "400ml Kokosmilch", "Zwiebeln", "Tomaten"], "steps": ["H√§hnchen marinieren", "Curry-Sauce zubereiten", "H√§hnchen braten", "Mit Sauce garen", "Mit Reis servieren"]},
        {"name": "Sushi Nigiri", "country": "Japan", "region": "Asien", "category": "Fisch", "time_min": 45, "difficulty": "Anspruchsvoll", "ingredients": ["Sushi-Reis", "Frischer Fisch", "Wasabi", "Sojasauce", "Nori"], "steps": ["Reis kochen", "Fisch schneiden", "Reis formen", "Fisch auflegen", "Mit Wasabi servieren"]},
        {"name": "Bibimbap", "country": "S√ºdkorea", "region": "Asien", "category": "Reisgericht", "time_min": 40, "difficulty": "Mittel", "ingredients": ["Reis", "Rindfleisch", "Gem√ºse", "Gochujang", "Sesam√∂l", "Ei"], "steps": ["Reis kochen", "Gem√ºse blanchieren", "Fleisch braten", "Alles in Sch√ºssel anrichten", "Mit Sauce mischen"]},
        {"name": "Pho Bo", "country": "Vietnam", "region": "Asien", "category": "Suppe", "time_min": 120, "difficulty": "Anspruchsvoll", "ingredients": ["Rinderbr√ºhe", "Reisnudeln", "Rindfleisch", "Zwiebeln", "Ingwer", "Gew√ºrze"], "steps": ["Br√ºhe 2h kochen", "Nudeln kochen", "Fleisch d√ºnn schneiden", "Alles zusammen servieren"]},
        {"name": "Dim Sum", "country": "China", "region": "Asien", "category": "Teigtaschen", "time_min": 90, "difficulty": "Anspruchsvoll", "ingredients": ["Teig", "Schweinefleisch", "Krabben", "Pilze", "Sojasauce"], "steps": ["Teig herstellen", "F√ºllung zubereiten", "Taschen formen", "D√§mpfen", "Mit Sauce servieren"]},
        {"name": "Tom Yum Goong", "country": "Thailand", "region": "Asien", "category": "Suppe", "time_min": 25, "difficulty": "Mittel", "ingredients": ["Krabben", "Zitronengras", "Galangal", "Chilischoten", "Kaffirbl√§tter", "Limettenbl√§tter"], "steps": ["Br√ºhe aufkochen", "Gew√ºrze hinzuf√ºgen", "Krabben kochen", "Mit Kr√§utern garnieren"]},
        {"name": "Ramen Tonkotsu", "country": "Japan", "region": "Asien", "category": "Nudelsuppe", "time_min": 180, "difficulty": "Anspruchsvoll", "ingredients": ["Schweineknochen", "Ramen-Nudeln", "Chashu", "Ajitama", "Nori", "Fr√ºhlingszwiebeln"], "steps": ["Knochen 12h kochen", "Br√ºhe filtrieren", "Nudeln kochen", "Alles zusammen servieren"]}
      ]
    },
    {
      id: 'gitlab_recipes',
      name: 'recipes.json Dataset',
      provider: 'GitLab',
      url: 'https://frosch.cosy.sbg.ac.at/datasets/json/recipes',
      description: '1.617 Rezepte - internationale und britische BBC Good Food Sammlung',
      regions: ['International', 'Gro√übritannien'],
      size: '1.6K',
      format: 'JSON',
      features: ['Kompakt', 'BBC Good Food', 'Strukturiert'],
      sampleData: [
        {"name": "Fish & Chips", "country": "Gro√übritannien", "region": "Europa", "category": "Fisch", "time_min": 45, "difficulty": "Mittel", "ingredients": ["500g Kabeljau", "4 gro√üe Kartoffeln", "Mehl", "Bier", "Essig", "Erbsen"], "steps": ["Fisch in Bierteig wenden", "Kartoffeln in Streifen schneiden", "Alles frittieren", "Mit Essig und Erbsen servieren"]},
        {"name": "Shepherd's Pie", "country": "Gro√übritannien", "region": "Europa", "category": "Auflauf", "time_min": 90, "difficulty": "Mittel", "ingredients": ["500g Hackfleisch", "1kg Kartoffeln", "Zwiebeln", "M√∂hren", "Erbsen", "Br√ºhe"], "steps": ["Fleisch anbraten", "Gem√ºse hinzuf√ºgen", "Kartoffeln stampfen", "Auflauf formen und backen"]},
        {"name": "Full English Breakfast", "country": "Gro√übritannien", "region": "Europa", "category": "Fr√ºhst√ºck", "time_min": 30, "difficulty": "Einfach", "ingredients": ["Eier", "Speck", "W√ºrstchen", "Bohnen", "Tomaten", "Pilze", "Toast"], "steps": ["Alles in Pfannen braten", "Auf Teller anrichten", "Mit Toast servieren"]},
        {"name": "Beef Wellington", "country": "Gro√übritannien", "region": "Europa", "category": "Fleisch", "time_min": 150, "difficulty": "Anspruchsvoll", "ingredients": ["1kg Rinderfilet", "Bl√§tterteig", "Champignons", "Foie Gras", "Senf"], "steps": ["Fleisch anbraten", "Pilz-Duxelles zubereiten", "In Bl√§tterteig wickeln", "Backen bis goldbraun"]},
        {"name": "Yorkshire Pudding", "country": "Gro√übritannien", "region": "Europa", "category": "Beilage", "time_min": 60, "difficulty": "Mittel", "ingredients": ["Mehl", "Eier", "Milch", "Salz", "Fett"], "steps": ["Teig r√ºhren", "Muffin-F√∂rmchen einfetten", "Teig einf√ºllen", "Backen bis aufgegangen"]},
        {"name": "Sticky Toffee Pudding", "country": "Gro√übritannien", "region": "Europa", "category": "Dessert", "time_min": 75, "difficulty": "Mittel", "ingredients": ["Datteln", "Mehl", "Zucker", "Butter", "Eier", "Toffee-Sauce"], "steps": ["Datteln kochen", "Teig herstellen", "Backen", "Mit warmer Toffee-Sauce servieren"]},
        {"name": "Bangers and Mash", "country": "Gro√übritannien", "region": "Europa", "category": "Fleisch", "time_min": 45, "difficulty": "Einfach", "ingredients": ["W√ºrstchen", "Kartoffeln", "Milch", "Butter", "Zwiebeln"], "steps": ["W√ºrstchen braten", "Kartoffeln stampfen", "Zwiebelsauce zubereiten", "Alles zusammen servieren"]},
        {"name": "Cornish Pasty", "country": "Gro√übritannien", "region": "Europa", "category": "Teigtasche", "time_min": 120, "difficulty": "Anspruchsvoll", "ingredients": ["Bl√§tterteig", "Rindfleisch", "Kartoffeln", "Steckr√ºben", "Zwiebeln"], "steps": ["F√ºllung zubereiten", "Teig ausrollen", "Taschen formen", "Backen bis goldbraun"]}
      ]
    },
    {
      id: 'ai_prompt_generator',
      name: 'AI Prompt Recipe Generator',
      provider: 'DocsBot AI',
      url: 'https://docsbot.ai/prompts/creative/recipe-json-dataset',
      description: 'Generiert gro√üe JSON-Datens√§tze mit benutzerdefinierter regionaler Vielfalt',
      regions: ['Benutzerdefiniert', 'Global'],
      size: 'Variable',
      format: 'JSON + Bilder',
      features: ['KI-Generiert', 'Bild-URLs', 'Regional angepasst'],
      sampleData: [
        {"name": "Paella Valenciana", "country": "Spanien", "region": "Europa", "category": "Reisgericht", "time_min": 90, "difficulty": "Anspruchsvoll", "ingredients": ["400g Risottoreis", "Safran", "Meeresfr√ºchte", "H√§hnchen", "Paprika", "Artischocken"], "steps": ["Sofrito zubereiten", "Reis hinzuf√ºgen", "Mit Br√ºhe aufgie√üen", "Meeresfr√ºchte einlegen"]},
        {"name": "Jollof Rice", "country": "Nigeria", "region": "Afrika", "category": "Reisgericht", "time_min": 75, "difficulty": "Mittel", "ingredients": ["2 Tassen Basmatireis", "Tomaten", "Zwiebeln", "Gew√ºrze", "H√§hnchen", "Gem√ºse"], "steps": ["Tomatenp√ºree kochen", "Gew√ºrze hinzuf√ºgen", "Reis hinzuf√ºgen", "Garen lassen"]},
        {"name": "Ceviche Peruano", "country": "Peru", "region": "Lateinamerika", "category": "Fisch", "time_min": 30, "difficulty": "Einfach", "ingredients": ["500g Wei√üer Fisch", "Limettensaft", "Rote Zwiebeln", "Cilantro", "Chili", "S√º√ükartoffeln"], "steps": ["Fisch w√ºrfeln", "Mit Limettensaft marinieren", "Zwiebeln und Chili hinzuf√ºgen", "Mit S√º√ükartoffeln servieren"]},
        {"name": "Feijoada", "country": "Brasilien", "region": "Lateinamerika", "category": "Eintopf", "time_min": 180, "difficulty": "Anspruchsvoll", "ingredients": ["Schwarze Bohnen", "Verschiedene Fleischsorten", "Lorbeerbl√§tter", "Knoblauch", "Zwiebeln"], "steps": ["Bohnen √ºber Nacht einweichen", "Fleisch anbraten", "Alles zusammen schmoren", "Mit Reis servieren"]},
        {"name": "Tacos al Pastor", "country": "Mexiko", "region": "Lateinamerika", "category": "Fleisch", "time_min": 120, "difficulty": "Mittel", "ingredients": ["Schweinefleisch", "Ananas", "Chili", "Zwiebeln", "Tortillas", "Cilantro"], "steps": ["Fleisch marinieren", "Am Spie√ü braten", "In Tortillas wickeln", "Mit Ananas garnieren"]},
        {"name": "Bun Bo Hue", "country": "Vietnam", "region": "Asien", "category": "Nudelsuppe", "time_min": 150, "difficulty": "Anspruchsvoll", "ingredients": ["Rinderbr√ºhe", "Reisnudeln", "Rindfleisch", "Lemongrass", "Chili", "Basilikum"], "steps": ["Br√ºhe 3h kochen", "Gew√ºrze hinzuf√ºgen", "Nudeln kochen", "Alles zusammen servieren"]},
        {"name": "Baklava", "country": "T√ºrkei", "region": "Naher Osten", "category": "Dessert", "time_min": 120, "difficulty": "Anspruchsvoll", "ingredients": ["Filo-Teig", "Waln√ºsse", "Honig", "Zimt", "Butter", "Zitrone"], "steps": ["N√ºsse hacken", "Teig schichten", "Backen", "Mit Honig-Sirup betr√§ufeln"]},
        {"name": "Shakshuka", "country": "Israel", "region": "Naher Osten", "category": "Eier", "time_min": 30, "difficulty": "Einfach", "ingredients": ["Tomaten", "Paprika", "Zwiebeln", "Eier", "Cumin", "Chili"], "steps": ["Gem√ºse anbraten", "Tomaten hinzuf√ºgen", "Eier hineinschlagen", "Mit Brot servieren"]}
      ]
    }
  ],
  
  loadExternalSource: async function(sourceId) {
    const source = this.sources.find(s => s.id === sourceId);
    if (!source) return { success: false, error: 'Quelle nicht gefunden' };
    
    try {
      // Simuliere das Laden von externen Daten (in echter Implementierung w√ºrde hier fetch() stehen)
      const sampleRecipes = source.sampleData;
      
      // Konvertiere zu unserem Format
      const convertedRecipes = sampleRecipes.map(recipe => ({
        id: `${sourceId}_${recipe.name.toLowerCase().replace(/\s+/g, '_')}`,
        name: recipe.name,
        local_names: [recipe.name],
        country: recipe.country,
        region: recipe.region,
        category: recipe.category,
        tags: [recipe.category, recipe.region, recipe.difficulty.toLowerCase()],
        time_min: recipe.time_min,
        difficulty: recipe.difficulty,
        servings: "4",
        story: `Importiert aus ${source.name} - ${source.description}`,
        ingredients: recipe.ingredients,
        steps: recipe.steps,
        nutrition: null,
        image: null,
        source: `External: ${source.provider}`
      }));
      
      // F√ºge zu DATA hinzu
      let importedCount = 0;
      convertedRecipes.forEach(recipe => {
        const existingIndex = DATA.findIndex(r => r.id === recipe.id);
        if (existingIndex >= 0) {
          DATA[existingIndex] = recipe; // √úberschreiben
        } else {
          DATA.push(recipe); // Hinzuf√ºgen
          importedCount++;
        }
      });
      
      // UI aktualisieren
      rebuildIndex();
      applyFilters();
      
      return { 
        success: true, 
        imported: importedCount, 
        total: convertedRecipes.length,
        source: source.name 
      };
      
    } catch (error) {
      return { success: false, error: error.message };
    }
  }
};

// === AUTOMATISCHER IMPORT ALLER EXTERNER DATENBANKEN ===
(async function loadAllExternalDatabases() {
  console.log('üåç Lade alle externen Datenbanken...');
  
  let totalImported = 0;
  const sources = EXTERNAL_DATA_SOURCES.sources;
  
  for (const source of sources) {
    try {
      const result = await EXTERNAL_DATA_SOURCES.loadExternalSource(source.id);
      if (result.success) {
        totalImported += result.imported;
        console.log(`‚úÖ ${source.name}: ${result.imported} Rezepte importiert`);
      }
    } catch (error) {
      console.warn(`‚ö†Ô∏è Fehler beim Laden von ${source.name}:`, error.message);
    }
  }
  
  console.log(`üéØ Alle Datenbanken geladen: ${totalImported} neue Rezepte, ${DATA.length} total`);
  
  // UI aktualisieren nach dem Import
  rebuildIndex();
  applyFilters();
})();

// === INFO POPUP HOVER HAPTIC TOUCH SYSTEM ===
const INFO_POPUP_SYSTEM = {
  activePopups: new Set(),
  
  createInfoPopup: function(content, target, position = 'top') {
    // Entferne existierende Popups
    this.closeAllPopups();
    
    const popup = document.createElement('div');
    popup.className = 'info-popup';
    popup.style.cssText = `
      position: absolute;
      background: rgba(0,0,0,0.95);
      color: white;
      padding: 12px 16px;
      border-radius: 8px;
      font-size: 13px;
      line-height: 1.4;
      z-index: 10000;
      max-width: 300px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.1);
      pointer-events: none;
      opacity: 0;
      transform: scale(0.8);
      transition: all 0.2s ease;
    `;
    
    popup.innerHTML = content;
    
    // Positionierung
    const rect = target.getBoundingClientRect();
    const popupRect = { width: 300, height: 100 }; // Gesch√§tzt
    
    let top, left;
    switch(position) {
      case 'top':
        top = rect.top - popupRect.height - 10;
        left = rect.left + (rect.width / 2) - (popupRect.width / 2);
        break;
      case 'bottom':
        top = rect.bottom + 10;
        left = rect.left + (rect.width / 2) - (popupRect.width / 2);
        break;
      case 'left':
        top = rect.top + (rect.height / 2) - (popupRect.height / 2);
        left = rect.left - popupRect.width - 10;
        break;
      case 'right':
        top = rect.top + (rect.height / 2) - (popupRect.height / 2);
        left = rect.right + 10;
        break;
    }
    
    // Viewport-Begrenzung
    top = Math.max(10, Math.min(top, window.innerHeight - popupRect.height - 10));
    left = Math.max(10, Math.min(left, window.innerWidth - popupRect.width - 10));
    
    popup.style.top = top + 'px';
    popup.style.left = left + 'px';
    
    document.body.appendChild(popup);
    this.activePopups.add(popup);
    
    // Animation
    setTimeout(() => {
      popup.style.opacity = '1';
      popup.style.transform = 'scale(1)';
    }, 10);
    
    // Haptic Feedback
    this.triggerHapticFeedback();
    
    return popup;
  },
  
  closeAllPopups: function() {
    this.activePopups.forEach(popup => {
      if (popup && popup.parentNode) {
        popup.style.opacity = '0';
        popup.style.transform = 'scale(0.8)';
        setTimeout(() => popup.remove(), 200);
      }
    });
    this.activePopups.clear();
  },
  
  triggerHapticFeedback: function() {
    // Vibration f√ºr Haptic Feedback
    if (navigator.vibrate) {
      navigator.vibrate([50]);
    }
    
    // Audio Feedback
    if (musicModeActive) {
      this.playInfoSound();
    }
  },
  
  playInfoSound: function() {
    try {
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
      oscillator.type = 'sine';
      
      gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
      
      oscillator.start(audioContext.currentTime);
      oscillator.stop(audioContext.currentTime + 0.1);
    } catch (error) {
      console.log('Audio feedback nicht verf√ºgbar:', error.message);
    }
  }
};

// === MENU INFO POPUP FUNCTIONS ===
function showMenuInfo(menuId, event) {
  const menuInfos = {
    multiSelect: `
      <div style="font-weight: bold; margin-bottom: 8px;">üéØ Multi-Choice Men√º</div>
      <div style="color: #ccc; margin-bottom: 6px;">Erweiterte Auswahl nach:</div>
      <div style="margin-left: 10px;">
        ‚Ä¢ Geschmacksrichtungen (s√º√ü, sauer, scharf, etc.)<br>
        ‚Ä¢ Emotionen (romantisch, gesellig, entspannend)<br>
        ‚Ä¢ Beziehungskontext (dating, gesch√§ftlich, partnerschaft)<br>
        ‚Ä¢ Hungergef√ºhlen und Lokationen<br>
        ‚Ä¢ Business & B√∂rsen-Transaktionen
      </div>
      <div style="color: #4CAF50; margin-top: 8px; font-size: 11px;">
        üí° Mit Musik & Vibration wenn aktiviert
      </div>
    `,
    musicMode: `
      <div style="font-weight: bold; margin-bottom: 8px;">üéµ Musik-Modus</div>
      <div style="color: #ccc; margin-bottom: 6px;">Aktiviert Audio & Haptic Feedback:</div>
      <div style="margin-left: 10px;">
        ‚Ä¢ Geschmack ‚Üí Musik-Frequenzen<br>
        ‚Ä¢ Emotionen ‚Üí Vibration-Patterns<br>
        ‚Ä¢ Info-Popups ‚Üí Audio-Feedback<br>
        ‚Ä¢ Touch-Events ‚Üí Haptic Response
      </div>
      <div style="color: #FF9800; margin-top: 8px; font-size: 11px;">
        üîä Web Audio API + Vibration API
      </div>
    `,
    importExport: `
      <div style="font-weight: bold; margin-bottom: 8px;">üìÅ Import/Export System</div>
      <div style="color: #ccc; margin-bottom: 6px;">Rezept-Datenbank Management:</div>
      <div style="margin-left: 10px;">
        ‚Ä¢ JSON-Import von externen Quellen<br>
        ‚Ä¢ Export aller oder ausgew√§hlter Rezepte<br>
        ‚Ä¢ Rezept-Sammlung verwalten<br>
        ‚Ä¢ Backup & Restore Funktionen<br>
        ‚Ä¢ Multi-Format Unterst√ºtzung
      </div>
      <div style="color: #2196F3; margin-top: 8px; font-size: 11px;">
        üíæ Lokale Speicherung + JSON-Standards
      </div>
    `,
    dataSources: `
      <div style="font-weight: bold; margin-bottom: 8px;">üåç Externe Datenquellen</div>
      <div style="color: #ccc; margin-bottom: 6px;">Weltweite Rezept-Datens√§tze:</div>
      <div style="margin-left: 10px;">
        ‚Ä¢ <strong>Kaggle:</strong> 2M+ Rezepte (Global)<br>
        ‚Ä¢ <strong>TIB Hannover:</strong> 1M+ mit KI-Klassifikation<br>
        ‚Ä¢ <strong>GitLab:</strong> 1.6K BBC Good Food<br>
        ‚Ä¢ <strong>AI Generator:</strong> Benutzerdefiniert
      </div>
      <div style="color: #9C27B0; margin-top: 8px; font-size: 11px;">
        üîó Links zu Original-Quellen verf√ºgbar
      </div>
    `
  };
  
  const content = menuInfos[menuId];
  if (content) {
    INFO_POPUP_SYSTEM.createInfoPopup(content, event.target, 'bottom');
  }
}

function hideMenuInfo() {
  INFO_POPUP_SYSTEM.closeAllPopups();
}

// === EXTERNAL PROVIDER INFO FUNCTIONS ===
function showExternalProviderInfo(providerId, event) {
  const providerInfos = {
    kaggle: `
      <div style="font-weight: bold; margin-bottom: 8px;">üìä Kaggle Recipe Dataset</div>
      <div style="color: #ccc; margin-bottom: 6px;">Weltweit gr√∂√üte Rezept-Sammlung:</div>
      <div style="margin-left: 10px;">
        ‚Ä¢ <strong>2+ Millionen Rezepte</strong><br>
        ‚Ä¢ Global von Brot bis franz√∂sischer K√ºche<br>
        ‚Ä¢ Strukturierte Zutaten & Schritte<br>
        ‚Ä¢ Duplikat-Bereinigung durchgef√ºhrt<br>
        ‚Ä¢ JSON-Format f√ºr einfache Integration
      </div>
      <div style="color: #FF6B35; margin-top: 8px; font-size: 11px;">
        üîó <a href="https://www.kaggle.com/datasets/wilmerarltstrmberg/recipe-dataset-over-2m" target="_blank" style="color: #FF6B35;">Original ansehen ‚Üí</a>
      </div>
    `,
    tib: `
      <div style="font-weight: bold; margin-bottom: 8px;">üèõÔ∏è TIB Recipe1M+ Dataset</div>
      <div style="color: #ccc; margin-bottom: 6px;">Wissenschaftlicher Datensatz:</div>
      <div style="margin-left: 10px;">
        ‚Ä¢ <strong>1+ Million Rezepte</strong> mit Bildern<br>
        ‚Ä¢ Named Entity Recognition (NER)<br>
        ‚Ä¢ KI-Training optimiert<br>
        ‚Ä¢ DCAT-Metadaten Standard<br>
        ‚Ä¢ Regional-Klassifikation via KI
      </div>
      <div style="color: #4CAF50; margin-top: 8px; font-size: 11px;">
        üîó <a href="https://service.tib.eu/ldmservice/dataset/recipe1m--dataset" target="_blank" style="color: #4CAF50;">Original ansehen ‚Üí</a>
      </div>
    `,
    gitlab: `
      <div style="font-weight: bold; margin-bottom: 8px;">üîß GitLab recipes.json</div>
      <div style="color: #ccc; margin-bottom: 6px;">Kompakte Rezept-Sammlung:</div>
      <div style="margin-left: 10px;">
        ‚Ä¢ <strong>1.617 Rezepte</strong> strukturiert<br>
        ‚Ä¢ Internationale & britische K√ºche<br>
        ‚Ä¢ BBC Good Food Integration<br>
        ‚Ä¢ JSON-Format kompakt<br>
        ‚Ä¢ Direkt verwendbar
      </div>
      <div style="color: #FF9800; margin-top: 8px; font-size: 11px;">
        üîó <a href="https://frosch.cosy.sbg.ac.at/datasets/json/recipes" target="_blank" style="color: #FF9800;">Original ansehen ‚Üí</a>
      </div>
    `,
    ai_prompt: `
      <div style="font-weight: bold; margin-bottom: 8px;">ü§ñ AI Prompt Recipe Generator</div>
      <div style="color: #ccc; margin-bottom: 6px;">KI-generierte Rezept-Datens√§tze:</div>
      <div style="margin-left: 10px;">
        ‚Ä¢ <strong>Variable Gr√∂√üe</strong> nach Bedarf<br>
        ‚Ä¢ Benutzerdefinierte Regionen<br>
        ‚Ä¢ Bild-URLs inklusive<br>
        ‚Ä¢ Regional angepasste Inhalte<br>
        ‚Ä¢ JSON + Bilder Format
      </div>
      <div style="color: #9C27B0; margin-top: 8px; font-size: 11px;">
        üîó <a href="https://docsbot.ai/prompts/creative/recipe-json-dataset" target="_blank" style="color: #9C27B0;">Original ansehen ‚Üí</a>
      </div>
    `
  };
  
  const content = providerInfos[providerId];
  if (content) {
    INFO_POPUP_SYSTEM.createInfoPopup(content, event.target, 'right');
  }
}

// === MUSIC MODE ===
let musicModeActive = false;

function toggleMusicMode() {
  musicModeActive = !musicModeActive;
  const musicButton = document.getElementById('musicMode');
  
  if (musicModeActive) {
    musicButton.textContent = 'üéµ Musik-Modus ON';
    musicButton.style.background = 'linear-gradient(180deg,#e6d6f4,#d6c6e4)';
    console.log('üéµ Musik-Modus aktiviert');
    
    // Audio-Test beim Aktivieren
    testAudioSystem();
  } else {
    musicButton.textContent = 'üéµ Musik-Modus';
    musicButton.style.background = 'linear-gradient(180deg,#f6eadb,#eadcc8)';
    console.log('üéµ Musik-Modus deaktiviert');
  }
}

// === AUDIO SYSTEM TEST ===
function testAudioSystem() {
  console.log('üîä Testing Audio System...');
  
  try {
    // Test Web Audio API
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    console.log('‚úÖ Web Audio API: Available');
    console.log(`üìä Audio Context State: ${audioContext.state}`);
    console.log(`üéõÔ∏è Sample Rate: ${audioContext.sampleRate}Hz`);
    
    // Test Vibration API
    if (navigator.vibrate) {
      console.log('‚úÖ Vibration API: Available');
      navigator.vibrate([100, 50, 100]);
    } else {
      console.log('‚ùå Vibration API: Not Available');
    }
    
    // Test Audio Playback
    const oscillator = audioContext.createOscillator();
    const gainNode = audioContext.createGain();
    
    oscillator.connect(gainNode);
    gainNode.connect(audioContext.destination);
    
    oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
    oscillator.type = 'sine';
    
    gainNode.gain.setValueAtTime(0, audioContext.currentTime);
    gainNode.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.1);
    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
    
    oscillator.start(audioContext.currentTime);
    oscillator.stop(audioContext.currentTime + 0.5);
    
    console.log('‚úÖ Audio Playback: SUCCESS');
    console.log('üéµ Audio System: FULLY FUNCTIONAL');
    
  } catch (error) {
    console.error('‚ùå Audio System Test FAILED:', error.message);
    console.log('üîß Audio System: NEEDS ATTENTION');
  }
}

// === IMPORT/EXPORT MODAL ===
function showImportExportModal() {
  const modal = document.createElement('div');
  modal.id = 'import-export-modal';
  modal.innerHTML = `
    <div class="modal-overlay" onclick="closeImportExportModal()">
      <div class="modal-content" style="max-width: 600px;" onclick="event.stopPropagation()">
        <div class="modal-header">
          <h2>üìÅ Import/Export Rezepte</h2>
          <button onclick="closeImportExportModal()" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
          <div class="import-section">
            <h3>üì• Rezepte importieren</h3>
            <input type="file" id="importFileInput" accept=".json" class="file-input">
            <label for="importFileInput" class="file-label">üìÅ JSON-Datei ausw√§hlen</label>
            <button onclick="importRecipes()" class="btn-import">üì• Rezepte importieren</button>
          </div>
          
          <div class="export-section">
            <h3>üì§ Rezepte exportieren</h3>
            <button onclick="exportRecipes()" class="btn-export">üì§ Alle Rezepte exportieren</button>
            <button onclick="exportSelectedRecipes()" class="btn-export-selected">üì§ Ausgew√§hlte Rezepte exportieren</button>
          </div>
          
          <div class="collection-section">
            <h3>üíæ Rezept-Sammlung</h3>
            <button onclick="showCollectionManager()" class="btn-collection">üìö Sammlung verwalten</button>
          </div>
        </div>
        <div class="modal-footer">
          <button onclick="closeImportExportModal()" class="btn-secondary">Schlie√üen</button>
        </div>
      </div>
    </div>
  `;
  
  document.body.appendChild(modal);
}

function closeImportExportModal() {
  const modal = document.getElementById('import-export-modal');
  if (modal) modal.remove();
}

function importRecipes() {
  const fileInput = document.getElementById('importFileInput');
  const file = fileInput.files[0];
  if (!file) {
    alert('Bitte w√§hlen Sie eine JSON-Datei aus');
    return;
  }
  
  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      const data = JSON.parse(e.target.result);
      let recipes = [];
      
      // Verschiedene JSON-Formate unterst√ºtzen
      if (Array.isArray(data)) {
        recipes = data;
      } else if (data.recipes && Array.isArray(data.recipes)) {
        recipes = data.recipes;
      } else if (data.data && Array.isArray(data.data)) {
        recipes = data.data;
      } else {
        throw new Error('Ung√ºltiges JSON-Format');
      }
      
      let importedCount = 0;
      recipes.forEach(recipe => {
        if (recipe.name && recipe.ingredients && recipe.steps) {
          const newRecipe = {
            id: recipe.id || `imported_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
            name: recipe.name,
            local_names: recipe.local_names || [recipe.name],
            country: recipe.country || 'Unbekannt',
            region: recipe.region || 'International',
            category: recipe.category || 'Sonstiges',
            tags: recipe.tags || [],
            time_min: recipe.time_min || 30,
            difficulty: recipe.difficulty || 'Mittel',
            servings: recipe.servings || '4',
            story: recipe.story || 'Importiertes Rezept',
            ingredients: recipe.ingredients,
            steps: recipe.steps,
            nutrition: recipe.nutrition || null,
            image: recipe.image || null,
            source: 'Importiert'
          };
          
          // Pr√ºfe auf Duplikate
          const existingIndex = DATA.findIndex(r => r.id === newRecipe.id || r.name === newRecipe.name);
          if (existingIndex >= 0) {
            DATA[existingIndex] = newRecipe; // √úberschreiben
          } else {
            DATA.push(newRecipe); // Hinzuf√ºgen
            importedCount++;
          }
        }
      });
      
      // UI aktualisieren
      rebuildIndex();
      applyFilters();
      closeImportExportModal();
      
      alert(`‚úÖ Import erfolgreich!\n\nüì• ${importedCount} neue Rezepte importiert\nüéØ Gesamt: ${DATA.length} Rezepte verf√ºgbar`);
      
    } catch (error) {
      alert(`‚ùå Import fehlgeschlagen!\n\nFehler: ${error.message}`);
    }
  };
  reader.readAsText(file);
}

function exportRecipes() {
  const exportData = {
    version: "1.0",
    timestamp: new Date().toISOString(),
    totalRecipes: DATA.length,
    recipes: DATA
  };
  
  const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `MMM_Recipes_Export_${new Date().toISOString().split('T')[0]}.json`;
  a.click();
  URL.revokeObjectURL(url);
  
  alert(`‚úÖ Export erfolgreich!\n\nüì§ ${DATA.length} Rezepte exportiert`);
}

function exportSelectedRecipes() {
  // Hier k√∂nnte man ausgew√§hlte Rezepte exportieren
  // F√ºr jetzt exportieren wir alle
  exportRecipes();
}

// === DATENQUELLEN MODAL ===
function showDataSourcesModal() {
  const modal = document.createElement('div');
  modal.id = 'data-sources-modal';
  modal.innerHTML = `
    <div class="modal-overlay" onclick="closeDataSourcesModal()">
      <div class="modal-content" style="max-width: 1000px;" onclick="event.stopPropagation()">
        <div class="modal-header">
          <h2>üåç Externe Datenquellen - Weltweite Rezept-Datens√§tze</h2>
          <button onclick="closeDataSourcesModal()" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
          <div class="data-sources-grid">
            ${EXTERNAL_DATA_SOURCES.sources.map(source => `
              <div class="data-source-card" onmouseenter="showExternalProviderInfo('${source.id}', event)" onmouseleave="hideMenuInfo()">
                <div class="source-header">
                  <h3>${source.name}</h3>
                  <div class="source-badge">${source.provider}</div>
                </div>
                <div class="source-info">
                  <p class="source-description">${source.description}</p>
                  <div class="source-meta">
                    <span class="meta-item">üìä ${source.size} Rezepte</span>
                    <span class="meta-item">üåç ${source.regions.join(', ')}</span>
                    <span class="meta-item">üìÅ ${source.format}</span>
                  </div>
                  <div class="source-features">
                    ${source.features.map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                  </div>
                </div>
                <div class="source-preview">
                  <h4>Vorschau der besten Rezepte:</h4>
                  <div class="preview-recipes">
                    ${source.sampleData.map(recipe => `
                      <div class="preview-recipe">
                        <strong>${recipe.name}</strong>
                        <span>${recipe.country} ‚Ä¢ ${recipe.time_min} Min ‚Ä¢ ${recipe.difficulty}</span>
                      </div>
                    `).join('')}
                  </div>
                </div>
                <div class="source-actions">
                  <button onclick="loadExternalSource('${source.id}')" class="btn-load-source">
                    üì• ${source.sampleData.length} Rezepte importieren
                  </button>
                  <a href="${source.url}" target="_blank" class="btn-external-link">
                    üîó Original ansehen
                  </a>
                </div>
              </div>
            `).join('')}
          </div>
          
          <div class="backup-section">
            <h3>üíæ Backup & Restore</h3>
            <p>Exportieren Sie Ihre komplette Rezeptdatenbank als Backup oder stellen Sie sie wieder her:</p>
            <div class="backup-actions">
              <button onclick="exportCompleteDatabase()" class="btn-backup">üíæ Komplette Datenbank exportieren</button>
              <button onclick="showRestoreModal()" class="btn-restore">üîÑ Datenbank wiederherstellen</button>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button onclick="closeDataSourcesModal()" class="btn-secondary">Schlie√üen</button>
        </div>
      </div>
    </div>
  `;
  
  // CSS f√ºr Datenquellen hinzuf√ºgen
  if (!document.getElementById('data-sources-css')) {
    const style = document.createElement('style');
    style.id = 'data-sources-css';
    style.textContent = `
      .data-sources-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 20px; margin: 20px 0; }
      .data-source-card { background: #fffdf8; border: 1px solid #e7d6c3; border-radius: 12px; padding: 20px; }
      .source-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
      .source-header h3 { margin: 0; color: var(--accent); font-size: 18px; }
      .source-badge { background: var(--accent2); color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; }
      .source-description { color: var(--muted); margin-bottom: 15px; line-height: 1.5; }
      .source-meta { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
      .meta-item { background: #f0e6d6; padding: 4px 8px; border-radius: 6px; font-size: 12px; color: var(--muted); }
      .source-features { display: flex; gap: 6px; margin-bottom: 20px; flex-wrap: wrap; }
      .feature-tag { background: #e8dccb; color: var(--accent); padding: 3px 6px; border-radius: 4px; font-size: 11px; }
      .source-preview { margin-bottom: 20px; }
      .source-preview h4 { margin: 0 0 10px; color: var(--accent); font-size: 14px; }
      .preview-recipes { display: flex; flex-direction: column; gap: 6px; }
      .preview-recipe { background: #f9f5f0; padding: 8px; border-radius: 6px; font-size: 12px; }
      .preview-recipe strong { color: var(--accent); }
      .preview-recipe span { color: var(--muted); margin-left: 10px; }
      .source-actions { display: flex; gap: 10px; }
      .btn-load-source { background: var(--accent); color: white; border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer; font-size: 12px; }
      .btn-external-link { background: var(--accent2); color: white; text-decoration: none; padding: 10px 15px; border-radius: 8px; font-size: 12px; }
      .backup-section { background: #fffdf8; border: 1px solid #e7d6c3; border-radius: 12px; padding: 20px; margin-top: 30px; }
      .backup-actions { display: flex; gap: 15px; margin-top: 15px; }
      .btn-backup, .btn-restore { padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; }
      .btn-backup { background: var(--accent); color: white; }
      .btn-restore { background: var(--accent2); color: white; }
    `;
    document.head.appendChild(style);
  }
  
  document.body.appendChild(modal);
}

function closeDataSourcesModal() {
  const modal = document.getElementById('data-sources-modal');
  if (modal) modal.remove();
}

async function loadExternalSource(sourceId) {
  const result = await EXTERNAL_DATA_SOURCES.loadExternalSource(sourceId);
  
  if (result.success) {
    alert(`‚úÖ Erfolgreich importiert!\n\nüì• ${result.imported} neue Rezepte aus ${result.source}\nüéØ Gesamt: ${DATA.length} Rezepte verf√ºgbar\n\nDie neuen Rezepte sind sofort durchsuchbar!`);
  } else {
    alert(`‚ùå Import fehlgeschlagen!\n\nFehler: ${result.error}`);
  }
}

function exportCompleteDatabase() {
  const exportData = {
    version: "1.0",
    timestamp: new Date().toISOString(),
    platform: navigator.platform,
    totalRecipes: DATA.length,
    recipes: DATA,
    metadata: {
      exportSource: "MMM - Complete Database Backup",
      description: "Komplette Rezeptdatenbank mit allen 52 Original-Rezepten plus importierten externen Rezepten"
    }
  };
  
  const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `MMM_Complete_Database_Backup_${new Date().toISOString().split('T')[0]}.json`;
  a.click();
  URL.revokeObjectURL(url);
  
  console.log('üíæ Complete database exported:', DATA.length);
}

function showRestoreModal() {
  const modal = document.createElement('div');
  modal.id = 'restore-modal';
  modal.innerHTML = `
    <div class="modal-overlay" onclick="closeRestoreModal()">
      <div class="modal-content" style="max-width: 600px;" onclick="event.stopPropagation()">
        <div class="modal-header">
          <h2>üîÑ Datenbank wiederherstellen</h2>
          <button onclick="closeRestoreModal()" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
          <p><strong>‚ö†Ô∏è Achtung:</strong> Das Wiederherstellen √ºberschreibt alle aktuellen Rezepte!</p>
          <input type="file" id="restoreFileInput" accept=".json" class="file-input">
          <label for="restoreFileInput" class="file-label">üìÅ Backup-Datei ausw√§hlen</label>
          <button onclick="restoreDatabase()" class="btn-restore">üîÑ Datenbank wiederherstellen</button>
        </div>
        <div class="modal-footer">
          <button onclick="closeRestoreModal()" class="btn-secondary">Abbrechen</button>
        </div>
      </div>
    </div>
  `;
  
  document.body.appendChild(modal);
}

function closeRestoreModal() {
  const modal = document.getElementById('restore-modal');
  if (modal) modal.remove();
}

function restoreDatabase() {
  const fileInput = document.getElementById('restoreFileInput');
  const file = fileInput.files[0];
  if (!file) {
    alert('Bitte w√§hlen Sie eine Backup-Datei aus');
    return;
  }
  
  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      const backupData = JSON.parse(e.target.result);
      
      if (backupData.recipes && Array.isArray(backupData.recipes)) {
        // √úberschreibe komplette DATA
        DATA.length = 0;
        DATA.push(...backupData.recipes);
        
        // UI aktualisieren
        rebuildIndex();
        applyFilters();
        
        closeRestoreModal();
        alert(`‚úÖ Datenbank erfolgreich wiederhergestellt!\n\nüì• ${backupData.recipes.length} Rezepte geladen\nüéØ Gesamt: ${DATA.length} Rezepte verf√ºgbar`);
      } else {
        throw new Error('Ung√ºltiges Backup-Format');
      }
    } catch (error) {
      alert(`‚ùå Wiederherstellung fehlgeschlagen!\n\nFehler: ${error.message}`);
    }
  };
  reader.readAsText(file);
}

// === RESTAURANT INTEGRATION SYSTEM ===
// Unsichtbare API-Schnittstellen f√ºr Restaurant-Business

// Restaurant API Configuration
const RESTAURANT_API = {
  endpoints: {
    recipes: '/api/v1/recipes',
    orders: '/api/v1/orders',
    menu: '/api/v1/menu',
    inventory: '/api/v1/inventory',
    payments: '/api/v1/payments',
    webhooks: '/api/v1/webhooks'
  },
  auth: {
    apiKey: null,
    secret: null,
    tenantId: null
  }
};

// Admin Panel (unten rechts, dezent)
function createAdminButton() {
  const adminBtn = document.createElement('div');
  adminBtn.id = 'admin-panel-trigger';
  adminBtn.innerHTML = '‚öôÔ∏è';
  adminBtn.style.cssText = `
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 50px;
    height: 50px;
    background: rgba(139, 107, 74, 0.9);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 20px;
    z-index: 1000;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  `;
  adminBtn.onmouseover = () => adminBtn.style.transform = 'scale(1.1)';
  adminBtn.onmouseout = () => adminBtn.style.transform = 'scale(1)';
  adminBtn.onclick = showAdminPanel;
  document.body.appendChild(adminBtn);
}

// Admin Panel Modal
function showAdminPanel() {
  const modal = document.createElement('div');
  modal.id = 'admin-modal';
  modal.innerHTML = `
    <div class="admin-overlay">
      <div class="admin-modal">
        <div class="admin-header">
          <h2>üçΩÔ∏è Restaurant Business Portal</h2>
          <button onclick="closeAdminPanel()" class="close-btn">&times;</button>
        </div>
        <div class="admin-content">
          <div class="admin-tabs">
            <button class="tab-btn active" onclick="showAdminTab('login')">üîê API Login</button>
            <button class="tab-btn" onclick="showAdminTab('menu')">üìã Men√º Setup</button>
            <button class="tab-btn" onclick="showAdminTab('orders')">üì¶ Bestellungen</button>
            <button class="tab-btn" onclick="showAdminTab('analytics')">üìä Analytics</button>
            <button class="tab-btn" onclick="showAdminTab('integration')">üîó Integration</button>
          </div>
          <div class="admin-body">
            <div id="admin-login" class="admin-tab active">
              <h3>Restaurant API Authentifizierung</h3>
              <form onsubmit="handleRestaurantLogin(event)">
                <div class="form-group">
                  <label>Restaurant ID:</label>
                  <input type="text" id="restaurant-id" placeholder="rest_12345" required>
                </div>
                <div class="form-group">
                  <label>API Key:</label>
                  <input type="password" id="api-key" placeholder="sk_live_..." required>
                </div>
                <div class="form-group">
                  <label>Secret:</label>
                  <input type="password" id="api-secret" placeholder="Secret Token" required>
                </div>
                <button type="submit" class="btn-primary">üöÄ Verbinden</button>
              </form>
              <div class="api-status" id="api-status"></div>
            </div>
            <div id="admin-menu" class="admin-tab">
              <h3>Men√º-Management</h3>
              <div id="menu-items"></div>
              <button onclick="addMenuItems()" class="btn-secondary">‚ûï Rezepte zu Men√º hinzuf√ºgen</button>
            </div>
            <div id="admin-orders" class="admin-tab">
              <h3>Live Bestellungen</h3>
              <div id="live-orders"></div>
              <div class="order-stats">
                <span>üìä Heute: <span id="orders-today">0</span></span>
                <span>üí∞ Umsatz: ‚Ç¨<span id="revenue-today">0.00</span></span>
              </div>
            </div>
            <div id="admin-analytics" class="admin-tab">
              <h3>Business Analytics</h3>
              <div id="analytics-dashboard"></div>
            </div>
            <div id="admin-integration" class="admin-tab">
              <h3>API Integration</h3>
              <div class="integration-code">
                <h4>Webhook URL:</h4>
                <code>https://magnitudo-culinaria-api.com/webhooks/restaurant/{restaurant_id}</code>
                <h4>Embed Code:</h4>
                <textarea readonly rows="5" style="width:100%; font-family: monospace; font-size: 12px;">
&lt;script src="https://magnitudo-culinaria-api.com/embed.js"&gt;&lt;/script&gt;
&lt;div id="magnitudo-menu" data-restaurant-id="YOUR_ID" data-api-key="YOUR_KEY"&gt;&lt;/div&gt;</textarea>
                <h4>API Keys & Webhooks:</h4>
                <div id="api-keys"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  `;
  modal.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 10000;
  `;
  document.body.appendChild(modal);
}

// Restaurant Login Handler
function handleRestaurantLogin(event) {
  event.preventDefault();
  const restaurantId = document.getElementById('restaurant-id').value;
  const apiKey = document.getElementById('api-key').value;
  const secret = document.getElementById('api-secret').value;
  
  // Simulate API authentication
  RESTAURANT_API.auth = { apiKey, secret, tenantId: restaurantId };
  
  document.getElementById('api-status').innerHTML = `
    <div class="success">‚úÖ Verbunden mit Restaurant ${restaurantId}</div>
    <div class="api-info">
      <strong>API Status:</strong> Aktiv<br>
      <strong>Webhook URL:</strong> https://api.magnitudo-culinaria.com/webhooks/${restaurantId}<br>
      <strong>Rate Limit:</strong> 1000 requests/hour<br>
      <strong>Features:</strong> Bestellungen, Men√º, Inventar, Payments
    </div>
  `;
  
  loadRestaurantData();
}

// Load Restaurant Data
function loadRestaurantData() {
  // Simulate loading restaurant menu items
  const menuItems = DATA.slice(0, 10).map(recipe => ({
    ...recipe,
    price: (Math.random() * 20 + 8).toFixed(2),
    available: true,
    inventory: Math.floor(Math.random() * 50 + 10)
  }));
  
  displayMenuItems(menuItems);
  startLiveOrders();
}

// Display Menu Items
function displayMenuItems(items) {
  const menuContainer = document.getElementById('menu-items');
  menuContainer.innerHTML = items.map(item => `
    <div class="menu-item-card">
      <h4>${item.name}</h4>
      <p>${item.country} ‚Ä¢ ${item.time_min} Min ‚Ä¢ ${item.difficulty}</p>
      <div class="menu-controls">
        <span>‚Ç¨${item.price}</span>
        <label>
          <input type="checkbox" ${item.available ? 'checked' : ''} 
                 onchange="toggleMenuItem('${item.id}', this.checked)">
          Verf√ºgbar
        </label>
        <span>Lager: ${item.inventory}</span>
      </div>
    </div>
  `).join('');
}

// Live Orders Simulation
function startLiveOrders() {
  const ordersContainer = document.getElementById('live-orders');
  let orderCount = 0;
  let revenue = 0;
  
  // Simulate incoming orders
  setInterval(() => {
    if (Math.random() < 0.3) { // 30% chance every 5 seconds
      const order = generateMockOrder();
      orderCount++;
      revenue += parseFloat(order.total);
      
      ordersContainer.innerHTML = `
        <div class="live-order">
          <div class="order-header">
            <span class="order-id">#${order.id}</span>
            <span class="order-time">${new Date().toLocaleTimeString()}</span>
          </div>
          <div class="order-items">
            ${order.items.map(item => `<div>${item.name} x${item.qty}</div>`).join('')}
          </div>
          <div class="order-footer">
            <span class="order-total">‚Ç¨${order.total}</span>
            <div class="order-status">
              <button onclick="updateOrderStatus('${order.id}', 'preparing')" class="btn-small">üë®‚Äçüç≥ Zubereiten</button>
              <button onclick="updateOrderStatus('${order.id}', 'ready')" class="btn-small">‚úÖ Fertig</button>
            </div>
          </div>
        </div>
      ` + ordersContainer.innerHTML;
      
      document.getElementById('orders-today').textContent = orderCount;
      document.getElementById('revenue-today').textContent = revenue.toFixed(2);
      
      // Send webhook notification
      sendWebhook('order.created', { order_id: order.id, total: order.total });
    }
  }, 5000);
}

// Generate Mock Order
function generateMockOrder() {
  const items = DATA.slice(0, Math.floor(Math.random() * 3) + 1);
  const orderItems = items.map(item => ({
    name: item.name,
    qty: Math.floor(Math.random() * 2) + 1,
    price: (Math.random() * 15 + 8).toFixed(2)
  }));
  
  const total = orderItems.reduce((sum, item) => sum + (parseFloat(item.price) * item.qty), 0);
  
  return {
    id: 'ORD' + Date.now(),
    items: orderItems,
    total: total.toFixed(2),
    status: 'placed',
    timestamp: new Date()
  };
}

// Send Webhook
function sendWebhook(event, data) {
  if (!RESTAURANT_API.auth.apiKey) return;
  
  // Simulate webhook call
  console.log('üì° Webhook sent:', event, data);
  
  fetch('/api/v1/webhooks/send', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-API-Key': RESTAURANT_API.auth.apiKey,
      'X-Signature': generateSignature(data)
    },
    body: JSON.stringify({
      event,
      data,
      timestamp: new Date().toISOString()
    })
  }).catch(err => console.log('Webhook simulation:', err));
}

// Generate API Signature
function generateSignature(data) {
  return btoa(JSON.stringify(data) + RESTAURANT_API.auth.secret).slice(0, 16);
}

// Update Order Status
function updateOrderStatus(orderId, status) {
  console.log(`Order ${orderId} status updated to: ${status}`);
  sendWebhook('order.updated', { order_id: orderId, status });
}

// Toggle Menu Item
function toggleMenuItem(itemId, available) {
  console.log(`Menu item ${itemId} availability: ${available}`);
  sendWebhook('menu.updated', { item_id: itemId, available });
}

// Add Menu Items
function addMenuItems() {
  const selectedRecipes = DATA.slice(0, 5);
  selectedRecipes.forEach(recipe => {
    console.log(`Adding ${recipe.name} to menu`);
    sendWebhook('menu.item_added', { recipe_id: recipe.id, name: recipe.name });
  });
}

// Admin Tab Management
function showAdminTab(tabName) {
  document.querySelectorAll('.admin-tab').forEach(tab => tab.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
  
  document.getElementById(`admin-${tabName}`).classList.add('active');
  event.target.classList.add('active');
}

// Close Admin Panel
function closeAdminPanel() {
  document.getElementById('admin-modal').remove();
}

// Print Recipe Function
function printRecipe(recipeId) {
  const recipe = DATA.find(r => r.id === recipeId);
  if (!recipe) return;
  
  const printWindow = window.open('', '_blank');
  printWindow.document.write(`
    <!DOCTYPE html>
    <html>
    <head>
      <title>${recipe.name} - Rezept</title>
      <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .recipe-header { border-bottom: 2px solid #8b6b4a; padding-bottom: 10px; }
        .ingredients { margin: 20px 0; }
        .steps { margin: 20px 0; }
        .step { margin: 10px 0; }
        @media print { body { margin: 0; } }
      </style>
    </head>
    <body>
      <div class="recipe-header">
        <h1>${recipe.name}</h1>
        <p><strong>Land:</strong> ${recipe.country} ‚Ä¢ <strong>Zeit:</strong> ${recipe.time_min} Min ‚Ä¢ <strong>Schwierigkeit:</strong> ${recipe.difficulty}</p>
      </div>
      <div class="ingredients">
        <h2>Zutaten (${recipe.servings}):</h2>
        <ul>
          ${recipe.ingredients.map(ing => `<li>${ing}</li>`).join('')}
        </ul>
      </div>
      <div class="steps">
        <h2>Zubereitung:</h2>
        ${recipe.steps.map((step, i) => `<div class="step"><strong>${i+1}.</strong> ${step}</div>`).join('')}
      </div>
      <div class="story">
        <h3>Geschichte:</h3>
        <p>${recipe.story}</p>
      </div>
    </body>
    </html>
  `);
  printWindow.document.close();
  printWindow.print();
}

// Export Recipe Function
function exportRecipe(recipeId) {
  const recipe = DATA.find(r => r.id === recipeId);
  if (!recipe) return;
  
  const exportData = {
    name: recipe.name,
    country: recipe.country,
    region: recipe.region,
    category: recipe.category,
    time_min: recipe.time_min,
    difficulty: recipe.difficulty,
    servings: recipe.servings,
    ingredients: recipe.ingredients,
    steps: recipe.steps,
    story: recipe.story,
    exported_at: new Date().toISOString()
  };
  
  const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `${recipe.name.replace(/\s+/g, '_')}_recipe.json`;
  a.click();
  URL.revokeObjectURL(url);
}

// Recipe Collection Manager
const RECIPE_COLLECTION = {
  items: JSON.parse(localStorage.getItem('recipe_collection') || '[]'),
  
  add(recipeId) {
    if (!this.items.includes(recipeId)) {
      this.items.push(recipeId);
      this.save();
    }
  },
  
  remove(recipeId) {
    this.items = this.items.filter(id => id !== recipeId);
    this.save();
  },
  
  save() {
    localStorage.setItem('recipe_collection', JSON.stringify(this.items));
  },
  
  get() {
    return this.items.map(id => DATA.find(r => r.id === id)).filter(Boolean);
  },
  
  export() {
    const collection = this.get();
    const blob = new Blob([JSON.stringify(collection, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `recipe_collection_${new Date().toISOString().split('T')[0]}.json`;
    a.click();
    URL.revokeObjectURL(url);
  },
  
  print() {
    const collection = this.get();
    const printWindow = window.open('', '_blank');
    printWindow.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Rezeptsammlung - ${collection.length} Rezepte</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          .recipe { page-break-inside: avoid; margin: 30px 0; padding: 20px; border: 1px solid #ddd; }
          .recipe-header { border-bottom: 1px solid #8b6b4a; padding-bottom: 10px; margin-bottom: 15px; }
          @media print { body { margin: 0; } }
        </style>
      </head>
      <body>
        <h1>Rezeptsammlung (${collection.length} Rezepte)</h1>
        ${collection.map(recipe => `
          <div class="recipe">
            <div class="recipe-header">
              <h2>${recipe.name}</h2>
              <p><strong>${recipe.country}</strong> ‚Ä¢ ${recipe.time_min} Min ‚Ä¢ ${recipe.difficulty}</p>
            </div>
            <div class="ingredients">
              <h3>Zutaten (${recipe.servings}):</h3>
              <ul>
                ${recipe.ingredients.map(ing => `<li>${ing}</li>`).join('')}
              </ul>
            </div>
            <div class="steps">
              <h3>Zubereitung:</h3>
              ${recipe.steps.map((step, i) => `<p><strong>${i+1}.</strong> ${step}</p>`).join('')}
            </div>
          </div>
        `).join('')}
      </body>
      </html>
    `);
    printWindow.document.close();
    printWindow.print();
  }
};

// Enhanced Recipe Modal with Print/Export - REMOVED DUPLICATE FUNCTION
// Using the static modal above instead

// Collection Manager Modal
function showCollectionManager() {
  const collection = RECIPE_COLLECTION.get();
  const modal = document.createElement('div');
  modal.id = 'collection-modal';
  modal.innerHTML = `
    <div class="modal-overlay" onclick="closeCollectionModal()">
      <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-header">
          <h2>üìö Meine Rezeptsammlung (${collection.length})</h2>
          <button onclick="closeCollectionModal()" class="close-btn">&times;</button>
        </div>
        <div class="modal-body">
          ${collection.length === 0 ? 
            '<p>Keine Rezepte in der Sammlung. F√ºgen Sie Rezepte √ºber das Rezept-Modal hinzu.</p>' :
            `
            <div class="collection-actions">
              <button onclick="RECIPE_COLLECTION.print()" class="btn-primary">üñ®Ô∏è Alle drucken</button>
              <button onclick="RECIPE_COLLECTION.export()" class="btn-secondary">üíæ Als JSON exportieren</button>
            </div>
            <div class="collection-list">
              ${collection.map(recipe => `
                <div class="collection-item">
                  <h4>${recipe.name}</h4>
                  <p>${recipe.country} ‚Ä¢ ${recipe.time_min} Min</p>
                  <button onclick="RECIPE_COLLECTION.remove('${recipe.id}')" class="btn-remove">‚ùå Entfernen</button>
                </div>
              `).join('')}
            </div>
            `
          }
        </div>
      </div>
    </div>
  `;
  modal.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 6000;
    background: rgba(0,0,0,0.8);
    display: flex;
    align-items: center;
    justify-content: center;
  `;
  document.body.appendChild(modal);
}

// Close Collection Modal
function closeCollectionModal() {
  document.getElementById('collection-modal').remove();
}

</script>
</body>
</html>
