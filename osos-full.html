<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>OSOS Â· Portal Â· Manifest Â· OS Â· Telbank Â· Legal Â· Rooms Â· Survey</title>
<meta name="ts-branding" content="T,.&T,,.&T,,,.TOGETHERSYSTEMS. INTERNATIONAL TTT T,.&T,,.T,,,.(C) (+31) - ( 613 803 782.) https://orcid.org/0009-0003-1328-2430">
<link rel="manifest" href="./manifest.webmanifest">
<style>
  :root{
    --bg:#0f1419; --card:#0d1117; --fg:#e6edf3; --muted:#8b949e; --accent:#58a6ff; --border:#1f2328;
    --good:#3fb950; --warn:#d29922; --no:#f85149; --maybe:#f2cc60;
  }
  html,body{background:var(--bg);color:var(--fg);margin:0;font:15px/1.6 system-ui,Segoe UI,Roboto,Helvetica,Arial}
  header{position:sticky;top:0;background:rgba(13,17,23,.9);backdrop-filter:saturate(140%) blur(8px);
         border-bottom:1px solid var(--border);padding:.75rem 1rem;display:grid;grid-template-columns: 280px 1fr auto;gap:.75rem;align-items:center}
  .brand{font-weight:700;letter-spacing:.02em;color:var(--accent)}
  .brand a{color:var(--accent);text-decoration:none}
  .tools{display:flex;gap:.5rem;align-items:center}
  .tools input, .tools button{background:var(--card);color:var(--fg);border:1px solid #30363d;border-radius:10px;padding:.45rem .6rem}
  main{display:grid;grid-template-columns:360px 1fr;gap:1rem;padding:1rem}
  .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:1rem}
  .list{display:grid;gap:.6rem;max-height:64vh;overflow:auto}
  .item{border:1px solid #30363d;border-radius:10px;padding:.6rem;cursor:pointer;display:grid;gap:.25rem}
  .item:hover{border-color:var(--accent)}
  .title{font-weight:600}
  .meta{color:var(--muted);font-size:.9rem}
  .tags{display:flex;flex-wrap:wrap;gap:.25rem}
  .pill{display:inline-block;border:1px solid #30363d;border-radius:999px;padding:.1rem .45rem;color:var(--muted);font-size:.8rem}
  .row{display:flex;gap:.5rem;align-items:center;flex-wrap:wrap}
  textarea,input,select{width:100%;background:#0d1117;color:var(--fg);border:1px solid #30363d;border-radius:10px;padding:.6rem}
  button{background:#161b22;color:var(--fg);border:1px solid #30363d;border-radius:10px;padding:.5rem .75rem;cursor:pointer}
  button:hover{border-color:var(--accent)}
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:.5rem}
  .option{display:flex;align-items:center;gap:.5rem;border:1px solid #30363d;border-radius:10px;padding:.5rem}
  .opt-yes{border-color:rgba(63,185,80,.4);background:rgba(63,185,80,.08)}
  .opt-maybe{border-color:rgba(242,204,96,.4);background:rgba(242,204,96,.08)}
  .opt-warn{border-color:rgba(210,153,34,.4);background:rgba(210,153,34,.08)}
  .opt-no{border-color:rgba(248,81,73,.4);background:rgba(248,81,73,.08)}
  .spark{height:8px;border-radius:999px}
  .spark.good{background:linear-gradient(90deg,var(--good),#7ee787)}
  .spark.maybe{background:linear-gradient(90deg,var(--maybe),#f2cc60)}
  .spark.warn{background:linear-gradient(90deg,var(--warn),#f2a542)}
  .os-area{display:grid;grid-template-columns: repeat(auto-fit,minmax(220px,1fr));gap:.75rem}
  .folder{background:#0b1016;border:1px dashed #2a2f36;border-radius:12px;padding:.75rem}
  .folder h4{margin:.1rem 0 .5rem;font-size:1rem}
  .launcher{display:flex;flex-wrap:wrap;gap:.5rem}
  .app-link{border:1px solid #2e3339;border-radius:10px;padding:.35rem .6rem;cursor:pointer;color:var(--muted)}
  .app-link:hover{border-color:var(--accent);color:var(--fg)}
  .wm-desktop{position:relative;min-height:42vh;border:1px solid var(--border);border-radius:12px;background:#0a0f14;padding:.5rem;overflow:hidden}
  .window{position:absolute;top:20px;left:20px;width:460px;min-width:320px;min-height:200px;background:#0d1117;border:1px solid var(--border);border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.35);z-index:100}
  .titlebar{display:flex;align-items:center;justify-content:space-between;padding:.4rem .6rem;border-bottom:1px solid #20242a;background:#0e1318;border-top-left-radius:12px;border-top-right-radius:12px}
  .titlebar .title{font-weight:600}
  .titlebar .controls{display:flex;gap:.35rem}
  .ctrl{width:24px;height:24px;border:1px solid #30363d;border-radius:6px;background:#161b22;color:#e6edf3;display:grid;place-items:center;cursor:pointer}
  .ctrl:hover{border-color:var(--accent)}
  .content{padding:.6rem;max-height:50vh;overflow:auto}
  .resizer{position:absolute;right:6px;bottom:6px;width:14px;height:14px;border:1px solid #30363d;border-radius:4px;cursor:nwse-resize}
  .taskbar{position:fixed;left:0;right:0;bottom:0;background:rgba(13,17,23,.95);border-top:1px solid var(--border);padding:.4rem .6rem;display:flex;gap:.5rem;align-items:center;z-index:9999}
  .task-item{border:1px solid #30363d;border-radius:10px;padding:.35rem .6rem;color:var(--muted);cursor:pointer}
  .task-item.active{border-color:var(--accent);color:var(--fg)}
  .manifest{white-space:pre-wrap;font-size:.92rem;line-height:1.5;color:var(--muted);border:1px solid #2a2f36;border-radius:12px;padding:1rem;background:#0b1016}
  footer{padding:1rem;text-align:center;color:var(--muted);border-top:1px solid var(--border)}
  .donation-banner{background:linear-gradient(135deg, #10b981 0%, #059669 100%);padding:20px;border-radius:12px;margin-bottom:1rem;border:2px solid #10b981;grid-column:1/-1}
  .donation-banner h3{color:white;margin:0 0 10px}
  .donation-banner p{color:rgba(255,255,255,0.95);margin:0 0 15px}
</style>
</head>
<body>
<header>
  <div class="brand"><a href="https://tel1.jouwweb.nl/servicesoftware" target="_blank" rel="noopener noreferrer">T,.&T,,.&T,,,. OSOS</a> Â· Portal Â· Manifest Â· OS Â· Telbank Â· Legal Â· Rooms Â· Survey</div>
  <div class="tools">
    <input id="search" placeholder="Suche Formeln, Tags, Beschreibungen â€¦">
    <button id="clear">LÃ¶schen</button>
  </div>
  <div class="tools">
    <button id="donate">Payâ€‘whatâ€‘youâ€‘wish (â‰¥ 5 EUR) Â· Skrill TTT</button>
  </div>
</header>

<main>
  <div class="donation-banner">
    <h3>ğŸ’ UnterstÃ¼tze dieses Projekt</h3>
    <p>Dieses Entwickler-Developer-Tool hat langwierig sehr viel Arbeit gekostet. Die FunktionalitÃ¤t ist nicht 100% gegeben, aber es ist fÃ¼r AnfÃ¤nger sowie fÃ¼r Fortgeschrittene geeignet.</p>
    <div class="row" style="justify-content:center">
      <a href="https://www.gofundme.com/f/magnitudo?utm_campaign=unknown&utm_medium=referral&utm_source=widget" target="_blank" rel="noopener noreferrer" style="background:white;color:#10b981;padding:12px 24px;border-radius:8px;text-decoration:none;font-weight:bold;margin-right:10px;">ğŸ’° GoFundMe (ab â‚¬5)</a>
      <button onclick="copyIBAN('NL66 RABO 1020 3955 08')" style="background:rgba(255,255,255,0.2);color:white;border:2px solid white;padding:12px 24px;border-radius:8px;font-weight:bold;margin-right:10px;">ğŸ¦ IBAN kopieren</button>
      <button onclick="window.open('https://www.skrill.com/', '_blank')" style="background:rgba(255,255,255,0.2);color:white;border:2px solid white;padding:12px 24px;border-radius:8px;font-weight:bold;">ğŸ’³ Skrill TTT</button>
    </div>
    <p style="margin-top:15px;font-size:0.9em;text-align:center;">Vielen Dank fÃ¼r Ihre groÃŸzÃ¼gige UnterstÃ¼tzung! ğŸ™</p>
  </div>

  <section class="card">
    <h3>Formelfarm Â· Kuratiertes Pool</h3>
    <div id="pool" class="list"></div>
  </section>

  <section class="card">
    <h3>Formel Â· Optionen, Q/A, Installation & Survey</h3>
    <div id="detail"></div>
    <h4>Psychologieâ€‘Optionen</h4>
    <div id="options" class="grid2"></div>
    <div class="meta">Farbcues: GrÃ¼n=Ja, Gelb=Vielleicht, Amber=PrÃ¼fen, Rot=Ablehnen.</div>
    <h4>Remix Â· Kette</h4>
    <div id="chain" class="list"></div>
    <div class="row">
      <button id="addToChain">Zur Kette hinzufÃ¼gen</button>
      <button id="genPlan">Programmplan generieren</button>
      <button id="clearChain">Kette leeren</button>
    </div>
    <h4>AIâ€‘Frage (offline Logik)</h4>
    <div class="row">
      <input id="ask" placeholder="z. B. Kann daraus ein Simulator werden?"><button id="askBtn">Fragen</button>
    </div>
    <div id="answer" class="meta"></div>
    <h4>Plan Â· Pseudocode</h4>
    <textarea id="plan" placeholder="Hier erscheint der generierte Plan â€¦"></textarea>
    <div class="row">
      <button id="downloadPlan">Plan speichern</button>
      <button id="installApp">In OS installieren</button>
      <button id="openSurvey">Decisionâ€‘Survey Ã¶ffnen</button>
    </div>
  </section>

  <section class="card">
    <h3>Manifest Â· Transparenz & Ethik (offline)</h3>
    <div id="manifest" class="manifest"></div>
    <div class="row">
      <button id="openManifestWindow">Manifest als Fenster</button>
    </div>
  </section>

  <section class="card">
    <h3>OSâ€‘Bereich Â· Ordner & Launcher</h3>
    <div id="osArea" class="os-area"></div>
  </section>

  <section class="card">
    <h3>Desktop Â· Fenster & Taskleiste</h3>
    <div id="desktop" class="wm-desktop"></div>
  </section>
</main>

<div id="taskbar" class="taskbar"></div>

<footer>Â© OSOS Â· Offline Â· sicher Â· frei Â· Keine Registrierung Â· Freiwillige Spende: <a href="https://www.gofundme.com/f/magnitudo" target="_blank" style="color:var(--accent)">GoFundMe</a> oder IBAN: NL66 RABO 1020 3955 08 Â· Skrill [TTT]</footer>

<script>
const POOL = [
  { id:"eq_affine", title:"Affine Gleichung", type:"equation",
    inputs:["a","b","x"], outputs:["y"], tags:["math","calculator"],
    description:"y = aÂ·x + b", invariants:["linear","deterministic"], ethics:["no-hazard"],
    archetypes:["Calculator","Visualizer","Validator"] },
  { id:"eq_quadratic", title:"Quadratische Gleichung", type:"equation",
    inputs:["a","b","c"], outputs:["x1","x2"], tags:["math","roots"],
    description:"aÂ·x^2 + bÂ·x + c = 0", invariants:["polynomial","deterministic"], ethics:["no-hazard"],
    archetypes:["Calculator","Visualizer","Validator"] },
  { id:"map_text_rules", title:"Textâ€‘Regelâ€‘Mapping", type:"mapping",
    inputs:["text"], outputs:["text"], tags:["text","transform"],
    description:"Regelbasierte Ersetzungen (Synonyme, Normalisierung)", invariants:["deterministic"], ethics:["no-hazard"],
    archetypes:["Transformer","Validator","Visualizer"] },
  { id:"constraint_range", title:"Bereichsâ€‘Constraint", type:"constraint",
    inputs:["value","min","max"], outputs:["ok"], tags:["validate","bound"],
    description:"value âˆˆ [min, max]", invariants:["bounded"], ethics:["no-hazard"],
    archetypes:["Validator","Visualizer"] },
  { id:"seq_workflow", title:"Abstrakte Schrittfolge", type:"sequence",
    inputs:["state"], outputs:["state"], tags:["workflow","abstract"],
    description:"Rein softwareâ€‘logische Schritte", invariants:["safe","bounded"], ethics:["no-hazard"],
    archetypes:["Workflow","Visualizer"] },
  { id:"series_sim", title:"Diskrete Zeitreiheâ€‘Simulator", type:"equation",
    inputs:["x0","step","n"], outputs:["series"], tags:["time-series","sim"],
    description:"x_{t+1} = x_t + step", invariants:["monotonic"], ethics:["no-hazard"],
    archetypes:["Simulator","Visualizer","Validator"] }
];

const poolEl=document.getElementById('pool'), detailEl=document.getElementById('detail'), optionsEl=document.getElementById('options'),
      chainEl=document.getElementById('chain'), planEl=document.getElementById('plan'), searchEl=document.getElementById('search'),
      clearBtn=document.getElementById('clear'), askEl=document.getElementById('ask'), answerEl=document.getElementById('answer'),
      osAreaEl=document.getElementById('osArea'), desktopEl=document.getElementById('desktop'), taskbarEl=document.getElementById('taskbar'),
      manifestEl=document.getElementById('manifest');

let selected=null, chain=[];

const MANIFEST_TEXT = `Portal Â· Manifest Â· OS â€” Einheit aus Spiel, Struktur und Transparenz.

- Portal: Auswahl, Farbe, erste Entscheidung, Vorschau.

- Manifest: Regeln, Ethik, Offenheit, Auditierbarkeit; keine realweltlichen Gefahranweisungen.

- OS: Installation, Ordner, Fenster, Taskleiste; 1% Userâ€‘Handlung, 99% System.

- Spenden: Payâ€‘whatâ€‘youâ€‘wish (â‰¥ 5 EUR empfohlen). Freiwillig. GoFundMe oder IBAN: NL66 RABO 1020 3955 08. Skrill [TTT] als Signaturmarke.

- Psychologie: GrÃ¼n=Ja, Gelb=Vielleicht, Amber=PrÃ¼fen, Rot=Ablehnen.

- Musikmetapher: Entscheidungen formen Dur/Moll/Dissonanzâ€‘Muster (abstrakt/visuell).

- Sicherheit: Rein softwareâ€‘logisch, abstrakt. Keine gefÃ¤hrlichen, medizinischen oder gewalttÃ¤tigen Inhalte.`;
manifestEl.textContent = MANIFEST_TEXT;

function sparkFor(f){ const a=f.archetypes||[]; if(a.includes("Simulator")||a.includes("Calculator"))return"good"; if(a.includes("Transformer"))return"maybe"; if(a.includes("Validator"))return"warn"; return"maybe"; }
function renderPool(items){
  poolEl.innerHTML=items.map(f=>`<div class="item" data-id="${f.id}">
    <div class="title">${f.title}</div>
    <div class="meta">${f.description}</div>
    <div class="tags">${f.tags.map(t=>`<span class="pill">${t}</span>`).join('')}</div>
    <div class="spark ${sparkFor(f)}"></div>
  </div>`).join('');
  poolEl.querySelectorAll('.item').forEach(it=>{
    it.onclick=()=>{ selected=POOL.find(x=>x.id===it.dataset.id); renderDetail(selected); renderOptions(selected); };
  });
}
renderPool(POOL);

function renderDetail(f){
  if(!f){ detailEl.innerHTML=""; return; }
  detailEl.innerHTML = `
    <div class="row"><div class="title">${f.title}</div><span class="pill">${f.type}</span></div>
    <div>${f.description}</div>
    <div class="meta">Eingaben: ${f.inputs.join(", ")} Â· Ausgaben: ${f.outputs.join(", ")}</div>
    <div class="meta">Invarianten: ${f.invariants.join(", ")}</div>
    <div>Programmklassen: ${(f.archetypes||[]).map(a=>`<span class="pill">${a}</span>`).join(" ")}</div>`;
}
function renderOptions(f){
  const opts=[
    {label:"Direkt als Rechner",kind:"Calculator",cls:"opt-yes",info:"Eingaben â†’ Ergebnis"},
    {label:"Als Visualisierung",kind:"Visualizer",cls:"opt-maybe",info:"Kurven/Balken"},
    {label:"Als Validator",kind:"Validator",cls:"opt-warn",info:"PrÃ¼fergebnis & GrÃ¼nde"},
    {label:"Ablehnen",kind:"Reject",cls:"opt-no",info:"Andere Idee wÃ¤hlen"},
  ].filter(o=>o.kind==="Reject"||(f.archetypes||[]).includes(o.kind));
  optionsEl.innerHTML=opts.map(o=>`<div class="option ${o.cls}">
    <button data-kind="${o.kind}">${o.label}</button><div class="meta">${o.info}</div>
  </div>`).join('');
  optionsEl.querySelectorAll('button').forEach(b=>{ b.onclick=()=> onOption(f,b.dataset.kind); });
}
function onOption(f,kind){ if(kind==="Reject"){ planEl.value="Abgelehnt. WÃ¤hle eine andere Formel."; return; } planEl.value=genPlanForSingle(f,kind); }

function renderChain(){ chainEl.innerHTML=chain.map((f,i)=>`<div class="item"><strong>${i+1}.</strong> ${f.title} <span class="pill">${f.type}</span></div>`).join(''); }
document.getElementById('addToChain').onclick=()=>{ if(!selected)return; chain.push(selected); renderChain(); };
document.getElementById('clearChain').onclick=()=>{ chain=[]; renderChain(); };
document.getElementById('genPlan').onclick=()=>{
  const safe=chain.every(f=>(f.ethics||[]).includes('no-hazard'));
  planEl.value = safe ? genPlanForChain(chain) : "Sicherheitsgrenzen Ã¼berschritten. Bitte nur abstrakte, sichere Formeln.";
};

document.getElementById('askBtn').onclick=()=>{
  if(!selected){ answerEl.textContent="Bitte erst eine Formel wÃ¤hlen."; return; }
  const q=(askEl.value||"").toLowerCase();
  const verdict=offlineVerdict(selected,q);
  const suggest=(selected.archetypes||[]).join(", ");
  answerEl.textContent=`Verdikt: ${verdict}. VorschlÃ¤ge: ${suggest}. (Abstrakt & sicher.)`;
};
function offlineVerdict(f,q){
  if(q.includes("simulator")||q.includes("simulieren")) return (f.archetypes||[]).includes("Simulator")?"Ja":"Vielleicht";
  if(q.includes("rechner")||q.includes("berechnen")) return (f.archetypes||[]).includes("Calculator")?"Ja":"Vielleicht";
  if(q.includes("visual")) return (f.archetypes||[]).includes("Visualizer")?"Ja":"Vielleicht";
  if(q.includes("valid")||q.includes("prÃ¼f")) return (f.archetypes||[]).includes("Validator")?"Ja":"Vielleicht";
  if(q.includes("labor")||q.includes("chemie")||q.includes("bio")) return "Nein";
  return "Vielleicht";
}
function genPlanForSingle(f,mode){
  const base=[`Programm: ${f.title} â†’ ${mode}`,`Eingaben: ${f.inputs.join(", ")}`,`Ausgaben: ${f.outputs.join(", ")}`,`Invarianten: ${f.invariants.join(", ")}`,`Sicherheit: abstrakt, keine reale Welt`].join('\n');
  const pseudo={"Calculator":["function evaluate(inputs){","  // affine/quadratische Auswertung","  return result;","}"],
    "Visualizer":["function visualize(data){","  // Kurven/Balken in Canvas","}"],
    "Validator":["function validate(inputs){","  // Bereichs-/Typ-Checks, monotonic","  return { ok:true, reasons:[] };","}"],
    "Simulator":["function simulate(x0, step, n){","  const series=[x0];","  for(let i=0;i<n;i++){ series.push(series.at(-1)+step); }","  return series;","}"],
    "Workflow":["function runWorkflow(state){","  // Sequenz abstrakter Schritte","  return state;","}"]
  }[mode]||["// Mode nicht definiert"];
  return base+"\n\nPseudocode:\n"+pseudo.join('\n');
}
function genPlanForChain(list){
  if(!list.length) return "Keine Formeln in der Kette.";
  const steps=list.map((f,i)=>`Schritt ${i+1}: ${f.title} â†’ ${(f.archetypes||[])[0]}`).join('\n');
  const io=`IO: ${list[0].inputs.join(", ")} â†’ ${list.at(-1).outputs.join(", ")}`;
  const inv=Array.from(new Set(list.flatMap(f=>f.invariants||[]))).join(", ");
  return ["Programmplan (abstrakt & sicher)",steps,"",io,`Invarianten: ${inv}`,"","Pseudocode:","- init()","- validate_inputs()","- apply_chain()","- visualize()","- export_summary()"].join('\n');
}

document.getElementById('downloadPlan').onclick=()=>{
  const blob=new Blob([planEl.value||""],{type:"text/plain"}); const url=URL.createObjectURL(blob);
  const a=Object.assign(document.createElement('a'),{href:url,download:"plan.txt"}); document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
};

const REG_KEY="os.registry.v1", FOLDER_CAPACITY=8;
function getRegistry(){ try{ return JSON.parse(localStorage.getItem(REG_KEY)||"{}"); }catch{ return {}; } }
function saveRegistry(reg){ localStorage.setItem(REG_KEY, JSON.stringify(reg)); }
function ensureFolder(reg){ const folders=Object.keys(reg); if(!folders.length) reg["Apps-1"]=[]; const last=folders.at(-1); if(reg[last].length>=FOLDER_CAPACITY){ reg[`Apps-${folders.length+1}`]=[]; } return reg; }
function makeAppDescriptor(f,plan){ const id=`app_${f.id}_${Date.now()}`, title=`${f.title} (${(f.archetypes||[])[0]||'App'})`; return { id,title, formula:f, plan:plan||genPlanForSingle(f,(f.archetypes||[])[0]||'Visualizer'), donation:{label:"Skrill [TTT] â‰¥ 5 EUR", gofundme:"https://www.gofundme.com/f/magnitudo", iban:"NL66 RABO 1020 3955 08", skrill:"https://www.skrill.com/"} }; }
function renderOSArea(){
  const reg=getRegistry(); const folders=Object.entries(reg);
  osAreaEl.innerHTML = folders.map(([name,apps])=>{
    const links=apps.map(app=>`<span class="app-link" data-id="${app.id}">${app.title}</span>`).join(' ');
    return `<div class="folder"><h4>${name}</h4><div class="launcher">${links||'<span class="meta">Noch keine Apps</span>'}</div></div>`;
  }).join('');
  osAreaEl.querySelectorAll('.app-link').forEach(a=>{
    a.onclick=()=>{ const app=findAppById(a.dataset.id); if(app) spawnWindow(app); };
  });
}
function findAppById(id){ const reg=getRegistry(); for(const list of Object.values(reg)){ const app=list.find(x=>x.id===id); if(app) return app; } return null; }
function installAppFromSelection(){
  if(!selected){ alert("Bitte erst eine Formel wÃ¤hlen."); return; }
  const app=makeAppDescriptor(selected, planEl.value); let reg=getRegistry(); reg=ensureFolder(reg); const last=Object.keys(reg).at(-1); reg[last].push(app); saveRegistry(reg); renderOSArea(); spawnWindow(app);
}
document.getElementById('installApp').onclick=installAppFromSelection;
renderOSArea();

const windows=new Map();
function spawnWindow(app){
  const w=document.createElement('div'); w.className="window"; w.style.top=Math.round(40+Math.random()*60)+"px"; w.style.left=Math.round(40+Math.random()*80)+"px";
  w.innerHTML = `<div class="titlebar"><div class="title">${app.title}</div><div class="controls">
    <div class="ctrl" data-act="min">â€“</div><div class="ctrl" data-act="max">â–¡</div><div class="ctrl" data-act="close">Ã—</div></div></div>
    <div class="content"><div class="meta">Formel: ${app.formula.title} Â· Typ: ${app.formula.type}</div>
      <pre style="white-space:pre-wrap">${app.plan}</pre>
      <div class="row"><button data-act="run">Demo ausfÃ¼hren</button> <a class="pill" href="${app.donation.gofundme}" target="_blank" title="GoFundMe">ğŸ’° GoFundMe</a> <a class="pill" href="${app.donation.skrill}" target="_blank" title="Skrill TTT">ğŸ’³ Skrill TTT</a> <button onclick="copyIBAN('${app.donation.iban}')" class="pill">ğŸ¦ IBAN</button></div>
      <div class="meta">Demo ist abstrahiert (sicher, keine reale Welt). Freiwillige Spende willkommen.</div>
    </div><div class="resizer"></div>`;
  desktopEl.appendChild(w);
  windows.set(app.id,{el:w, app, state:{}}); bringToFront(w);
  w.querySelectorAll('.ctrl').forEach(c=>{ c.onclick=()=>{ const act=c.dataset.act; if(act==="close") closeWindow(app.id); if(act==="min") minimizeWindow(app.id); if(act==="max") maximizeWindow(app.id); }; });
  w.querySelector('[data-act="run"]').onclick=()=> runDemo(app, w.querySelector('.content'));
  let drag=false, dx=0, dy=0; w.querySelector('.titlebar').onmousedown=(e)=>{ drag=true; dx=e.clientX-w.offsetLeft; dy=e.clientY-w.offsetTop; bringToFront(w); };
  document.addEventListener('mousemove',(e)=>{ if(!drag) return; w.style.left=Math.max(0,e.clientX-dx)+"px"; w.style.top=Math.max(0,e.clientY-dy)+"px"; });
  document.addEventListener('mouseup',()=> drag=false);
  let rs=false, sx=0, sy=0, sw=0, sh=0; w.querySelector('.resizer').onmousedown=(e)=>{ rs=true; sx=e.clientX; sy=e.clientY; sw=w.offsetWidth; sh=w.offsetHeight; bringToFront(w); };
  document.addEventListener('mousemove',(e)=>{ if(!rs) return; const nw=Math.max(320, sw+(e.clientX-sx)), nh=Math.max(200, sh+(e.clientY-sy)); w.style.width=nw+"px"; w.style.height=nh+"px"; });
  document.addEventListener('mouseup',()=> rs=false);
  addTaskItem(app.id, app.title);
  return w;
}
function bringToFront(w){ w.style.zIndex=String(Date.now()); }
function closeWindow(id){ const rec=windows.get(id); if(!rec) return; rec.el.remove(); windows.delete(id); removeTaskItem(id); }
function minimizeWindow(id){ const rec=windows.get(id); if(!rec) return; rec.el.style.display="none"; setTaskActive(id,false); }
function maximizeWindow(id){ const rec=windows.get(id); if(!rec) return;
  const fixed=rec.el.style.position==="fixed";
  if(!fixed){ rec.el.style.position="fixed"; rec.el.style.top="52px"; rec.el.style.left="12px"; rec.el.style.right="12px"; rec.el.style.bottom="56px"; rec.el.style.width="auto"; rec.el.style.height="auto"; }
  else { rec.el.style.position="absolute"; rec.el.style.width="460px"; rec.el.style.height="auto"; rec.el.style.top="20px"; rec.el.style.left="20px"; rec.el.style.right=""; rec.el.style.bottom=""; }
  setTaskActive(id,true);
}

function addTaskItem(id,title){
  const t=document.createElement('div'); t.className="task-item active"; t.dataset.id=id; t.textContent=title;
  t.onclick=()=>{ const rec=windows.get(id); if(!rec) return; const visible=rec.el.style.display!=="none"; if(!visible){ rec.el.style.display=""; setTaskActive(id,true); bringToFront(rec.el); } else { rec.el.style.display="none"; setTaskActive(id,false); } };
  taskbarEl.appendChild(t);
}
function removeTaskItem(id){ taskbarEl.querySelectorAll('.task-item').forEach(it=>{ if(it.dataset.id===id) it.remove(); }); }
function setTaskActive(id,active){ taskbarEl.querySelectorAll('.task-item').forEach(it=>{ if(it.dataset.id===id) it.classList.toggle('active', !!active); }); }

function runDemo(app,contentEl){
  const f=app.formula; const out=document.createElement('div'); out.className="meta";
  if(f.id==="series_sim"){ const series=[]; let x0=0, step=1, n=12; series.push(x0); for(let i=0;i<n;i++){ series.push(series.at(-1)+step); } out.textContent="Simulator (abstrakt): "+series.join(", "); }
  else if(f.id==="eq_affine"){ const a=2,b=3,x=5; const y=a*x+b; out.textContent=`Rechner: y = aÂ·x + b â†’ 2Â·5 + 3 = ${y}`; }
  else if(f.id==="eq_quadratic"){ const a=1,b=-3,c=2; const D=b*b-4*a*c; const x1=(-b+Math.sqrt(D))/(2*a), x2=(-b-Math.sqrt(D))/(2*a); out.textContent=`Wurzeln: x1=${x1.toFixed(3)}, x2=${x2.toFixed(3)}`; }
  else if(f.id==="map_text_rules"){ const text="Einfacher Text"; out.textContent=`Transformer: "${text}" â†’ "${text.toUpperCase()}"`; }
  else if(f.id==="constraint_range"){ const value=7,min=0,max=10; const ok=value>=min && value<=max; out.textContent=`Validator: value=${value} âˆˆ [${min},${max}] â†’ ${ok?"OK":"NICHT OK"}`; }
  else if(f.id==="seq_workflow"){ out.textContent="Workflow: Schritt A â†’ B â†’ C (abstrakt)"; }
  else { out.textContent="Demo: abstrakter Platzhalter"; }
  contentEl.appendChild(out);
}

searchEl.addEventListener('input', ()=>{ const t=searchEl.value.toLowerCase().trim(); renderPool(POOL.filter(f=>`${f.title} ${f.description} ${f.tags.join(" ")}`.toLowerCase().includes(t))); });
clearBtn.onclick=()=>{ searchEl.value=""; renderPool(POOL); };

document.getElementById('donate').onclick=()=> showDonationModal();

function showDonationModal(){
  const modal=document.createElement('div'); modal.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:10000;display:flex;align-items:center;justify-content:center;';
  modal.innerHTML=`<div style="background:#0d1117;padding:40px;border-radius:20px;max-width:500px;width:90%;border:2px solid #58a6ff;">
    <h2 style="color:#58a6ff;margin-bottom:20px;">ğŸ’ UnterstÃ¼tze dieses Projekt</h2>
    <p style="color:var(--muted);margin-bottom:20px;">Freiwillige Spende (â‰¥ 5 EUR empfohlen). Zahlungsoption: Skrill Â· Signatur: TTT.</p>
    <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-bottom:20px;">
      <a href="https://www.gofundme.com/f/magnitudo?utm_campaign=unknown&utm_medium=referral&utm_source=widget" target="_blank" style="background:#3fb950;color:white;padding:12px 24px;border-radius:8px;text-decoration:none;font-weight:bold;">ğŸ’° GoFundMe (ab â‚¬5)</a>
      <button onclick="copyIBAN('NL66 RABO 1020 3955 08')" style="background:#58a6ff;color:white;padding:12px 24px;border-radius:8px;border:none;font-weight:bold;cursor:pointer;">ğŸ¦ IBAN kopieren</button>
      <a href="https://www.skrill.com/" target="_blank" style="background:#f59e0b;color:white;padding:12px 24px;border-radius:8px;text-decoration:none;font-weight:bold;">ğŸ’³ Skrill TTT</a>
    </div>
    <div style="background:#0b1016;padding:15px;border-radius:10px;margin-bottom:20px;">
      <div style="margin-bottom:10px;"><strong>IBAN:</strong> <code style="background:#161b22;padding:5px 10px;border-radius:5px;">NL66 RABO 1020 3955 08</code></div>
      <div style="margin-bottom:10px;"><strong>BIC:</strong> <code style="background:#161b22;padding:5px 10px;border-radius:5px;">RABONL2U</code></div>
      <div><strong>Kontoinhaber:</strong> R.D.TEL "Raymond Demitrio Tel"</div>
    </div>
    <button onclick="this.closest('div[style*=\"position:fixed\"]').remove()" style="width:100%;background:#30363d;color:white;padding:12px;border:none;border-radius:8px;cursor:pointer;font-weight:bold;margin-top:20px;">SchlieÃŸen</button>
  </div>`;
  document.body.appendChild(modal);
}

function copyIBAN(iban){
  navigator.clipboard.writeText(iban).then(()=>{
    alert('IBAN wurde in die Zwischenablage kopiert: ' + iban);
  }).catch(()=>{
    const textarea=document.createElement('textarea'); textarea.value=iban; document.body.appendChild(textarea); textarea.select(); document.execCommand('copy'); document.body.removeChild(textarea);
    alert('IBAN wurde in die Zwischenablage kopiert: ' + iban);
  });
}

document.getElementById('openManifestWindow').onclick=()=>{
  const app={ id:"manifest_"+Date.now(), title:"Manifest Â· Transparenz & Ethik", formula:{title:"Manifest",type:"document"}, plan:MANIFEST_TEXT, donation:{label:"Skrill [TTT]", gofundme:"https://www.gofundme.com/f/magnitudo", iban:"NL66 RABO 1020 3955 08", skrill:"https://www.skrill.com/"} };
  spawnWindow(app);
};

document.getElementById('openSurvey').onclick=()=>{
  const app={ id:"survey_"+Date.now(), title:"Decisionâ€‘Survey (SmartSurvey)", formula:{title:"Survey",type:"survey"}, plan:"Copy & Paste aus Word/PDF in die Surveyâ€‘Maske. Vorschau & Seiten automatisch.", donation:{label:"Skrill [TTT]", gofundme:"https://www.gofundme.com/f/magnitudo", iban:"NL66 RABO 1020 3955 08", skrill:"https://www.skrill.com/"} };
  const w=spawnWindow(app);
  const frame=document.createElement('div');
  frame.innerHTML=`<div class="meta">SmartSurveyâ€‘Einbettung (Beispielâ€‘ID ersetzen):</div>
    <iframe src="https://www.smartsurvey.co.uk/s/DEINE_UMFRAGE_ID/" width="100%" height="380" frameborder="0"></iframe>
    <div class="meta">Copy & Paste: Fragen/Seiten werden automatisch erkannt.</div>`;
  w.querySelector('.content').appendChild(frame);
};

if('serviceWorker' in navigator){ navigator.serviceWorker.register('./sw.js').catch(()=>{}); }

// Integriere Self-Healing System
if(typeof window.SelfHealingSystem !== 'undefined'){
  window.selfHealing = new window.SelfHealingSystem();
}

// Integriere Neural Network
if(typeof window.NeuralNetworkSystem !== 'undefined'){
  window.neuralNetwork = new window.NeuralNetworkSystem();
}

renderOSArea();
</script>
<!-- T,. Self-Healing System -->
<script src="./SELF-HEALING-SYSTEM.js"></script>
<!-- T,. Neural Network Update -->
<script src="./NEURAL-NETWORK-UPDATE.js"></script>
</body>
</html>

